(function(e,t){typeof define=="function"&&define.amd?define("common/Widget.js",["d3"],t):(e.require=e.require||function(t,n){typeof t=="function"&&(n=t,t=[]);var r=t.map(function(t){if(t==="d3-cloud/d3.layout.cloud")return e.d3.layout.cloud;var n=t.substring("src/".length).split("/").join("_");return e[n]});n.apply(null,r)},e.common_Widget=t(e.d3))})(this,function(e){function n(){this._class=Object.getPrototypeOf(this)._class,this._id="_w"+t++,this._columns=[],this._data=[],this._pos={x:0,y:0},this._size={width:0,height:0},this._scale=1,this._target=null,this._parentElement=null,this._parentWidget=null,this._element=e.select(),this._watchArr=[],this._renderCount=0,window.__hpcc_debug&&(window.g_all===undefined&&(window.g_all={}),window.g_all[this._id]=this)}var t=0;return n.prototype._class=" common_Widget",n.prototype.ieVersion=function(){var e=navigator.userAgent,t,n=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(t=/\brv[ :]+(\d+)/g.exec(e)||[],parseFloat(t[1])):/msie/i.test(n[1])?parseFloat(n[2]):null}(),n.prototype.isIE=n.prototype.ieVersion!==null,n.prototype.svgMarkerGlitch=n.prototype.isIE&&n.prototype.ieVersion<=12,n.prototype.MutationObserver=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver||function(e){this.callback=e,this.listeners=[];var t=function(e,t,n){this.callback=e,this.domNode=t,this.type=n};t.prototype={handleEvent:function(e){var t={type:this.type,target:this.domNode,addedNodes:[],removedNodes:[],previousSibling:e.target.previousSibling,nextSibling:e.target.nextSibling,attributeName:null,attributeNamespace:null,oldValue:null};this.callback([t])}},this.observe=function(e,n){var r=null;n.attributes&&(r=new t(this.callback,e,"attributes"),this.listeners.push(r),e.addEventListener("DOMAttrModified",r,!0)),n.characterData&&(r=new t(this.callback,e,"characterData"),this.listeners.push(r),e.addEventListener("DOMCharacterDataModified",r,!0)),n.childList&&(r=new t(this.callback,e,"childList"),this.listeners.push(r),e.addEventListener("DOMNodeInserted",r,!0),e.addEventListener("DOMNodeRemoved",r,!0))},this.disconnect=function(){this.listeners.forEach(function(e){switch(e.type){case"attributes":e.domNode.removeEventListener("DOMAttrModified",e,!0);break;case"characterData":e.domNode.removeEventListener("DOMCharacterDataModified",e,!0);break;case"childList":e.domNode.removeEventListener("DOMNodeRemoved",e,!0),e.domNode.removeEventListener("DOMNodeInserted",e,!0)}}),this.listeners=[]}},window.MutationObserver||(window.MutationObserver=n.prototype.MutationObserver),n.prototype.implements=function(e){for(var t in e)this[t]===undefined&&e.hasOwnProperty(t)&&(this[t]=e[t])},n.prototype.publish=function(e,t,n,r,i,s){if(this["__meta_"+e]!==undefined)throw e+" is already published.";this["__meta_"+e]={id:e,type:n,defaultValue:t,description:r,set:i,ext:s||{}},this[e]=function(t){var r=this._id===undefined;if(!arguments.length)return!r&&this["__prop_"+e]!==undefined?this["__prop_"+e]:this["__meta_"+e].defaultValue;switch(n){case"set":(!i||i.indexOf(t)<0)&&console.log("Invalid value for '"+e+"':  "+t);break;case"html-color":if(window.__hpcc_debug&&t&&t!=="red"){var s="red",o=document.createElement("div");o.style.color=s,o.style.color=t,(o.style.color===s||o.style.color==="")&&console.log("Invalid value for '"+e+"':  "+t)}break;case"boolean":t=typeof t=="string"&&["false","off","0"].indexOf(t.toLowerCase())>=0?!1:Boolean(t);break;case"number":t=Number(t);break;case"string":t=String(t);break;case"array":t instanceof Array||console.log("Invalid value for '"+e)}return r?this["__meta_"+e].defaultValue=t:(this.broadcast(e,t,this["__prop_"+e]),this["__prop_"+e]=t),this},this[e+"_modified"]=function(){var n=this._id===undefined;return n?this["__meta_"+e].defaultValue!==t:this["__prop_"+e]!==undefined},this[e+"_reset"]=function(){this["__prop_"+e]=undefined},this["__prop_"+e]=undefined},n.prototype.publishWidget=function(e,t,n){for(var r in t.prototype)if(r.indexOf("__meta")===0){var i=t.prototype[r];this.publishProxy(e+"__prop_"+i.id,n,i.method||i.id)}},n.prototype.publishProxy=function(e,t,n,r){n=n||e;if(this["__meta_"+e]!==undefined)throw e+" is already published.";this["__meta_"+e]={id:e,type:"proxy",proxy:t,method:n,defaultValue:r},this[e]=function(i){var s=this._id===undefined;if(s)throw"Setting default value of proxied properties is not supported.";return arguments.length?(r&&i===r?this[t][n+"_reset"]():this[t][n](i),this):!r||this[e+"_modified"]()?this[t][n]():r},this[e+"_modified"]=function(){var e=this._id===undefined;if(e)throw"Setting default values of proxied properties is not supported.";return this[t][n+"_modified"]()&&(!r||this[t][n]()!==r)},this[e+"_reset"]=function(){var e=this._id===undefined;if(e)throw"Setting default values of proxied properties is not supported.";this[t][n+"_reset"]()}},n.prototype.watch=function(e){var t=this,n=this._watchArr.push(e)-1;return{remove:function(){delete t._watchArr[n]}}},n.prototype.broadcast=function(e,t,n){this._watchArr&&this._watchArr.forEach(function(r){r&&setTimeout(function(){r(e,t,n)},0)})},n.prototype.on=function(t,n,r){if(this[t]===undefined)throw"Method:  "+t+" does not exist.";var i=this[t];return this[t]=function(){r?e.event.stopPropagation():i.apply(this,arguments),n.apply(this,arguments)},this},n.prototype.id=function(e){return arguments.length?(this._id=e,this):this._id},n.prototype.class=function(e){return arguments.length?(this._class=e,this):this._class},n.prototype.classID=function(){return this._class.split(" ").pop()},n.prototype.columns=function(e){return arguments.length?(this._columns=e,this):this._columns},n.prototype.data=function(e){return arguments.length?(this._data=e,this):this._data},n.prototype.cloneData=function(){return this._data.map(function(e){return e.slice(0)})},n.prototype.flattenData=function(){var e=[];return this.data().forEach(function(t,n){this.columns().filter(function(e,t){return t>0}).forEach(function(r,i){var s=t[i+1];if(s){var o={rowIdx:n,colIdx:i+1,label:t[0],value:s};e.push(o)}},this)},this),e},n.prototype.rowToObj=function(e){var t={};return this._columns.forEach(function(n,r){t[n]=e[r]}),e.length===this._columns.length+1&&(t.__lparam=e[this._columns.length]),t},n.prototype.pos=function(e){return arguments.length?(this._pos=e,this._overlayElement&&this._overlayElement.attr("transform","translate("+e.x+","+e.y+")scale("+this._scale+")"),this):this._pos},n.prototype.x=function(e){return arguments.length?(this.pos({x:e,y:this._pos.y}),this):this._pos.x},n.prototype.y=function(e){return arguments.length?(this.pos({x:this._pos.x,y:e}),this):this._pos.y},n.prototype.size=function(e){return arguments.length?(this._size=e,this._overlayElement&&this._overlayElement.attr("width",e.width).attr("height",e.height),this):this._size},n.prototype.width=function(e){return arguments.length?(this.size({width:e,height:this._size.height}),this):this._size.width},n.prototype.height=function(e){return arguments.length?(this.size({width:this._size.width,height:e}),this):this._size.height},n.prototype.resize=function(e,t){t=t||{width:0,height:0};var n,r;if(e&&e.width&&e.height)n=e.width,r=e.height;else{var i=window.getComputedStyle(this._target,null);n=parseFloat(i.getPropertyValue("width"))-t.width,r=parseFloat(i.getPropertyValue("height"))-t.height}return this.size({width:n,height:r}),this},n.prototype._scrollBarWidth=null,n.prototype.getScrollbarWidth=function(){if(n.prototype._scrollBarWidth===null){var e=document.createElement("div");e.style.visibility="hidden",e.style.width="100px",e.style.msOverflowStyle="scrollbar",document.body.appendChild(e);var t=e.offsetWidth;e.style.overflow="scroll";var r=document.createElement("div");r.style.width="100%",e.appendChild(r);var i=r.offsetWidth;e.parentNode.removeChild(e),n.prototype._scrollBarWidth=t-i}return n.prototype._scrollBarWidth},n.prototype.scale=function(e){return arguments.length?(this._scale=e,this._overlayElement&&this._overlayElement.attr("transform","translate("+e.x+","+e.y+")scale("+this._scale+")"),this):this._scale},n.prototype.visible=function(e){return arguments.length?(this._visible=e,this._parentElement&&this._parentElement.style("visibility",this._visible?null:"hidden"),this):this._visible},n.prototype.display=function(e){return arguments.length?(this._display=e,this._element&&this._element.style("display",this._display?null:"none"),this):this._display},n.prototype.calcSnap=function(e){function t(e,t){function n(e,t){var n=e%t;return Math.abs(n)>t-Math.abs(n)&&(n=(t-Math.abs(n))*(n<0?1:-1)),n}return e-n(e,t)}var n=t(this._pos.x-this._size.width/2,e),r=t(this._pos.y-this._size.height/2,e),i=t(this._pos.x+this._size.width/2,e),s=t(this._pos.y+this._size.height/2,e),o=i-n,u=s-r;return[{x:n+o/2,y:r+u/2},{width:o,height:u}]},n.prototype.toWidget=function(t){if(!t)return null;var n=e.select(t);if(n){var r=n.datum();if(r)return r}return null},n.prototype.locateParentWidget=function(e){if(!e)return null;var t=this.toWidget(e);return t?t:this.locateParentWidget(e.parentNode)},n.prototype.locateSVGNode=function(e){return e?e.tagName==="svg"?e:this.locateSVGNode(e.parentNode):null},n.prototype.locateOverlayNode=function(){var e=this.locateParentWidget(this._target);while(e){if(e._parentOverlay)return e._parentOverlay;e=this.locateParentWidget(e._target.parentNode)}return null},n.prototype.getAbsolutePos=function(e,t,n){var r=this.locateSVGNode(e);if(!r)return null;var i=r.createSVGPoint(),s=e.getCTM();i=i.matrixTransform(s);var o={x:i.x,y:i.y};if(t!==undefined&&n!==undefined){var u=r.createSVGPoint();u.x=t,u.y=n,u=u.matrixTransform(s),o.width=u.x-i.x,o.height=u.y-i.y}return o},n.prototype.hasOverlay=function(){return this._overlayElement},n.prototype.syncOverlay=function(){if(this._size.width&&this._size.height){var e=this.getAbsolutePos(this._overlayElement.node(),this._size.width,this._size.height);if(e&&(this.oldPos===null||this.oldPos===undefined||e.x!==this.oldPos.x||e.y!==this.oldPos.y||e.width!==this.oldPos.width||e.height!==this.oldPos.height)){var t=e.width/this._size.width,n=e.height/this._size.height;this._parentElement.style({left:e.x-e.width/t/2+"px",top:e.y-e.height/n/2+"px",width:e.width/t+"px",height:e.height/n+"px"});var r="scale("+t+","+n+")";this._parentElement.style("transform",r).style("-moz-transform",r).style("-ms-transform",r).style("-webkit-transform",r).style("-o-transform",r)}this.oldPos=e}},n.prototype.element=function(){return this._element},n.prototype.node=function(){return this._element.node()},n.prototype.render=function(t){if(!this._parentElement)return this;if(!this._tag)throw"No DOM tag specified";var n=this._parentElement.selectAll("#"+this._id).data([this],function(e){return e._id});return n.enter().append(this._tag).classed(this._class,!0).attr("id",this._id).each(function(t){t._element=e.select(this),t.enter(this,t._element)}),n.each(function(e){e.preUpdate(this,e._element),e.update(this,e._element),e.postUpdate(this,e._element)}),n.exit().each(function(t){t.exit(this,t._element)}).remove(),this._renderCount++,t&&t(this),this},n.prototype.enter=function(e,t){},n.prototype.preUpdate=function(e,t){},n.prototype.update=function(e,t){},n.prototype.postUpdate=function(e,t){},n.prototype.exit=function(e,t){},n.prototype.debounce=function(e,t,n){return function(){function o(){n||e.apply(i,s),i.timeout=null}var i=this||{},s=arguments;i.timeout?clearTimeout(i.timeout):n&&e.apply(i,s),i.timeout=setTimeout(o,t||100)}},n}),function(e,t){typeof define=="function"&&define.amd?define("common/Transition.js",[],t):e.common_Transition=t()}(this,function(){function e(e){this._widget=e,this._duration=250,this._delay=0,this._ease="cubic-in-out"}return e.prototype.duration=function(e){return arguments.length?(this._duration=e,this._widget):this._duration},e.prototype.delay=function(e){return arguments.length?(this._delay=e,this._widget):this._delay},e.prototype.ease=function(e){return arguments.length?(this._ease=e,this._widget):this._ease},e.prototype.apply=function(e){return this._duration||this._delay?e.transition().duration(this._duration).delay(this._delay).ease(this._ease):e},e}),function(e,t){typeof define=="function"&&define.amd?define("common/SVGWidget.js",["d3","./Widget","./Transition"],t):e.common_SVGWidget=t(e.d3,e.common_Widget,e.common_Transition)}(this,function(e,t,n){function r(){t.call(this),this._tag="g",this._boundingBox=null,this.transition=new n(this),this._drawStartPos="center"}r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype._class+=" common_SVGWidget",r.prototype.move=function(e,t){var n=this.pos.apply(this,arguments);return arguments.length&&(t?this._element.transition().duration(t):this._element).attr("transform","translate("+e.x+" "+e.y+")"),n},r.prototype.size=function(e){var n=t.prototype.size.apply(this,arguments);return arguments.length&&(this._boundingBox=null),n},r.prototype.resize=function(e){var n=t.prototype.resize.apply(this,arguments);this._parentRelativeDiv.style({width:this._size.width+"px",height:this._size.height+"px"}),this._parentElement.attr("width",this._size.width).attr("height",this._size.height);switch(this._drawStartPos){case"origin":this.pos({x:0,y:0});break;case"center":default:this.pos({x:this._size.width/2,y:this._size.height/2})}return n},r.prototype.target=function(t){if(!arguments.length)return this._target;if(this._target&&t&&this._target.__data__.id!==t.__data__.id)throw"Target can only be assigned once.";this._target=t;if(typeof this._target=="string"||this._target instanceof String)this._target=document.getElementById(this._target);if(this._target instanceof SVGElement){this._parentElement=e.select(this._target),this._parentWidget=this._parentElement.datum();if(!this._parentWidget||this._parentWidget._id===this._id)this._parentWidget=this.locateParentWidget(this._target.parentNode)}else this._target?(this._parentRelativeDiv=e.select(this._target).append("div").style({position:"relative"}),this._parentElement=this._parentRelativeDiv.append("svg").style({position:"absolute",top:0,left:0}),this._parentOverlay=this._parentRelativeDiv.append("div").style({position:"absolute",top:0,left:0}),this.resize(this._size)):this.exit();return this},r.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments)},r.prototype.update=function(e,n){t.prototype.update.apply(this,arguments)},r.prototype.postUpdate=function(e,n){t.prototype.postUpdate.apply(this,arguments),this._drawStartPos==="origin"&&this._target instanceof SVGElement?this._element.attr("transform","translate("+(this._pos.x-this._size.width/2)+","+(this._pos.y-this._size.height/2)+")scale("+this._scale+")"):this._element.attr("transform","translate("+this._pos.x+","+this._pos.y+")scale("+this._scale+")")},r.prototype.exit=function(e,n){this._parentRelativeDiv&&(this._parentOverlay.remove(),this._parentElement.remove(),this._parentRelativeDiv.remove()),t.prototype.exit.apply(this,arguments)},r.prototype.getOffsetPos=function(){var e={x:0,y:0};return this._parentWidget?(e=this._parentWidget.getOffsetPos(),e.x+=this._pos.x,e.y+=this._pos.y,e):e},r.prototype.getBBox=function(e,t){if(e||this._boundingBox===null){var n=this._element.node();n instanceof SVGElement&&(this._boundingBox=n.getBBox())}return this._boundingBox===null?{x:0,y:0,width:0,height:0}:{x:(t?Math.round(this._boundingBox.x):this._boundingBox.x)*this._scale,y:(t?Math.round(this._boundingBox.y):this._boundingBox.y)*this._scale,width:(t?Math.round(this._boundingBox.width):this._boundingBox.width)*this._scale,height:(t?Math.round(this._boundingBox.height):this._boundingBox.height)*this._scale}},r.prototype.intersection=function(e,t){return this.intersectRect(e,t)};var i=function(e,t,n){return{x:e.x+(t.x-e.x)*n,y:e.y+(t.y-e.y)*n}},s=function(e,t,n,r){var i={type:"",points:[]},s=(r.x-n.x)*(e.y-n.y)-(r.y-n.y)*(e.x-n.x),o=(t.x-e.x)*(e.y-n.y)-(t.y-e.y)*(e.x-n.x),u=(r.y-n.y)*(t.x-e.x)-(r.x-n.x)*(t.y-e.y);if(u!==0){var a=s/u,f=o/u;0<=a&&a<=1&&0<=f&&f<=1?(i.type="Intersection",i.points.push({x:e.x+a*(t.x-e.x),y:e.y+a*(t.y-e.y)})):i.type="No Intersection"}else s===0||o===0?i.type="Coincident":i.type="Parallel";return i};r.prototype.intersectRect=function(e,t){var n=this.getOffsetPos(),r=this.getBBox();if(e.x===t.x&&e.y===t.y)return e;var i={x:n.x-r.width/2,y:n.y-r.height/2},o={x:n.x+r.width/2,y:n.y-r.height/2},u={x:n.x+r.width/2,y:n.y+r.height/2},a={x:n.x-r.width/2,y:n.y+r.height/2},f=s(i,o,e,t);return f.points.length?{x:f.points[0].x,y:f.points[0].y}:(f=s(o,u,e,t),f.points.length?{x:f.points[0].x,y:f.points[0].y}:(f=s(u,a,e,t),f.points.length?{x:f.points[0].x,y:f.points[0].y}:(f=s(a,i,e,t),f.points.length?{x:f.points[0].x,y:f.points[0].y}:null)))};var o=function(e,t,n,r){var s={type:"",points:[]},o=(r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y),u=2*((r.x-n.x)*(n.x-e.x)+(r.y-n.y)*(n.y-e.y)),a=e.x*e.x+e.y*e.y+n.x*n.x+n.y*n.y-2*(e.x*n.x+e.y*n.y)-t*t,f=u*u-4*o*a;if(f<0)s.type="Outside";else if(f===0)s.type="Tangent";else{var l=Math.sqrt(f),c=(-u+l)/(2*o),h=(-u-l)/(2*o);(c<0||c>1)&&(h<0||h>1)?c<0&&h<0||c>1&&h>1?s.type="Outside":s.type="Inside":(s.type="Intersection",0<=c&&c<=1&&s.points.push(i(n,r,c)),0<=h&&h<=1&&s.points.push(i(n,r,h)))}return s};return r.prototype.intersectCircle=function(e,t){var n=this.getOffsetPos(),r=this.radius(),i=o(n,r,e,t);return i.points.length?{x:i.points[0].x,y:i.points[0].y}:null},r.prototype.distance=function(e,t){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))},r.prototype._pushMarkers=function(e,t){this.svgMarkerGlitch&&(e=e||this._element,e.selectAll("path[marker-start],path[marker-end]").attr("fixme-start",function(e){return this.getAttribute("marker-start")}).attr("fixme-end",function(e){return this.getAttribute("marker-end")}).attr("marker-start",null).attr("marker-end",null))},r.prototype._popMarkers=function(e,t){this.svgMarkerGlitch&&(e=e||this._element,e.selectAll("path[fixme-start],path[fixme-end]").attr("marker-start",function(e){return this.getAttribute("fixme-start")}).attr("marker-end",function(e){return this.getAttribute("fixme-end")}).attr("fixme-start",null).attr("fixme-end",null))},r.prototype._popMarkersDebounced=t.prototype.debounce(function(e,t){this.svgMarkerGlitch&&this._popMarkers(e,t)},250),r.prototype._fixIEMarkers=function(e,t){this.svgMarkerGlitch&&(this._pushMarkers(e,t),this._popMarkersDebounced(e,t))},r}),typeof define=="function"&&define.amd&&define("css",[],function(){return{load:function(e,t,n){n()}}}),function(e,t){typeof define=="function"&&define.amd?define("common/Text.js",["./SVGWidget","css!./Text"],t):e.common_Text=t(e.common_SVGWidget)}(this,function(e){function t(){e.call(this)}return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.prototype._class+=" common_Text",t.prototype.publish("text","","string","Display Text",null,{tags:["Private"]}),t.prototype.publish("fontFamily","","string","Font Family",null,{tags:["Private"]}),t.prototype.publish("fontSize",null,"number","Font Size (px)",null,{tags:["Private"]}),t.prototype.publish("anchor","middle","set","Anchor Position",["start","middle","end"],{tags:["Private"]}),t.prototype.publish("colorFill",null,"html-color","Fill Color",null,{tags:["Private"]}),t.prototype.testData=function(){return this.text("Hello\nand\nWelcome!"),this},t.prototype.enter=function(t,n){e.prototype.enter.apply(this,arguments),this._textElement=n.append("text")},t.prototype.update=function(t,n){e.prototype.update.apply(this,arguments),this._textElement.attr("font-family",this.fontFamily()).attr("font-size",this.fontSize());var r=this.text().split("\n"),i=this._textElement.selectAll("tspan").data(r,function(e){return e});i.enter().append("tspan").attr("class",function(e,t){return"tspan_"+t}).attr("dy","1em").attr("x","0"),i.style("fill",this.colorFill()).text(function(e){return e}),i.exit().remove();var s={width:0,height:0};try{s=this._textElement.node().getBBox()}catch(o){}var u=0;switch(this.anchor()){case"start":u=-s.width/2;break;case"end":u=s.width/2}var a=-(s.y+s.height/2);this._textElement.style("text-anchor",this.anchor()).attr("transform",function(e){return"translate("+u+","+a+")"})},t}),function(e,t){typeof define=="function"&&define.amd?define("common/FAChar",["./SVGWidget","./Text","css!font-awesome","css!./FAChar"],t):e.common_FAChar=t(e.common_SVGWidget,e.common_Text)}(this,function(e,t){function n(){e.call(this),this._text=(new t).fontFamily("FontAwesome")}return n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype._class+=" common_FAChar",n.prototype.publish("char","","string","Font Awesome Item",null,{tags:["Private"]}),n.prototype.publish("fontSize",null,"number","Font Size",null,{tags:["Private"]}),n.prototype.publishProxy("text_colorFill","_text","colorFill"),n.prototype.testData=function(){return this.char(""),this},n.prototype.enter=function(t,n){e.prototype.enter.apply(this,arguments),this._text.target(t)},n.prototype.update=function(t,n){e.prototype.update.apply(this,arguments),this._text.text(this.char()).scale((this.fontSize()||14)/14).render()},n}),function(e,t){typeof define=="function"&&define.amd?define("common/HTMLWidget.js",["d3","./Widget","./Transition"],t):e.common_HTMLWidget=t(e.d3,e.common_Widget,e.common_Transition)}(this,function(e,t,n){function r(){t.call(this),this._drawStartPos="origin"}return r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype._class+=" common_HTMLWidget",r.prototype.calcFrameWidth=function(e){var t=parseFloat(e.style("padding-left"))+parseFloat(e.style("padding-right"))+parseFloat(e.style("margin-left"))+parseFloat(e.style("margin-right"))+parseFloat(e.style("border-left-width"))+parseFloat(e.style("border-right-width"));return t},r.prototype.calcWidth=function(e){return parseFloat(e.style("width"))-this.calcFrameWidth(e)},r.prototype.calcFrameHeight=function(e){var t=parseFloat(e.style("padding-top"))+parseFloat(e.style("padding-bottom"))+parseFloat(e.style("margin-top"))+parseFloat(e.style("margin-bottom"))+parseFloat(e.style("border-top-width"))+parseFloat(e.style("border-bottom-width"));return t},r.prototype.calcHeight=function(e){return parseFloat(e.style("height"))+this.calcFrameHeight(e)},r.prototype.clientWidth=function(){return this._size.width-this.calcFrameWidth(this._element)},r.prototype.clientHeight=function(){return this._size.height-this.calcFrameHeight(this._element)},r.prototype.getBBox=function(e,t){if(e||this._boundingBox===null){var n=this._element.node();if(n instanceof Element){var r=n.getBoundingClientRect();this._boundingBox={x:r.left,y:r.top,width:r.width,height:r.height}}}return this._boundingBox===null?{x:0,y:0,width:0,height:0}:{x:(t?Math.round(this._boundingBox.x):this._boundingBox.x)*this._scale,y:(t?Math.round(this._boundingBox.y):this._boundingBox.y)*this._scale,width:(t?Math.round(this._boundingBox.width):this._boundingBox.width)*this._scale,height:(t?Math.round(this._boundingBox.height):this._boundingBox.height)*this._scale}},r.prototype.resize=function(e){var n=t.prototype.resize.apply(this,arguments);return this._parentElement.style("width",this._size.width+"px").style("height",this._size.height+"px"),n},r.prototype.target=function(t){if(!arguments.length)return this._target;if(this._target&&t)throw"Target can only be assigned once.";this._target=t;if(typeof this._target=="string"||this._target instanceof String)this._target=document.getElementById(this._target);if(this._target instanceof SVGElement){var n=this.locateOverlayNode();this._parentElement=n.append("div").style({position:"absolute",top:0,left:0,overflow:"hidden"}),this._overlayElement=e.select(this._target);var r=this;this.oldPos=null,this.observer=new this.MutationObserver(function(e){r.syncOverlay()});var i=this._overlayElement.node();while(i)this.observer.observe(i,{attributes:!0}),i=i.parentNode}else if(this._target){this._parentElement=e.select(this._target);if(!this._size.width&&!this._size.height){var s=parseFloat(this._parentElement.style("width")),o=parseFloat(this._parentElement.style("height"));this.size({width:s,height:o})}this._parentElement=e.select(this._target).append("div")}else this.exit();return this},r.prototype.postUpdate=function(e,n){t.prototype.postUpdate.apply(this,arguments);if(this._drawStartPos==="origin")this._element.style({position:"relative",left:this._pos.x+"px",top:this._pos.y+"px"});else{var r=this.getBBox(!0);this._element.style({position:"relative","float":"left",left:this._pos.x+(this._size.width-r.width)/2+"px",top:this._pos.y+(this._size.height-r.height)/2+"px"})}},r.prototype.exit=function(e,n){this.observer&&this.observer.disconnect(),this.oldPos=null,this._parentElement&&this._parentElement.remove(),t.prototype.exit.apply(this,arguments)},r}),function(e,t){typeof define=="function"&&define.amd?define("common/Shape.js",["d3","./SVGWidget","css!./Shape"],t):e.common_Shape=t(e.d3,e.common_SVGWidget)}(this,function(e,t){function n(){t.call(this)}return n.prototype=Object.create(t.prototype),n.prototype.constructor=n,n.prototype._class+=" common_Shape",n.prototype.publish("shape","circle","set","Shape Type",["circle","square","rect","ellipse"],{tags:["Private"]}),n.prototype.publish("width",24,"number","Width",null,{tags:["Private"]}),n.prototype.publish("height",24,"number","Height",null,{tags:["Private"]}),n.prototype.publish("colorStroke",null,"html-color","Stroke Color",null,{tags:["Private"]}),n.prototype.publish("colorFill",null,"html-color","Fill Color",null,{tags:["Private"]}),n.prototype.radius=function(e){return arguments.length?(this.width(e),this.height(e),this):Math.max(this.width(),this.height())/2},n.prototype.testData=function(){return this},n.prototype.intersection=function(e,n){switch(this.shape()){case"circle":return this.intersectCircle(e,n)}return t.prototype.intersection.apply(this,arguments)},n.prototype.update=function(t,n){var r=n.selectAll("rect,circle,ellipse").data([this.shape()],function(e){return e});r.enter().append(this.shape()==="square"?"rect":this.shape()).attr("class","common_Shape");var i=this;r.each(function(t){var n=e.select(this);n.style({fill:i.colorFill(),stroke:i.colorStroke()});switch(i.shape()){case"circle":var r=i.radius();n.attr("r",r);break;case"square":var s=Math.max(i.width(),i.height());n.attr("x",-s/2).attr("y",-s/2).attr("width",s).attr("height",s);break;case"rect":n.attr("x",-i.width()/2).attr("y",-i.height()/2).attr("width",i.width()).attr("height",i.height());break;case"ellipse":n.attr("rx",i.width()/2).attr("ry",i.height()/2)}}),r.exit().remove()},n}),function(e,t){typeof define=="function"&&define.amd?define("common/Icon",["./SVGWidget","./Shape","./FAChar","css!./Icon"],t):e.common_Icon=t(e.common_SVGWidget,e.common_Shape,e.common_FAChar)}(this,function(e,t,n){function r(){e.call(this),this._shapeWidget=new t,this._faChar=new n}return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype._class+=" common_Icon",r.prototype.publish("shape","circle","set","Shape Type",["circle","square"],{tags:["Private"]}),r.prototype.publishProxy("faChar","_faChar","char"),r.prototype.publishProxy("image_colorFill","_faChar","text_colorFill"),r.prototype.publish("tooltip","","string","Tooltip",null,{tags:["Private"]}),r.prototype.publish("diameter",24,"number","Diameter",null,{tags:["Private"]}),r.prototype.publish("paddingPercent",45,"number","Padding Percent",null,{tags:["Private"]}),r.prototype.publishProxy("shape_colorFill","_shapeWidget","colorFill"),r.prototype.publishProxy("shape_colorStroke","_shapeWidget","colorStroke"),r.prototype.testData=function(){return this._faChar.testData(),this},r.prototype.intersection=function(e,t){return this._shapeWidget.intersection(e,t)},r.prototype.enter=function(t,n){e.prototype.enter.apply(this,arguments),this._shapeWidget.target(t).render(),this._faChar.target(t).render(),this._tooltipElement=n.append("title");var r=this;n.on("click",function(e){r.click(e)})},r.prototype.click=function(e){console.log("Clicked the icon")},r.prototype.update=function(t,n){e.prototype.update.apply(this,arguments),this._faChar.fontSize(this.diameter()*(100-this.paddingPercent())/100).render(),this._shapeWidget.shape(this.shape()).width(this.diameter()).height(this.diameter()).render(),this._tooltipElement.text(this.tooltip())},r}),function(e,t){typeof define=="function"&&define.amd?define("common/IList",[],t):e.common_IList=t()}(this,function(){function e(){}return e.prototype.testData=function(){var e=["This","is a","list","of some text."];return this.data(e),this},e.prototype.click=function(e){console.log("Click:  "+e)},e}),function(e,t){typeof define=="function"&&define.amd?define("common/IMenu",[],t):e.common_IMenu=t()}(this,function(){function e(){}return e.prototype.testData=function(){var e=["This","is a","list","of some text."];return this.data(e),this},e.prototype.click=function(e){console.log("Click:  "+e)},e.prototype.preShowMenu=function(){console.log("preShowMenu")},e.prototype.postHideMenu=function(e){console.log("postHideMenu")},e}),function(e,t){typeof define=="function"&&define.amd?define("common/TextBox.js",["./SVGWidget","./Shape","./Text","css!./TextBox"],t):e.common_TextBox=t(e.common_SVGWidget,e.common_Shape,e.common_Text)}(this,function(e,t,n){function r(){e.call(this),this._shape=(new t).shape("rect"),this._text=new n}return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype._class+=" common_TextBox",r.prototype.publishProxy("text","_text"),r.prototype.publishProxy("shape_colorStroke","_shape","colorStroke"),r.prototype.publishProxy("shape_colorFill","_shape","colorFill"),r.prototype.publishProxy("text_colorFill","_text","colorFill"),r.prototype.publish("paddingLeft",4,"number","Padding:  Left",null,{tags:["Private"]}),r.prototype.publish("paddingRight",4,"number","Padding:  Right",null,{tags:["Private"]}),r.prototype.publish("paddingTop",4,"number","Padding:  Top",null,{tags:["Private"]}),r.prototype.publish("paddingBottom",4,"number","Padding:  Bottom",null,{tags:["Private"]}),r.prototype.publishProxy("anchor","_text"),r.prototype.publish("fixedSize",null),r.prototype.padding=function(e){return this.paddingLeft(e),this.paddingRight(e),this.paddingTop(e),this.paddingBottom(e),this},r.prototype.testData=function(){return this._text.testData(),this},r.prototype.enter=function(t,n){e.prototype.enter.apply(this,arguments),this._shape.target(t).render(),this._text.target(t).render()},r.prototype.update=function(t,n){e.prototype.update.apply(this,arguments),this._text.render();var r=this._text.getBBox(!0),i={width:this.fixedSize()?this.fixedSize().width:r.width+this.paddingLeft()+this.paddingRight(),height:this.fixedSize()?this.fixedSize().height:r.height+this.paddingTop()+this.paddingBottom()};this._shape.width(i.width).height(i.height).render();if(this.fixedSize())switch(this.anchor()){case"start":this._text.x(-this.fixedSize().width/2+r.width/2+(this.paddingLeft()+this.paddingRight())/2).render();break;case"end":this._text.x(this.fixedSize().width/2-r.width/2-(this.paddingLeft()+this.paddingRight())/2).render()}},r}),function(e,t){typeof define=="function"&&define.amd?define("common/List",["d3","../common/SVGWidget","./IList","../common/TextBox","css!./List"],t):e.common_List=t(e.d3,e.common_SVGWidget,e.common_IList,e.common_TextBox)}(this,function(e,t,n,r){function i(e){t.call(this),n.call(this),this._listWidgets={}}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" common_List",i.prototype.implements(n.prototype),i.prototype.publish("anchor","start","set","Anchor Position",["","start","middle","end"],{tags:["Private"]}),i.prototype.update=function(e,n){t.prototype.update.apply(this,arguments);var i=this,s=n.selectAll(".line").data(this._data,function(e){return e});s.enter().append("g").attr("class","line").each(function(e){var t=(new r).target(this).paddingTop(0).paddingBottom(0).paddingLeft(8).paddingRight(8).text(e).render();t.element().on("click",function(e){i.click(e.text())}),i._listWidgets[e]=t});var o=0,u=0,a=0;for(var f in this._listWidgets){if(!this._listWidgets.hasOwnProperty(f))continue;var l=this._listWidgets[f].getBBox();o+=l.height,u<l.width&&(u=l.width),++a}var c=-o/2;s.each(function(e){var t=i._listWidgets[e],n=t.getBBox();t.pos({x:0,y:c+n.height/2}).anchor(i.anchor()).fixedSize({width:u,height:n.height}).render(),c+=n.height}),s.exit().remove().each(function(e){delete i._listWidgets[e]})},i}),function(e,t){typeof define=="function"&&define.amd?define("common/Menu",["d3","./SVGWidget","./IMenu","./Icon","./List","css!./Menu"],t):e.common_Menu=t(e.d3,e.common_SVGWidget,e.common_IMenu,e.common_Icon,e.common_List)}(this,function(e,t,n,r,i){function s(){t.call(this),n.call(this),this._icon=(new r).shape("square").diameter(14),this._list=new i;var s=this;this._list.click=function(t){e.event.stopPropagation(),s.hideMenu(),s.click(t)},this._visible=!1}return s.prototype=Object.create(t.prototype),s.prototype.constructor=s,s.prototype._class+=" common_Menu",s.prototype.implements(n.prototype),s.prototype.publishProxy("faChar","_icon",null,""),s.prototype.publishProxy("paddingPercent","_icon",null,10),s.prototype.toggleMenu=function(){this._visible?this.hideMenu():this.showMenu()},s.prototype.showMenu=function(){this.preShowMenu(),this._visible=!0,this._list.data(this._data).render();var t=this._icon.getBBox(!0),n=this._list.getBBox(!0),r={x:t.width/2-n.width/2,y:t.height/2+n.height/2};this._list.move(r);var i=this;e.select("body").on("click."+this._id,function(){console.log("click:  body - "+i._id),i._visible&&i.hideMenu()})},s.prototype.hideMenu=function(){e.select("body").on("click."+this._id,null),this._visible=!1,this._list.data([]).render(),this.postHideMenu()},s.prototype.testData=function(){return this.data(["Menu A","And B","a longer C"]),this},s.prototype.enter=function(n,r){t.prototype.enter.apply(this,arguments),this._icon.target(n).render(),this._list.target(n).render();var i=this;this._icon.element().on("click",function(t){e.event.stopPropagation(),i.toggleMenu()})},s.prototype.update=function(e,n){t.prototype.update.apply(this,arguments),n.classed("disabled",this._data.length===0),this._icon.faChar(this.faChar()).paddingPercent(this.paddingPercent()).render()},s}),function(e,t){typeof define=="function"&&define.amd?define("common/Palette.js",["d3","colorbrewer"],t):e.common_Palette=t(e.d3)}(this,function(e){function s(e,t){if(!e)return o();var n=i[e];return n||(n=o(e,t),i[e]=n),n}function o(u,a){function p(e){return f(e)}if(!u)return["default"].concat(t.concat(n).concat(r));var f=null;if(a)f=e.scale.ordinal().range(a);else{if(t.indexOf(u)>=0)f=new e.scale[u];else if(r.indexOf(u)>=0){var l=[];switch(u){case"hpcc10":var c=o("default").colors();l=c.filter(function(e,t){return t%2?!0:!1});break;case"hpcc20":l=o("category10").colors().concat(o("hpcc10").colors())}f=e.scale.ordinal().range(l)}else if(n.indexOf(u)>0){var h=12;while(h>0){if(colorbrewer[u][h]){f=e.scale.ordinal().range(colorbrewer[u][h]);break}--h}}f||(f=e.scale.category20()),a=f.range()}return p.id=function(e){return arguments.length?(u=e,p):u},p.colors=function(e){return arguments.length?(a=e,p):a},p.clone=function(e){return i[e]=o(e,this.colors()),i[e]},p.cloneNotExists=function(e){return i[e]?i[e]:this.clone(e)},p.switch=function(e,t){return u===e?this:arguments.length?s(e,t):s()},p}function a(e,t,n){if(!e)return f();var r=u[e];return r||(r=f(e,t),u[e]=r),r}function f(t,r,i){function d(e,t,n){return l.domain([t,n])(e)}if(!arguments.length){var s=["default"];for(var o in colorbrewer)n.indexOf(o)===-1&&s.push(o);return s}var l=null,c=r,h=function(t,n){n=n||32;var r=Math.ceil(n/(t.length-1)),i=[],s=null;return t.forEach(function(t){if(s){var n=e.scale.linear().domain([0,r]).range([s,t]).interpolate(e.interpolateLab);for(var o=0;o<r;++o)i.push(n(o))}s=t}),l=e.scale.quantize().domain([0,100]).range(i),l};if(r)l=h(r,i);else{if(colorbrewer[t]){var p=12;while(p>0){if(colorbrewer[t][p]){l=h(colorbrewer[t][p]);break}--p}}l||(l=h(colorbrewer.RdYlGn[11])),c=l.range()}return d.id=function(e){return arguments.length?(t=e,d):t},d.colors=function(e){return arguments.length?(c=e,d):c},d.clone=function(e){return u[e]=f(e,this.color()),u[e]},d.cloneNotExists=function(e){return u[e]?u[e]:this.clone(e)},d.switch=function(e,n){return t===e?this:arguments.length?a(e,n):a()},d}var t=["category10","category20","category20b","category20c"],n=["Accent","Dark2","Paired","Pastel1","Pastel2","Set1","Set2","Set3"],r=["hpcc10","hpcc20"],i={},u={},l=function(t,n,r,i,s){e.select(t).selectAll(".palette").data(o(),function(e){return e}).enter().append("span").attr("class","palette").attr("title",function(e){return e}).on("click",function(t){console.log(e.values(t.value).map(JSON.stringify).join("\n"))}).selectAll(".swatch").data(function(e){return o(e).colors()}).enter().append("span").attr("class","swatch").style("background-color",function(e){return e}),e.select(n).selectAll(".palette").data(f(),function(e){return e}).enter().append("span").attr("class","palette").attr("title",function(e){return e}).on("click",function(t){console.log(e.values(t.value).map(JSON.stringify).join("\n"))}).selectAll(".swatch2").data(function(e){return f(e).colors()}).enter().append("span").attr("class","swatch2").style("height","8px").style("background-color",function(e){return e});var u={id:i.join("_")+s,scale:f("custom",i,s)};e.select(r).selectAll(".palette").data([u],function(e){return e.id}).enter().append("span").attr("class","palette").attr("title",function(e){return"aaa"}).on("click",function(t){console.log(e.values(t.value).map(JSON.stringify).join("\n"))}).selectAll(".swatch2").data(function(e){var t=[];for(var n=0;n<=255;++n)t.push(u.scale(n,0,255));return t}).enter().append("span").attr("class","swatch2").style("background-color",function(e){return e})};return{ordinal:s,rainbow:a,test:l}}),function(e,t){typeof define=="function"&&define.amd?define("common/Surface.js",["d3","./SVGWidget","./Icon","./Shape","./Text","./FAChar","./Menu","css!./Surface"],t):e.common_Surface=t(e.d3,e.common_SVGWidget,e.common_Icon,e.common_Shape,e.common_Text,e.common_FAChar,e.common_Menu)}(this,function(e,t,n,r,i,s,o){function u(){t.call(this),this._menuPadding=2,this._icon=(new n).faChar("").paddingPercent(50),this._container=(new r).class("container").shape("rect"),this._titleRect=(new r).class("title").shape("rect"),this._text=(new i).class("title"),this._menu=(new o).paddingPercent(0);var e=this;this._menu.preShowMenu=function(){e._content&&e._content.hasOverlay()&&e._content.visible(!1)},this._menu.postHideMenu=function(){e._content&&e._content.hasOverlay()&&e._content.visible(!0)},this._showContent=!0,this._content=null,this._surfaceButtons=[]}return u.prototype=Object.create(t.prototype),u.prototype.constructor=u,u.prototype._class+=" common_Surface",u.prototype.publish("showTitle",!0,"boolean","Show Title",null,{tags:["Basic"]}),u.prototype.publish("title","","string","Title",null,{tags:["Basic"]}),u.prototype.publishProxy("titleFontSize","_text","fontSize"),u.prototype.publish("showIcon",!0,"boolean","Show Title",null,{tags:["Advance"]}),u.prototype.publishProxy("icon_faChar","_icon","faChar"),u.prototype.publishProxy("icon_shape","_icon","shape"),u.prototype.publish("content",null,"widget","Content",null,{tags:["Private"]}),u.prototype.publish("buttonAnnotations",[],"array","Button Array",null,{tags:["Intermediate"]}),u.prototype.publish("buttonGutter",25,"number","Space Between Menu and Buttons",null,{tags:["Intermediate"]}),u.prototype.menu=function(e){return arguments.length?(this._menu.data(e),this):this._menu.data()},u.prototype.showContent=function(e){return arguments.length?(this._showContent=e,this._content&&this._content.visible(this._showContent),this):this._showContent},u.prototype.testData=function(){return this.title("Hello and welcome!"),this.menu(["aaa","bbb","ccc"]),this.buttonAnnotations([{id:"button_1",label:"",shape:"square",diameter:14,padding:"0px 5px",font:"FontAwesome"},{id:"button_2",label:"",shape:"square",diameter:14,padding:"0px 5px",font:"FontAwesome"}]),this},u.prototype.enter=function(n,r){t.prototype.enter.apply(this,arguments);var i=r.append("g").attr("class","frame"),s=i.node();this._clipRect=i.append("defs").append("clipPath").attr("id",this.id()+"_clip").append("rect").attr("x",0).attr("y",0).attr("width",this._size.width).attr("height",this._size.height),this._titleRect.target(s).render().display(this.showTitle()&&this.showIcon()),this._icon.target(s).render(),this._menu.target(n),this._text.target(s),this._container.target(s),this.buttonContainer=e.select(this._target).append("div").attr("class","svg-button-container")},u.prototype.update=function(n,r){t.prototype.update.apply(this,arguments);var i=this,s=this.width()-1,o=this.height()-1;this._icon.display(this.showTitle()&&this.showIcon()).shape(this.icon_shape()).render(),this._menu.render(),this._text.text(this.title()).display(this.showTitle()).render();var u=this.buttonContainer.selectAll(".surface-button").data(this.buttonAnnotations());u.enter().append("button").attr("class","surface-button").each(function(t,n){var r=i._surfaceButtons[n]=e.select(this).attr("class","surface-button "+(t.class?t.class:"")).attr("id",t.id).style("padding",t.padding).style("width",t.width).style("height",t.height).style("cursor","pointer").on("click",function(e){i.click(e)});t.font==="FontAwesome"?r.append("i").attr("class","fa").text(function(e){return t.label}):r.text(function(e){return t.label})}),u.exit().each(function(t,n){var r=e.select(this);delete i._surfaceButtons[n],r.remove()});var a=this.showTitle()?Math.max.apply(null,this._surfaceButtons.map(function(e){return e.node().offsetHeight})):0,f=this.showIcon()?this._icon.getBBox(!0):{width:0,height:0},l=this._text.getBBox(!0),c=this._menu.getBBox(!0),h=Math.max(f.height,l.height,c.height,a),p=(-o+h)/2,d=Math.max(l.height,c.height,a),v=h<=d?0:(h-d)/2,m=v;this._titleRect.pos({x:m,y:p}).width(s-m*2).height(d).display(this.showTitle()).render(),this._icon.move({x:-s/2+f.width/2,y:p}),this._menu.move({x:s/2-c.width/2-this._menuPadding,y:p}),this._text.move({x:(f.width/2-c.width/2)/2,y:p});var g=i._titleRect.node().getBoundingClientRect().left+(i._size.width-m*2)-i.buttonGutter()-this.buttonContainer.node().offsetWidth,y=i._titleRect.node().getBoundingClientRect().top+(d-this.buttonContainer.node().offsetHeight)/2;isNaN(g)||this.buttonContainer.style("left",g+"px"),isNaN(y)||this.buttonContainer.style("top",y+"px"),this.showTitle()?this._container.pos({x:m/2,y:h/2-v/2}).width(s-m).height(o-h+v).render():this._container.pos({x:0,y:0}).width(s).height(o).render();if(this._showContent){var b=m,w=h-v,E=r.selectAll(".content").data(this.content()?[this.content()]:[],function(e){return e._id});E.enter().append("g").attr("class","content").attr("clip-path","url(#"+this.id()+"_clip)").each(function(e){e.target(this)}),E.each(function(e){var t={left:4,top:4,right:4,bottom:4};e.pos({x:b/2,y:w/2}).size({width:s-b-(t.left+t.right),height:o-w-(t.top+t.bottom)})}),this.content()&&this._clipRect.attr("x",-s/2+b).attr("y",-o/2+w).attr("width",s-b).attr("height",o-w),E.exit().transition().each(function(e){e.target(null)}).remove()}this._menu.element().node().parentNode.appendChild(this._menu.element().node())},u.prototype.exit=function(e,n){this.content()&&this.content().target(null),t.prototype.exit.apply(this,arguments)},u.prototype.render=function(e){this.content()||t.prototype.render.apply(this,arguments),t.prototype.render.call(this);var n=this;return this.content()&&this.content().render(function(t){e&&e(n)}),this},u.prototype.intersection=function(e,t){var n=[],r=this._icon.intersection(e,t,this._pos);r&&n.push({i:r,d:this.distance(r,t)});var i=this._titleRect.intersection(e,t);i&&n.push({i:i,d:this.distance(i,t)});var s=this._container.intersection(e,t);s&&n.push({i:s,d:this.distance(s,t)});var o=null;return n.forEach(function(e){if(o===null||o.d>e.d)o=e}),o&&o.i?o.i:null},u.prototype.click=function(e,t){console.log("Clicked: "+e.id)},u}),function(e,t){typeof define=="function"&&define.amd?define("common/ResizeSurface.js",["d3","./Surface","css!./ResizeSurface"],t):e.common_ResizeSurface=t(e.d3,e.common_Surface)}(this,function(e,t){function n(){t.call(this),this.handleWidth=8,this.handles=[{loc:"NW"},{loc:"N"},{loc:"NE"},{loc:"E"},{loc:"SE"},{loc:"S"},{loc:"SW"},{loc:"W"}],this._allowResize=!0;var n=this;this.dispatch=e.dispatch("sizestart","size","sizeend"),this.drag=e.behavior.drag().origin(function(e){return e}).on("dragstart",function(t){n.dispatch.sizestart(n,t.loc),n._allowResize&&(e.event.sourceEvent.stopPropagation(),n._dragHandlePos={x:t.x,y:t.y},n._dragStartPos=n.pos(),n._dragStartSize=n.size(),n._prevPosSize={x:n._dragStartPos.x,y:n._dragStartPos.y,width:n._dragStartSize.width,height:n._dragStartSize.height},n._textPosSize=n._text.getBBox(!0),n._iconPosSize=n._icon.getBBox(!0),n.showContent(!1))}).on("drag",function(t){if(n._allowResize){e.event.sourceEvent.stopPropagation();var r=e.event.x-n._dragHandlePos.x,i=e.event.y-n._dragHandlePos.y,s={x:0,y:0,w:0,h:0};switch(t.loc){case"NW":s.x=r/2,s.w=-r;case"N":s.y=i/2,s.h=-i;break;case"NE":s.y=i/2,s.h=-i;case"E":s.x=r/2,s.w=r;break;case"SE":s.x=r/2,s.w=r;case"S":s.y=i/2,s.h=i;break;case"SW":s.y=i/2,s.h=i;case"W":s.x=r/2,s.w=-r}var o={x:n._dragStartPos.x+s.x,y:n._dragStartPos.y+s.y,width:n._dragStartSize.width+s.w,height:n._dragStartSize.height+s.h};o.width<n._iconPosSize.width*2+n._textPosSize.width&&(o.x=n._prevPosSize.x,o.width=n._prevPosSize.width),o.height<n._textPosSize.height+48&&(o.y=n._prevPosSize.y,o.height=n._prevPosSize.height),n.pos({x:o.x,y:o.y},!1,!1).size({width:o.width,height:o.height}).render().getBBox(!0),n.dispatch.size(n,t.loc),n._prevPosSize=o}}).on("dragend",function(t){n._allowResize&&(e.event.sourceEvent.stopPropagation(),n.showContent(!0).render(),n._container.getBBox(!0),n._titleRect.getBBox(!0),n.dispatch.sizeend(n,t.loc))})}return n.prototype=Object.create(t.prototype),n.prototype.constructor=n,n.prototype._class+=" common_ResizeSurface",n.prototype.allowResize=function(e){return arguments.length?(this._allowResize=e,this):this._allowResize},n.prototype.move=function(e){var n=t.prototype.move.apply(this,arguments);return this.updateHandles(this._domNode,this._element),n},n.prototype.update=function(e,n){t.prototype.update.apply(this,arguments),this.updateHandles(e,n)},n.prototype.updateHandles=function(t,n){var r=this._parentElement.selectAll("rect").data(this.handles,function(e){return e.loc});r.enter().append("rect").attr("class",function(e){return"resize"+e.loc}).call(this.drag);var i=this._pos.x+this._container._pos.x-this._container.width()/2,s=this._pos.y+this._titleRect._pos.y-this._titleRect.height()/2,o=this._pos.x+this._container._pos.x+this._container.width()/2,u=this._pos.y+this._container._pos.y+this._container.height()/2,a=o-i,f=u-s,l=this;r.each(function(t){switch(t.loc){case"NW":t.x=i-l.handleWidth/2,t.y=s-l.handleWidth/2,t.width=l.handleWidth,t.height=l.handleWidth;break;case"N":t.x=i+l.handleWidth/2,t.y=s-l.handleWidth/2,t.width=a-l.handleWidth,t.height=l.handleWidth;break;case"NE":t.x=o-l.handleWidth/2,t.y=s-l.handleWidth/2,t.width=l.handleWidth,t.height=l.handleWidth;break;case"E":t.x=o-l.handleWidth/2,t.y=s+l.handleWidth/2,t.width=l.handleWidth,t.height=f-l.handleWidth;break;case"SE":t.x=o-l.handleWidth/2,t.y=u-l.handleWidth/2,t.width=l.handleWidth,t.height=l.handleWidth;break;case"S":t.x=i+l.handleWidth/2,t.y=u-l.handleWidth/2,t.width=a-l.handleWidth,t.height=l.handleWidth;break;case"SW":t.x=i-l.handleWidth/2,t.y=u-l.handleWidth/2,t.width=l.handleWidth,t.height=l.handleWidth;break;case"W":t.x=i-l.handleWidth/2,t.y=s+l.handleWidth/2,t.width=l.handleWidth,t.height=f-l.handleWidth}e.select(this).attr("x",t.x).attr("y",t.y).attr("width",t.width).attr("height",t.height)})},n}),function(e,t){typeof define=="function"&&define.amd?define("common/WidgetArray.js",["./Widget"],t):e.common_WidgetArray=t(e.common_Widget)}(this,function(e){function t(){e.call(this)}return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.prototype._class+=" common_WidgetArray",t.prototype.publish("content",[],"widgetArray","Widget Array"),t});
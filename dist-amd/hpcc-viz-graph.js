/*
Copyright (c) 2012-2014 Chris Pettitt

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
*/

/**
 * Copyright (c) 2014, Chris Pettitt
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice, this
 * list of conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 * this list of conditions and the following disclaimer in the documentation
 * and/or other materials provided with the distribution.
 *
 * 3. Neither the name of the copyright holder nor the names of its contributors
 * may be used to endorse or promote products derived from this software without
 * specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
 * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
 * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

/**
 * @license
 * Lo-Dash 2.4.1 (Custom Build) <http://lodash.com/>
 * Build: `lodash modern -o ./dist/lodash.js`
 * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>
 * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>
 * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 * Available under MIT license <http://lodash.com/license>
 */

define("css!src/graph/Edge",[],function(){}),function(e,t){typeof define=="function"&&define.amd?define("src/graph/Edge",["d3","../common/SVGWidget","../common/TextBox","css!./Edge"],t):e.graph_Edge=t(e.d3,e.common_SVGWidget,e.common_TextBox)}(this,function(e,t,n){function r(){t.call(this),this._points=[],this._weight=100,this._strokeDasharray=null,this._hidden=!1,this._textBox=(new n).padding(0)}return r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype._class+=" graph_Edge",r.prototype.publish("arcDepth",16,"number","Arc Depth",null,{tags:["Basic"]}),r.prototype.testData=function(){return this},r.prototype.sourceVertex=function(e){return arguments.length?(this._sourceVertex=e,this):this._sourceVertex},r.prototype.targetVertex=function(e){return arguments.length?(this._targetVertex=e,this):this._targetVertex},r.prototype.sourceMarker=function(e){return arguments.length?(this._sourceMarker=e,this):this._sourceMarker},r.prototype.targetMarker=function(e){return arguments.length?(this._targetMarker=e,this):this._targetMarker},r.prototype.weight=function(e){return arguments.length?(this._weight=e,this):this._weight},r.prototype.strokeDasharray=function(e){return arguments.length?(this._strokeDasharray=e,this):this._strokeDasharray},r.prototype.points=function(e,t,n){return arguments.length?(this._points=e,this._elementPath&&this.update(null,this._element,t,n),this):this._points},r.prototype.hidden=function(e){return arguments.length?(this._hidden=e,this):this._hidden},r.prototype.text=function(e){return arguments.length?(this._textBox.text(e),this):this._textBox.text()},r.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments),this._elementPath=n.append("path"),this._sourceMarker&&this._elementPath.attr("marker-start","url(#"+this._sourceMarker+")"),this._targetMarker&&this._elementPath.attr("marker-end","url(#"+this._targetMarker+")"),this._textBox.text()&&this._textBox.target(e).render()},r.prototype.update=function(n,r,i,s){t.prototype.update.apply(this,arguments);var o=this,u=this._elementPath;this.svgMarkerGlitch&&!s&&r.transition().duration((i?i:0)+100).each("start",function(e){o._pushMarkers(r,e)}).each("end",function(e){o._popMarkers(r,e)});var a=o._calculateEdgePoints(this._sourceVertex,this._targetVertex,this._points),f="";if(this._points.length||i||!0)f=e.svg.line().x(function(e){return e.x}).y(function(e){return e.y}).interpolate("bundle").tension(.75)(a);else{var l=a[2].x-a[0].x,c=a[2].y-a[0].y,h=Math.sqrt(l*l+c*c)*2;f="M"+a[0].x+","+a[0].y+"A"+h+","+h+" 0 0,1 "+a[2].x+","+a[2].y}i&&(u=u.transition().duration(i)),u.attr("opacity",this._hidden?0:1).attr("stroke-dasharray",this._strokeDasharray).attr("d",f),this._textBox.text()&&this._textBox.move(this._findMidPoint(a),i)},r.prototype._findMidPoint=function(e){var t=e.length/2;if(e.length%2)return e[Math.floor(t)];if(e.length){var n=e[t-1],r=e[t];return{x:(n.x+r.x)/2,y:(n.y+r.y)/2}}return{x:0,y:0}},r.prototype._calculateEdgePoints=function(e,t,n){if(!e||!t)return[[0,0],[0,0]];var r=n?n.slice():[],i=r.length===0?t.pos():r[0],s=r.length===0?e.pos():r[r.length-1];r.unshift(e.intersection(e._pos,i)),r.push(t.intersection(t._pos,s)),r[0]||(r[0]=e._pos),r[r.length-1]||(r[r.length-1]=t._pos);if(r.length===2&&r[0]&&r[1]){var o=r[0].x-r[1].x,u=r[0].y-r[1].y,a=Math.sqrt(o*o+u*u);if(a){var f=(r[0].x+r[1].x)/2-u*this.arcDepth()/100,l=(r[0].y+r[1].y)/2+o*this.arcDepth()/100;r=[{x:r[0].x,y:r[0].y},{x:f,y:l},{x:r[1].x,y:r[1].y}]}}return r},r}),define("css!src/graph/Vertex",[],function(){}),function(e,t){typeof define=="function"&&define.amd?define("src/graph/Vertex",["d3","../common/SVGWidget","../common/Icon","../common/TextBox","css!./Vertex"],t):e.graph_Vertex=t(e.d3,e.common_SVGWidget,e.common_Icon,e.common_TextBox)}(this,function(e,t,n,r){function i(){t.call(this),this._icon=new n,this._textBox=new r,this._annotationWidgets={}}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" graph_Vertex",i.prototype.publishProxy("faChar","_icon"),i.prototype.publishProxy("icon_shape_colorFill","_icon","shape_colorFill"),i.prototype.publishProxy("icon_shape_colorStroke","_icon","shape_colorStroke"),i.prototype.publishProxy("icon_image_colorFill","_icon","image_colorFill"),i.prototype.publishProxy("text","_textBox"),i.prototype.publishProxy("anchor","_textBox"),i.prototype.publishProxy("textbox_shape_colorStroke","_textBox","shape_colorStroke"),i.prototype.publishProxy("textbox_shape_colorFill","_textBox","shape_colorFill"),i.prototype.publishProxy("textbox_text_colorFill","_textBox","text_colorFill"),i.prototype.publish("annotationDiameter",14,"number","Annotation Diameter",null,{tags:["Private"]}),i.prototype.publish("annotationSpacing",3,"number","Annotation Spacing",null,{tags:["Private"]}),i.prototype.publish("annotationIcons",[],"array","Annotations",null,{tags:["Private"]}),i.prototype.testData=function(e){return this._icon.testData(),this._textBox.testData(),this.annotationIcons([{faChar:"",tooltip:"Test A",shape_colorFill:"white",image_colorFill:"red"},{faChar:"",tooltip:"Test B",shape_colorFill:"green",shape_colorStroke:"green",image_colorFill:"white"},{faChar:"",tooltip:"Test C",shape_colorFill:"navy",shape_colorStroke:"navy",image_colorFill:"white"}]),this},i.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments),this._icon.target(e).render(),this._textBox.target(e).render()},i.prototype.update=function(r,i){t.prototype.update.apply(this,arguments),this._icon.render();var s=this._icon.getBBox(!0);this._textBox.render();var o=this._textBox.getBBox(!0);this._icon.move({x:-(o.width/2)+s.width/3,y:-(o.height/2)-s.height/3});var u=this,a=i.selectAll(".annotation").data(this.annotationIcons());a.enter().append("g").attr("class","annotation").each(function(e,t){u._annotationWidgets[t]=(new n).target(this).shape("square")});var f=o.width/2,l=o.height/2;a.each(function(e,t){var n=u._annotationWidgets[t];n.diameter(u.annotationDiameter()).shape_colorFill(u.textbox_shape_colorFill()).shape_colorStroke(u.textbox_shape_colorStroke());for(var r in e)n[r]&&n[r](e[r]);n.render();var i=n.getBBox(!0);n.move({x:f-i.width/4,y:l+i.height/4}),f-=i.width+u.annotationSpacing()}),a.exit().each(function(t,n){var r=e.select(this);delete u._annotationWidgets[n],r.remove()})},i.prototype.intersection=function(e,t){var n=this._icon.intersection(e,t,this._pos);if(n)return n;var r=this._textBox.intersection(e,t,this._pos);return r?r:null},i}),!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("dagre",[],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.dagre=e()}}(function(){var e,t,n;return function r(e,t,n){function i(o,u){if(!t[o]){if(!e[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(s)return s(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=t[o]={exports:{}};e[o][0].call(l.exports,function(t){var n=e[o][1][t];return i(n?n:t)},l,l.exports,r,e,t,n)}return t[o].exports}var s=typeof require=="function"&&require;for(var o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t,n){t.exports={graphlib:e("./lib/graphlib"),layout:e("./lib/layout"),debug:e("./lib/debug"),util:{time:e("./lib/util").time,notime:e("./lib/util").notime},version:e("./lib/version")}},{"./lib/debug":6,"./lib/graphlib":7,"./lib/layout":9,"./lib/util":29,"./lib/version":30}],2:[function(e,t,n){"use strict";function s(e){function n(e){return function(t){return e.edge(t).weight}}var t=e.graph().acyclicer==="greedy"?i(e,n(e)):o(e);r.each(t,function(t){var n=e.edge(t);e.removeEdge(t),n.forwardName=t.name,n.reversed=!0,e.setEdge(t.w,t.v,n,r.uniqueId("rev"))})}function o(e){function s(o){if(r.has(i,o))return;i[o]=!0,n[o]=!0,r.each(e.outEdges(o),function(e){r.has(n,e.w)?t.push(e):s(e.w)}),delete n[o]}var t=[],n={},i={};return r.each(e.nodes(),s),t}function u(e){r.each(e.edges(),function(t){var n=e.edge(t);if(n.reversed){e.removeEdge(t);var r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}})}var r=e("./lodash"),i=e("./greedy-fas");t.exports={run:s,undo:u}},{"./greedy-fas":8,"./lodash":10}],3:[function(e,t,n){function s(e){function t(n){var i=e.children(n),s=e.node(n);i.length&&r.each(i,t);if(r.has(s,"minRank")){s.borderLeft=[],s.borderRight=[];for(var u=s.minRank,a=s.maxRank+1;u<a;++u)o(e,"borderLeft","_bl",n,s,u),o(e,"borderRight","_br",n,s,u)}}r.each(e.children(),t)}function o(e,t,n,r,s,o){var u={width:0,height:0,rank:o},a=s[t][o-1],f=i.addDummyNode(e,"border",u,n);s[t][o]=f,e.setParent(f,r),a&&e.setEdge(a,f,{weight:1})}var r=e("./lodash"),i=e("./util");t.exports=s},{"./lodash":10,"./util":29}],4:[function(e,t,n){"use strict";function i(e){var t=e.graph().rankdir.toLowerCase();(t==="lr"||t==="rl")&&o(e)}function s(e){var t=e.graph().rankdir.toLowerCase();(t==="bt"||t==="rl")&&a(e);if(t==="lr"||t==="rl")l(e),o(e)}function o(e){r.each(e.nodes(),function(t){u(e.node(t))}),r.each(e.edges(),function(t){u(e.edge(t))})}function u(e){var t=e.width;e.width=e.height,e.height=t}function a(e){r.each(e.nodes(),function(t){f(e.node(t))}),r.each(e.edges(),function(t){var n=e.edge(t);r.each(n.points,f),r.has(n,"y")&&f(n)})}function f(e){e.y=-e.y}function l(e){r.each(e.nodes(),function(t){c(e.node(t))}),r.each(e.edges(),function(t){var n=e.edge(t);r.each(n.points,c),r.has(n,"x")&&c(n)})}function c(e){var t=e.x;e.x=e.y,e.y=t}var r=e("./lodash");t.exports={adjust:i,undo:s}},{"./lodash":10}],5:[function(e,t,n){function r(){var e={};e._next=e._prev=e,this._sentinel=e}function i(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function s(e,t){if(e!=="_next"&&e!=="_prev")return t}t.exports=r,r.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return i(t),t},r.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&i(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t},r.prototype.toString=function(){var e=[],t=this._sentinel,n=t._prev;while(n!==t)e.push(JSON.stringify(n,s)),n=n._prev;return"["+e.join(", ")+"]"}},{}],6:[function(e,t,n){function o(e){var t=i.buildLayerMatrix(e),n=(new s({compound:!0,multigraph:!0})).setGraph({});return r.each(e.nodes(),function(t){n.setNode(t,{label:t}),n.setParent(t,"layer"+e.node(t).rank)}),r.each(e.edges(),function(e){n.setEdge(e.v,e.w,{},e.name)}),r.each(t,function(e,t){var i="layer"+t;n.setNode(i,{rank:"same"}),r.reduce(e,function(e,t){return n.setEdge(e,t,{style:"invis"}),t})}),n}var r=e("./lodash"),i=e("./util"),s=e("./graphlib").Graph;t.exports={debugOrdering:o}},{"./graphlib":7,"./lodash":10,"./util":29}],7:[function(e,t,n){var r;if(e)try{r=e("graphlib")}catch(i){}r||(r=window.graphlib),t.exports=r},{graphlib:31}],8:[function(e,t,n){function u(e,t){if(e.nodeCount()<=1)return[];var n=l(e,t||o),i=a(n.graph,n.buckets,n.zeroIdx);return r.flatten(r.map(i,function(t){return e.outEdges(t.v,t.w)}),!0)}function a(e,t,n){var r=[],i=t[t.length-1],s=t[0],o;while(e.nodeCount()){while(o=s.dequeue())f(e,t,n,o);while(o=i.dequeue())f(e,t,n,o);if(e.nodeCount())for(var u=t.length-2;u>0;--u){o=t[u].dequeue();if(o){r=r.concat(f(e,t,n,o,!0));break}}}return r}function f(e,t,n,i,s){var o=s?[]:undefined;return r.each(e.inEdges(i.v),function(r){var i=e.edge(r),u=e.node(r.v);s&&o.push({v:r.v,w:r.w}),u.out-=i,c(t,n,u)}),r.each(e.outEdges(i.v),function(r){var i=e.edge(r),s=r.w,o=e.node(s);o["in"]-=i,c(t,n,o)}),e.removeNode(i.v),o}function l(e,t){var n=new i,o=0,u=0;r.each(e.nodes(),function(e){n.setNode(e,{v:e,"in":0,out:0})}),r.each(e.edges(),function(e){var r=n.edge(e.v,e.w)||0,i=t(e),s=r+i;n.setEdge(e.v,e.w,s),u=Math.max(u,n.node(e.v).out+=i),o=Math.max(o,n.node(e.w)["in"]+=i)});var a=r.range(u+o+3).map(function(){return new s}),f=o+1;return r.each(n.nodes(),function(e){c(a,f,n.node(e))}),{graph:n,buckets:a,zeroIdx:f}}function c(e,t,n){n.out?n["in"]?e[n.out-n["in"]+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}var r=e("./lodash"),i=e("./graphlib").Graph,s=e("./data/list");t.exports=u;var o=r.constant(1)},{"./data/list":5,"./graphlib":7,"./lodash":10}],9:[function(e,t,n){"use strict";function g(e,t){var n=t&&t.debugTiming?v.time:v.notime;n("layout",function(){var t=n("  buildLayoutGraph",function(){return L(e)});n("  runLayout",function(){y(t,n)}),n("  updateInputGraph",function(){b(e,t)})})}function y(e,t){t("    makeSpaceForEdgeLabels",function(){A(e)}),t("    removeSelfEdges",function(){F(e)}),t("    acyclic",function(){i.run(e)}),t("    nestingGraph.run",function(){l.run(e)}),t("    rank",function(){o(v.asNonCompoundGraph(e))}),t("    injectEdgeLabelProxies",function(){O(e)}),t("    removeEmptyRanks",function(){f(e)}),t("    nestingGraph.cleanup",function(){l.cleanup(e)}),t("    normalizeRanks",function(){u(e)}),t("    assignRankMinMax",function(){M(e)}),t("    removeEdgeLabelProxies",function(){_(e)}),t("    normalize.run",function(){s.run(e)}),t("    parentDummyChains",function(){a(e)}),t("    addBorderSegments",function(){c(e)}),t("    order",function(){p(e)}),t("    insertSelfEdges",function(){I(e)}),t("    adjustCoordinateSystem",function(){h.adjust(e)}),t("    position",function(){d(e)}),t("    positionSelfEdges",function(){q(e)}),t("    removeBorderNodes",function(){j(e)}),t("    normalize.undo",function(){s.undo(e)}),t("    fixupEdgeLabelCoords",function(){H(e)}),t("    undoCoordinateSystem",function(){h.undo(e)}),t("    translateGraph",function(){D(e)}),t("    assignNodeIntersects",function(){P(e)}),t("    reversePoints",function(){B(e)}),t("    acyclic.undo",function(){i.undo(e)})}function b(e,t){r.each(e.nodes(),function(n){var r=e.node(n),i=t.node(n);r&&(r.x=i.x,r.y=i.y,t.children(n).length&&(r.width=i.width,r.height=i.height))}),r.each(e.edges(),function(n){var i=e.edge(n),s=t.edge(n);i.points=s.points,r.has(s,"x")&&(i.x=s.x,i.y=s.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}function L(e){var t=new m({multigraph:!0,compound:!0}),n=U(e.graph());return t.setGraph(r.merge({},E,R(n,w),r.pick(n,S))),r.each(e.nodes(),function(n){var i=U(e.node(n));t.setNode(n,r.defaults(R(i,x),T)),t.setParent(n,e.parent(n))}),r.each(e.edges(),function(n){var i=U(e.edge(n));t.setEdge(n,r.merge({},C,R(i,N),r.pick(i,k)))}),t}function A(e){var t=e.graph();t.ranksep/=2,r.each(e.edges(),function(n){var r=e.edge(n);r.minlen*=2,r.labelpos.toLowerCase()!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?r.width+=r.labeloffset:r.height+=r.labeloffset)})}function O(e){r.each(e.edges(),function(t){var n=e.edge(t);if(n.width&&n.height){var r=e.node(t.v),i=e.node(t.w),s={rank:(i.rank-r.rank)/2+r.rank,e:t};v.addDummyNode(e,"edge-proxy",s,"_ep")}})}function M(e){var t=0;r.each(e.nodes(),function(n){var i=e.node(n);i.borderTop&&(i.minRank=e.node(i.borderTop).rank,i.maxRank=e.node(i.borderBottom).rank,t=r.max(t,i.maxRank))}),e.graph().maxRank=t}function _(e){r.each(e.nodes(),function(t){var n=e.node(t);n.dummy==="edge-proxy"&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))})}function D(e){function f(e){var r=e.x,o=e.y,u=e.width,a=e.height;t=Math.min(t,r-u/2),n=Math.max(n,r+u/2),i=Math.min(i,o-a/2),s=Math.max(s,o+a/2)}var t=Number.POSITIVE_INFINITY,n=0,i=Number.POSITIVE_INFINITY,s=0,o=e.graph(),u=o.marginx||0,a=o.marginy||0;r.each(e.nodes(),function(t){f(e.node(t))}),r.each(e.edges(),function(t){var n=e.edge(t);r.has(n,"x")&&f(n)}),t-=u,i-=a,r.each(e.nodes(),function(n){var r=e.node(n);r.x-=t,r.y-=i}),r.each(e.edges(),function(n){var s=e.edge(n);r.each(s.points,function(e){e.x-=t,e.y-=i}),r.has(s,"x")&&(s.x-=t),r.has(s,"y")&&(s.y-=i)}),o.width=n-t+u,o.height=s-i+a}function P(e){r.each(e.edges(),function(t){var n=e.edge(t),r=e.node(t.v),i=e.node(t.w),s,o;n.points?(s=n.points[0],o=n.points[n.points.length-1]):(n.points=[],s=i,o=r),n.points.unshift(v.intersectRect(r,s)),n.points.push(v.intersectRect(i,o))})}function H(e){r.each(e.edges(),function(t){var n=e.edge(t);if(r.has(n,"x")){if(n.labelpos==="l"||n.labelpos==="r")n.width-=n.labeloffset;switch(n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset}}})}function B(e){r.each(e.edges(),function(t){var n=e.edge(t);n.reversed&&n.points.reverse()})}function j(e){r.each(e.nodes(),function(t){if(e.children(t).length){var n=e.node(t),i=e.node(n.borderTop),s=e.node(n.borderBottom),o=e.node(r.last(n.borderLeft)),u=e.node(r.last(n.borderRight));n.width=Math.abs(u.x-o.x),n.height=Math.abs(s.y-i.y),n.x=o.x+n.width/2,n.y=i.y+n.height/2}}),r.each(e.nodes(),function(t){e.node(t).dummy==="border"&&e.removeNode(t)})}function F(e){r.each(e.edges(),function(t){if(t.v===t.w){var n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function I(e){var t=v.buildLayerMatrix(e);r.each(t,function(t){var n=0;r.each(t,function(t,i){var s=e.node(t);s.order=i+n,r.each(s.selfEdges,function(t){v.addDummyNode(e,"selfedge",{width:t.label.width,height:t.label.height,rank:s.rank,order:i+ ++n,e:t.e,label:t.label},"_se")}),delete s.selfEdges})})}function q(e){r.each(e.nodes(),function(t){var n=e.node(t);if(n.dummy==="selfedge"){var r=e.node(n.e.v),i=r.x+r.width/2,s=r.y,o=n.x-i,u=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:i+2*o/3,y:s-u},{x:i+5*o/6,y:s-u},{x:i+o,y:s},{x:i+5*o/6,y:s+u},{x:i+2*o/3,y:s+u}],n.label.x=n.x,n.label.y=n.y}})}function R(e,t){return r.mapValues(r.pick(e,t),Number)}function U(e){var t={};return r.each(e,function(e,n){t[n.toLowerCase()]=e}),t}var r=e("./lodash"),i=e("./acyclic"),s=e("./normalize"),o=e("./rank"),u=e("./util").normalizeRanks,a=e("./parent-dummy-chains"),f=e("./util").removeEmptyRanks,l=e("./nesting-graph"),c=e("./add-border-segments"),h=e("./coordinate-system"),p=e("./order"),d=e("./position"),v=e("./util"),m=e("./graphlib").Graph;t.exports=g;var w=["nodesep","edgesep","ranksep","marginx","marginy"],E={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},S=["acyclicer","ranker","rankdir","align"],x=["width","height"],T={width:0,height:0},N=["minlen","weight","width","height","labeloffset"],C={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},k=["labelpos"]},{"./acyclic":2,"./add-border-segments":3,"./coordinate-system":4,"./graphlib":7,"./lodash":10,"./nesting-graph":11,"./normalize":12,"./order":17,"./parent-dummy-chains":22,"./position":24,"./rank":26,"./util":29}],10:[function(e,t,n){var r;if(e)try{r=e("lodash")}catch(i){}r||(r=window._),t.exports=r},{lodash:51}],11:[function(e,t,n){function s(e){var t=i.addDummyNode(e,"root",{},"_root"),n=u(e),s=r.max(n)-1,f=2*s+1;e.graph().nestingRoot=t,r.each(e.edges(),function(t){e.edge(t).minlen*=f});var l=a(e)+1;r.each(e.children(),function(r){o(e,t,f,l,s,n,r)}),e.graph().nodeRankFactor=f}function o(e,t,n,s,u,a,f){var l=e.children(f);if(!l.length){f!==t&&e.setEdge(t,f,{weight:0,minlen:n});return}var c=i.addBorderNode(e,"_bt"),h=i.addBorderNode(e,"_bb"),p=e.node(f);e.setParent(c,f),p.borderTop=c,e.setParent(h,f),p.borderBottom=h,r.each(l,function(r){o(e,t,n,s,u,a,r);var i=e.node(r),l=i.borderTop?i.borderTop:r,p=i.borderBottom?i.borderBottom:r,d=i.borderTop?s:2*s,m=l!==p?1:u-a[f]+1;e.setEdge(c,l,{weight:d,minlen:m,nestingEdge:!0}),e.setEdge(p,h,{weight:d,minlen:m,nestingEdge:!0})}),e.parent(f)||e.setEdge(t,c,{weight:0,minlen:u+a[f]})}function u(e){function n(i,s){var o=e.children(i);o&&o.length&&r.each(o,function(e){n(e,s+1)}),t[i]=s}var t={};return r.each(e.children(),function(e){n(e,1)}),t}function a(e){return r.reduce(e.edges(),function(t,n){return t+e.edge(n).weight},0)}function f(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,r.each(e.edges(),function(t){var n=e.edge(t);n.nestingEdge&&e.removeEdge(t)})}var r=e("./lodash"),i=e("./util");t.exports={run:s,cleanup:f}},{"./lodash":10,"./util":29}],12:[function(e,t,n){"use strict";function s(e){e.graph().dummyChains=[],r.each(e.edges(),function(t){o(e,t)})}function o(e,t){var n=t.v,r=e.node(n).rank,s=t.w,o=e.node(s).rank,u=t.name,a=e.edge(t),f=a.labelRank;if(o===r+1)return;e.removeEdge(t);var l,c,h;for(h=0,++r;r<o;++h,++r)a.points=[],c={width:0,height:0,edgeLabel:a,edgeObj:t,rank:r},l=i.addDummyNode(e,"edge",c,"_d"),r===f&&(c.width=a.width,c.height=a.height,c.dummy="edge-label",c.labelpos=a.labelpos),e.setEdge(n,l,{weight:a.weight},u),h===0&&e.graph().dummyChains.push(l),n=l;e.setEdge(n,s,{weight:a.weight},u)}function u(e){r.each(e.graph().dummyChains,function(t){var n=e.node(t),r=n.edgeLabel,i;e.setEdge(n.edgeObj,r);while(n.dummy)i=e.successors(t)[0],e.removeNode(t),r.points.push({x:n.x,y:n.y}),n.dummy==="edge-label"&&(r.x=n.x,r.y=n.y,r.width=n.width,r.height=n.height),t=i,n=e.node(t)})}var r=e("./lodash"),i=e("./util");t.exports={run:s,undo:u}},{"./lodash":10,"./util":29}],13:[function(e,t,n){function i(e,t,n){var i={},s;r.each(n,function(n){var r=e.parent(n),o,u;while(r){o=e.parent(r),o?(u=i[o],i[o]=r):(u=s,s=r);if(u&&u!==r){t.setEdge(u,r);return}r=o}})}var r=e("../lodash");t.exports=i},{"../lodash":10}],14:[function(e,t,n){function i(e,t){return r.map(t,function(t){var n=e.inEdges(t);if(!n.length)return{v:t};var i=r.reduce(n,function(t,n){var r=e.edge(n),i=e.node(n.v);return{sum:t.sum+r.weight*i.order,weight:t.weight+r.weight}},{sum:0,weight:0});return{v:t,barycenter:i.sum/i.weight,weight:i.weight}})}var r=e("../lodash");t.exports=i},{"../lodash":10}],15:[function(e,t,n){function s(e,t,n){var s=o(e),u=(new i({compound:!0})).setGraph({root:s}).setDefaultNodeLabel(function(t){return e.node(t)});return r.each(e.nodes(),function(i){var o=e.node(i),a=e.parent(i);if(o.rank===t||o.minRank<=t&&t<=o.maxRank)u.setNode(i),u.setParent(i,a||s),r.each(e[n](i),function(t){var n=t.v===i?t.w:t.v,s=u.edge(n,i),o=r.isUndefined(s)?0:s.weight;u.setEdge(n,i,{weight:e.edge(t).weight+o})}),r.has(o,"minRank")&&u.setNode(i,{borderLeft:o.borderLeft[t],borderRight:o.borderRight[t]})}),u}function o(e){var t;while(e.hasNode(t=r.uniqueId("_root")));return t}var r=e("../lodash"),i=e("../graphlib").Graph;t.exports=s},{"../graphlib":7,"../lodash":10}],16:[function(e,t,n){"use strict";function i(e,t){var n=0;for(var r=1;r<t.length;++r)n+=s(e,t[r-1],t[r]);return n}function s(e,t,n){var i=r.zipObject(n,r.map(n,function(e,t){return t})),s=r.flatten(r.map(t,function(t){return r.chain(e.outEdges(t)).map(function(t){return{pos:i[t.w],weight:e.edge(t).weight}}).sortBy("pos").value()}),!0),o=1;while(o<n.length)o<<=1;var u=2*o-1;o-=1;var a=r.map(new Array(u),function(){return 0}),f=0;return r.each(s.forEach(function(e){var t=e.pos+o;a[t]+=e.weight;var n=0;while(t>0)t%2&&(n+=a[t+1]),t=t-1>>1,a[t]+=e.weight;f+=e.weight*n})),f}var r=e("../lodash");t.exports=i},{"../lodash":10}],17:[function(e,t,n){"use strict";function c(e){var t=l.maxRank(e),n=h(e,r.range(1,t+1),"inEdges"),o=h(e,r.range(t-1,-1,-1),"outEdges"),u=i(e);d(e,u);var a=Number.POSITIVE_INFINITY,f;for(var c=0,v=0;v<4;++c,++v){p(c%2?n:o,c%4>=2),u=l.buildLayerMatrix(e);var m=s(e,u);m<a&&(v=0,f=r.cloneDeep(u),a=m)}d(e,f)}function h(e,t,n){return r.map(t,function(t){return u(e,t,n)})}function p(e,t){var n=new f;r.each(e,function(e){var i=e.graph().root,s=o(e,i,n,t);r.each(s.vs,function(t,n){e.node(t).order=n}),a(e,n,s.vs)})}function d(e,t){r.each(t,function(t){r.each(t,function(t,n){e.node(t).order=n})})}var r=e("../lodash"),i=e("./init-order"),s=e("./cross-count"),o=e("./sort-subgraph"),u=e("./build-layer-graph"),a=e("./add-subgraph-constraints"),f=e("../graphlib").Graph,l=e("../util");t.exports=c},{"../graphlib":7,"../lodash":10,"../util":29,"./add-subgraph-constraints":13,"./build-layer-graph":15,"./cross-count":16,"./init-order":18,"./sort-subgraph":20}],18:[function(e,t,n){"use strict";function i(e){function o(n){if(r.has(t,n))return;t[n]=!0;var i=e.node(n);s[i.rank].push(n),r.each(e.successors(n),o)}var t={},n=r.filter(e.nodes(),function(t){return!e.children(t).length}),i=r.max(r.map(n,function(t){return e.node(t).rank})),s=r.map(r.range(i+1),function(){return[]}),u=r.sortBy(n,function(t){return e.node(t).rank});return r.each(u,o),s}var r=e("../lodash");t.exports=i},{"../lodash":10}],19:[function(e,t,n){"use strict";function i(e,t){var n={};r.each(e,function(e,t){var i=n[e.v]={indegree:0,"in":[],out:[],vs:[e.v],i:t};r.isUndefined(e.barycenter)||(i.barycenter=e.barycenter,i.weight=e.weight)}),r.each(t.edges(),function(e){var t=n[e.v],i=n[e.w];!r.isUndefined(t)&&!r.isUndefined(i)&&(i.indegree++,t.out.push(n[e.w]))});var i=r.filter(n,function(e){return!e.indegree});return s(i)}function s(e){function n(e){return function(t){if(t.merged)return;(r.isUndefined(t.barycenter)||r.isUndefined(e.barycenter)||t.barycenter>=e.barycenter)&&o(e,t)}}function i(t){return function(n){n["in"].push(t),--n.indegree===0&&e.push(n)}}var t=[];while(e.length){var s=e.pop();t.push(s),r.each(s["in"].reverse(),n(s)),r.each(s.out,i(s))}return r.chain(t).filter(function(e){return!e.merged}).map(function(e){return r.pick(e,["vs","i","barycenter","weight"])}).value()}function o(e,t){var n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight),t.weight&&(n+=t.barycenter*t.weight,r+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0}var r=e("../lodash");t.exports=i},{"../lodash":10}],20:[function(e,t,n){function u(e,t,n,l){var c=e.children(t),h=e.node(t),p=h?h.borderLeft:undefined,d=h?h.borderRight:undefined,v={};p&&(c=r.filter(c,function(e){return e!==p&&e!==d}));var m=i(e,c);r.each(m,function(t){if(e.children(t.v).length){var i=u(e,t.v,n,l);v[t.v]=i,r.has(i,"barycenter")&&f(t,i)}});var g=s(m,n);a(g,v);var y=o(g,l);if(p){y.vs=r.flatten([p,y.vs,d],!0);if(e.predecessors(p).length){var b=e.node(e.predecessors(p)[0]),w=e.node(e.predecessors(d)[0]);r.has(y,"barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+b.order+w.order)/(y.weight+2),y.weight+=2}}return y}function a(e,t){r.each(e,function(e){e.vs=r.flatten(e.vs.map(function(e){return t[e]?t[e].vs:e}),!0)})}function f(e,t){r.isUndefined(e.barycenter)?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}var r=e("../lodash"),i=e("./barycenter"),s=e("./resolve-conflicts"),o=e("./sort");t.exports=u},{"../lodash":10,"./barycenter":14,"./resolve-conflicts":19,"./sort":21}],21:[function(e,t,n){function s(e,t){var n=i.partition(e,function(e){return r.has(e,"barycenter")}),s=n.lhs,a=r.sortBy(n.rhs,function(e){return-e.i}),f=[],l=0,c=0,h=0;s.sort(u(!!t)),h=o(f,a,h),r.each(s,function(e){h+=e.vs.length,f.push(e.vs),l+=e.barycenter*e.weight,c+=e.weight,h=o(f,a,h)});var p={vs:r.flatten(f,!0)};return c&&(p.barycenter=l/c,p.weight=c),p}function o(e,t,n){var i;while(t.length&&(i=r.last(t)).i<=n)t.pop(),e.push(i.vs),n++;return n}function u(e){return function(t,n){return t.barycenter<n.barycenter?-1:t.barycenter>n.barycenter?1:e?n.i-t.i:t.i-n.i}}var r=e("../lodash"),i=e("../util");t.exports=s},{"../lodash":10,"../util":29}],22:[function(e,t,n){function i(e){var t=o(e);r.each(e.graph().dummyChains,function(n){var r=e.node(n),i=r.edgeObj,o=s(e,t,i.v,i.w),u=o.path,a=o.lca,f=0,l=u[f],c=!0;while(n!==i.w){r=e.node(n);if(c){while((l=u[f])!==a&&e.node(l).maxRank<r.rank)f++;l===a&&(c=!1)}if(!c){while(f<u.length-1&&e.node(l=u[f+1]).minRank<=r.rank)f++;l=u[f]}e.setParent(n,l),n=e.successors(n)[0]}})}function s(e,t,n,r){var i=[],s=[],o=Math.min(t[n].low,t[r].low),u=Math.max(t[n].lim,t[r].lim),a,f;a=n;do a=e.parent(a),i.push(a);while(a&&(t[a].low>o||u>t[a].lim));f=a,a=r;while((a=e.parent(a))!==f)s.push(a);return{path:i.concat(s.reverse()),lca:f}}function o(e){function i(s){var o=n;r.each(e.children(s),i),t[s]={low:o,lim:n++}}var t={},n=0;return r.each(e.children(),i),t}var r=e("./lodash");t.exports=i},{"./lodash":10}],23:[function(e,t,n){"use strict";function o(e,t){function i(t,i){var s=0,o=0,u=t.length,l=r.last(i);return r.each(i,function(t,c){var h=a(e,t),p=h?e.node(h).order:u;if(h||t===l)r.each(i.slice(o,c+1),function(t){r.each(e.predecessors(t),function(r){var i=e.node(r),o=i.order;(o<s||p<o)&&(!i.dummy||!e.node(t).dummy)&&f(n,r,t)})}),o=c+1,s=p}),i}var n={};return r.reduce(t,i),n}function u(e,t){function i(t,i,s,o,u){var a;r.each(r.range(i,s),function(i){a=t[i],e.node(a).dummy&&r.each(e.predecessors(a),function(t){var r=e.node(t);r.dummy&&(r.order<o||r.order>u)&&f(n,t,a)})})}function s(t,n){var s=-1,o,u=0;return r.each(n,function(r,a){if(e.node(r).dummy==="border"){var f=e.predecessors(r);f.length&&(o=e.node(f[0]).order,i(n,u,a,s,o),u=a,s=o)}i(n,u,n.length,o,t.length)}),n}var n={};return r.reduce(t,s),n}function a(e,t){if(e.node(t).dummy)return r.find(e.predecessors(t),function(t){return e.node(t).dummy})}function f(e,t,n){if(t>n){var r=t;t=n,n=r}var i=e[t];i||(e[t]=i={}),i[n]=!0}function l(e,t,n){if(t>n){var i=t;t=n,n=i}return r.has(e[t],n)}function c(e,t,n,i){var s={},o={},u={};return r.each(t,function(e){r.each(e,function(e,t){s[e]=e,o[e]=e,u[e]=t})}),r.each(t,function(e){var t=-1;r.each(e,function(e){var a=i(e);if(a.length){a=r.sortBy(a,function(e){return u[e]});var f=(a.length-1)/2;for(var c=Math.floor(f),h=Math.ceil(f);c<=h;++c){var p=a[c];o[e]===e&&t<u[p]&&!l(n,e,p)&&(o[p]=e,o[e]=s[e]=s[p],t=u[p])}}})}),{root:s,align:o}}function h(e,t,n,i,s){function f(e){r.has(a,e)||(a[e]=!0,o[e]=r.reduce(u.inEdges(e),function(e,t){return f(t.v),Math.max(e,o[t.v]+u.edge(t))},0))}function l(e){if(a[e]!==2){a[e]++;var t=r.reduce(u.outEdges(e),function(e,t){return l(t.w),Math.min(e,o[t.w]-u.edge(t))},Number.POSITIVE_INFINITY);t!==Number.POSITIVE_INFINITY&&(o[e]=Math.max(o[e],t))}}var o={},u=p(e,t,n,s),a={};return r.each(u.nodes(),f),r.each(u.nodes(),l),r.each(i,function(e){o[e]=o[n[e]]}),o}function p(e,t,n,s){var o=new i,u=e.graph(),a=y(u.nodesep,u.edgesep,s);return r.each(t,function(t){var i;r.each(t,function(t){var r=n[t];o.setNode(r);if(i){var s=n[i],u=o.edge(s,r);o.setEdge(s,r,Math.max(a(e,t,i),u||0))}i=t})}),o}function d(e,t){return r.min(t,function(t){var n=r.min(t,function(t,n){return t-b(e,n)/2}),i=r.max(t,function(t,n){return t+b(e,n)/2});return i-n})}function v(e,t){var n=r.min(t),i=r.max(t);r.each(["u","d"],function(s){r.each(["l","r"],function(o){var u=s+o,a=e[u],f;if(a===t)return;f=o==="l"?n-r.min(a):i-r.max(a),f&&(e[u]=r.mapValues(a,function(e){return e+f}))})})}function m(e,t){return r.mapValues(e.ul,function(n,i){if(t)return e[t.toLowerCase()][i];var s=r.sortBy(r.pluck(e,i));return(s[1]+s[2])/2})}function g(e){var t=s.buildLayerMatrix(e),n=r.merge(o(e,t),u(e,t)),i={},a;r.each(["u","d"],function(s){a=s==="u"?t:r.values(t).reverse(),r.each(["l","r"],function(t){t==="r"&&(a=r.map(a,function(e){return r.values(e).reverse()}));var o=r.bind(s==="u"?e.predecessors:e.successors,e),u=c(e,a,n,o),f=h(e,a,u.root,u.align,t==="r");t==="r"&&(f=r.mapValues(f,function(e){return-e})),i[s+t]=f})});var f=d(e,i);return v(i,f),m(i,e.graph().align)}function y(e,t,n){return function(i,s,o){var u=i.node(s),a=i.node(o),f=0,l;f+=u.width/2;if(r.has(u,"labelpos"))switch(u.labelpos.toLowerCase()){case"l":l=-u.width/2;break;case"r":l=u.width/2}l&&(f+=n?l:-l),l=0,f+=(u.dummy?t:e)/2,f+=(a.dummy?t:e)/2,f+=a.width/2;if(r.has(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":l=a.width/2;break;case"r":l=-a.width/2}return l&&(f+=n?l:-l),l=0,f}}function b(e,t){return e.node(t).width}var r=e("../lodash"),i=e("../graphlib").Graph,s=e("../util");t.exports={positionX:g,findType1Conflicts:o,findType2Conflicts:u,addConflict:f,hasConflict:l,verticalAlignment:c,horizontalCompaction:h,alignCoordinates:v,findSmallestWidthAlignment:d,balance:m}},{"../graphlib":7,"../lodash":10,"../util":29}],24:[function(e,t,n){"use strict";function o(e){e=i.asNonCompoundGraph(e),u(e),r.each(s(e),function(t,n){e.node(n).x=t})}function u(e){var t=i.buildLayerMatrix(e),n=e.graph().ranksep,s=0;r.each(t,function(t){var i=r.max(r.map(t,function(t){return e.node(t).height}));r.each(t,function(t){e.node(t).y=s+i/2}),s+=i+n})}var r=e("../lodash"),i=e("../util"),s=e("./bk").positionX;t.exports=o},{"../lodash":10,"../util":29,"./bk":23}],25:[function(e,t,n){"use strict";function o(e){var t=new i({directed:!1}),n=e.nodes()[0],r=e.nodeCount();t.setNode(n,{});var o,l;while(u(t,e)<r)o=a(t,e),l=t.hasNode(o.v)?s(e,o):-s(e,o),f(t,e,l);return t}function u(e,t){function n(i){r.each(t.nodeEdges(i),function(r){var o=r.v,u=i===o?r.w:o;!e.hasNode(u)&&!s(t,r)&&(e.setNode(u,{}),e.setEdge(i,u,{}),n(u))})}return r.each(e.nodes(),n),e.nodeCount()}function a(e,t){return r.min(t.edges(),function(n){if(e.hasNode(n.v)!==e.hasNode(n.w))return s(t,n)})}function f(e,t,n){r.each(e.nodes(),function(e){t.node(e).rank+=n})}var r=e("../lodash"),i=e("../graphlib").Graph,s=e("./util").slack;t.exports=o},{"../graphlib":7,"../lodash":10,"./util":28}],26:[function(e,t,n){"use strict";function u(e){switch(e.graph().ranker){case"network-simplex":l(e);break;case"tight-tree":f(e);break;case"longest-path":a(e);break;default:l(e)}}function f(e){i(e),s(e)}function l(e){o(e)}var r=e("./util"),i=r.longestPath,s=e("./feasible-tree"),o=e("./network-simplex");t.exports=u;var a=i},{"./feasible-tree":25,"./network-simplex":27,"./util":28}],27:[function(e,t,n){"use strict";function l(e){e=f(e),o(e);var t=i(e);d(t),c(t,e);var n,r;while(n=m(t))r=g(t,e,n),y(t,e,n,r)}function c(e,t){var n=a(e,e.nodes());n=n.slice(0,n.length-1),r.each(n,function(n){h(e,t,n)})}function h(e,t,n){var r=e.node(n),i=r.parent;e.edge(n,i).cutvalue=p(e,t,n)}function p(e,t,n){var i=e.node(n),s=i.parent,o=!0,u=t.edge(n,s),a=0;return u||(o=!1,u=t.edge(s,n)),a=u.weight,r.each(t.nodeEdges(n),function(r){var i=r.v===n,u=i?r.w:r.v;if(u!==s){var f=i===o,l=t.edge(r).weight;a+=f?l:-l;if(w(e,n,u)){var c=e.edge(n,u).cutvalue;a+=f?-c:c}}}),a}function d(e,t){arguments.length<2&&(t=e.nodes()[0]),v(e,{},1,t)}function v(e,t,n,i,s){var o=n,u=e.node(i);return t[i]=!0,r.each(e.neighbors(i),function(s){r.has(t,s)||(n=v(e,t,n,s,i))}),u.low=o,u.lim=n++,s?u.parent=s:delete u.parent,n}function m(e){return r.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function g(e,t,n){var i=n.v,o=n.w;t.hasEdge(i,o)||(i=n.w,o=n.v);var u=e.node(i),a=e.node(o),f=u,l=!1;u.lim>a.lim&&(f=a,l=!0);var c=r.filter(t.edges(),function(t){return l===E(e,e.node(t.v),f)&&l!==E(e,e.node(t.w),f)});return r.min(c,function(e){return s(t,e)})}function y(e,t,n,r){var i=n.v,s=n.w;e.removeEdge(i,s),e.setEdge(r.v,r.w,{}),d(e),c(e,t),b(e,t)}function b(e,t){var n=r.find(e.nodes(),function(e){return!t.node(e).parent}),i=u(e,n);i=i.slice(1),r.each(i,function(n){var r=e.node(n).parent,i=t.edge(n,r),s=!1;i||(i=t.edge(r,n),s=!0),t.node(n).rank=t.node(r).rank+(s?i.minlen:-i.minlen)})}function w(e,t,n){return e.hasEdge(t,n)}function E(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}var r=e("../lodash"),i=e("./feasible-tree"),s=e("./util").slack,o=e("./util").longestPath,u=e("../graphlib").alg.preorder,a=e("../graphlib").alg.postorder,f=e("../util").simplify;t.exports=l,l.initLowLimValues=d,l.initCutValues=c,l.calcCutValue=p,l.leaveEdge=m,l.enterEdge=g,l.exchangeEdges=y},{"../graphlib":7,"../lodash":10,"../util":29,"./feasible-tree":25,"./util":28}],28:[function(e,t,n){"use strict";function i(e){function n(i){var s=e.node(i);if(r.has(t,i))return s.rank;t[i]=!0;var o=r.min(r.map(e.outEdges(i),function(t){return n(t.w)-e.edge(t).minlen}));return o===Number.POSITIVE_INFINITY&&(o=0),s.rank=o}var t={};r.each(e.sources(),n)}function s(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}var r=e("../lodash");t.exports={longestPath:i,slack:s}},{"../lodash":10}],29:[function(e,t,n){"use strict";function s(e,t,n,i){var s;do s=r.uniqueId(i);while(e.hasNode(s));return n.dummy=t,e.setNode(s,n),s}function o(e){var t=(new i).setGraph(e.graph());return r.each(e.nodes(),function(n){t.setNode(n,e.node(n))}),r.each(e.edges(),function(n){var r=t.edge(n.v,n.w)||{weight:0,minlen:1},i=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)})}),t}function u(e){var t=(new i({multigraph:e.isMultigraph()})).setGraph(e.graph());return r.each(e.nodes(),function(n){e.children(n).length||t.setNode(n,e.node(n))}),r.each(e.edges(),function(n){t.setEdge(n,e.edge(n))}),t}function a(e){var t=r.map(e.nodes(),function(t){var n={};return r.each(e.outEdges(t),function(t){n[t.w]=(n[t.w]||0)+e.edge(t).weight}),n});return r.zipObject(e.nodes(),t)}function f(e){var t=r.map(e.nodes(),function(t){var n={};return r.each(e.inEdges(t),function(t){n[t.v]=(n[t.v]||0)+e.edge(t).weight}),n});return r.zipObject(e.nodes(),t)}function l(e,t){var n=e.x,r=e.y,i=t.x-n,s=t.y-r,o=e.width/2,u=e.height/2;if(!i&&!s)throw new Error("Not possible to find intersection inside of the rectangle");var a,f;return Math.abs(s)*o>Math.abs(i)*u?(s<0&&(u=-u),a=u*i/s,f=u):(i<0&&(o=-o),a=o,f=o*s/i),{x:n+a,y:r+f}}function c(e){var t=r.map(r.range(v(e)+1),function(){return[]});return r.each(e.nodes(),function(n){var i=e.node(n),s=i.rank;r.isUndefined(s)||(t[s][i.order]=n)}),t}function h(e){var t=r.min(r.map(e.nodes(),function(t){return e.node(t).rank}));r.each(e.nodes(),function(n){var i=e.node(n);r.has(i,"rank")&&(i.rank-=t)})}function p(e){var t=r.min(r.map(e.nodes(),function(t){return e.node(t).rank})),n=[];r.each(e.nodes(),function(i){var s=e.node(i).rank-t;r.has(n,s)||(n[s]=[]),n[s].push(i)});var i=0,s=e.graph().nodeRankFactor;r.each(n,function(t,n){r.isUndefined(t)&&n%s!==0?--i:i&&r.each(t,function(t){e.node(t).rank+=i})})}function d(e,t,n,r){var i={width:0,height:0};return arguments.length>=4&&(i.rank=n,i.order=r),s(e,"border",i,t)}function v(e){return r.max(r.map(e.nodes(),function(t){var n=e.node(t).rank;if(!r.isUndefined(n))return n}))}function m(e,t){var n={lhs:[],rhs:[]};return r.each(e,function(e){t(e)?n.lhs.push(e):n.rhs.push(e)}),n}function g(e,t){var n=r.now();try{return t()}finally{console.log(e+" time: "+(r.now()-n)+"ms")}}function y(e,t){return t()}var r=e("./lodash"),i=e("./graphlib").Graph;t.exports={addDummyNode:s,simplify:o,asNonCompoundGraph:u,successorWeights:a,predecessorWeights:f,intersectRect:l,buildLayerMatrix:c,normalizeRanks:h,removeEmptyRanks:p,addBorderNode:d,maxRank:v,partition:m,time:g,notime:y}},{"./graphlib":7,"./lodash":10}],30:[function(e,t,n){t.exports="0.7.1"},{}],31:[function(e,t,n){var r=e("./lib");t.exports={Graph:r.Graph,json:e("./lib/json"),alg:e("./lib/alg"),version:r.version}},{"./lib":47,"./lib/alg":38,"./lib/json":48}],32:[function(e,t,n){function i(e){function s(n){if(r.has(t,n))return;t[n]=!0,i.push(n),r.each(e.successors(n),s),r.each(e.predecessors(n),s)}var t={},n=[],i;return r.each(e.nodes(),function(e){i=[],s(e),i.length&&n.push(i)}),n}var r=e("../lodash");t.exports=i},{"../lodash":49}],33:[function(e,t,n){function i(e,t,n){r.isArray(t)||(t=[t]);var i=[],o={};return r.each(t,function(t){if(!e.hasNode(t))throw new Error("Graph does not have node: "+t);s(e,t,n==="post",o,i)}),i}function s(e,t,n,i,o){r.has(i,t)||(i[t]=!0,n||o.push(t),r.each(e.neighbors(t),function(t){s(e,t,n,i,o)}),n&&o.push(t))}var r=e("../lodash");t.exports=i},{"../lodash":49}],34:[function(e,t,n){function s(e,t,n){return i.transform(e.nodes(),function(i,s){i[s]=r(e,s,t,n)},{})}var r=e("./dijkstra"),i=e("../lodash");t.exports=s},{"../lodash":49,"./dijkstra":35}],35:[function(e,t,n){function o(e,t,n,r){return u(e,String(t),n||s,r||function(t){return e.outEdges(t)})}function u(e,t,n,r){var s={},o=new i,u,a,f=function(e){var t=e.v!==u?e.v:e.w,r=s[t],i=n(e),f=a.distance+i;if(i<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+e+" Weight: "+i);f<r.distance&&(r.distance=f,r.predecessor=u,o.decrease(t,f))};e.nodes().forEach(function(e){var n=e===t?0:Number.POSITIVE_INFINITY;s[e]={distance:n},o.add(e,n)});while(o.size()>0){u=o.removeMin(),a=s[u];if(a.distance===Number.POSITIVE_INFINITY)break;r(u).forEach(f)}return s}var r=e("../lodash"),i=e("../data/priority-queue");t.exports=o;var s=r.constant(1)},{"../data/priority-queue":45,"../lodash":49}],36:[function(e,t,n){function s(e){return r.filter(i(e),function(e){return e.length>1})}var r=e("../lodash"),i=e("./tarjan");t.exports=s},{"../lodash":49,"./tarjan":43}],37:[function(e,t,n){function s(e,t,n){return o(e,t||i,n||function(t){return e.outEdges(t)})}function o(e,t,n){var r={},i=e.nodes();return i.forEach(function(e){r[e]={},r[e][e]={distance:0},i.forEach(function(t){e!==t&&(r[e][t]={distance:Number.POSITIVE_INFINITY})}),n(e).forEach(function(n){var i=n.v===e?n.w:n.v,s=t(n);r[e][i]={distance:s,predecessor:e}})}),i.forEach(function(e){var t=r[e];i.forEach(function(n){var s=r[n];i.forEach(function(n){var r=s[e],i=t[n],o=s[n],u=r.distance+i.distance;u<o.distance&&(o.distance=u,o.predecessor=i.predecessor)})})}),r}var r=e("../lodash");t.exports=s;var i=r.constant(1)},{"../lodash":49}],38:[function(e,t,n){t.exports={components:e("./components"),dijkstra:e("./dijkstra"),dijkstraAll:e("./dijkstra-all"),findCycles:e("./find-cycles"),floydWarshall:e("./floyd-warshall"),isAcyclic:e("./is-acyclic"),postorder:e("./postorder"),preorder:e("./preorder"),prim:e("./prim"),tarjan:e("./tarjan"),topsort:e("./topsort")}},{"./components":32,"./dijkstra":35,"./dijkstra-all":34,"./find-cycles":36,"./floyd-warshall":37,"./is-acyclic":39,"./postorder":40,"./preorder":41,"./prim":42,"./tarjan":43,"./topsort":44}],39:[function(e,t,n){function i(e){try{r(e)}catch(t){if(t instanceof r.CycleException)return!1;throw t}return!0}var r=e("./topsort");t.exports=i},{"./topsort":44}],40:[function(e,t,n){function i(e,t){return r(e,t,"post")}var r=e("./dfs");t.exports=i},{"./dfs":33}],41:[function(e,t,n){function i(e,t){return r(e,t,"pre")}var r=e("./dfs");t.exports=i},{"./dfs":33}],42:[function(e,t,n){function o(e,t){function f(e){var n=e.v===a?e.w:e.v,r=u.priority(n);if(r!==undefined){var i=t(e);i<r&&(o[n]=a,u.decrease(n,i))}}var n=new i,o={},u=new s,a;if(e.nodeCount()===0)return n;r.each(e.nodes(),function(e){u.add(e,Number.POSITIVE_INFINITY),n.setNode(e)}),u.decrease(e.nodes()[0],0);var l=!1;while(u.size()>0){a=u.removeMin();if(r.has(o,a))n.setEdge(a,o[a]);else{if(l)throw new Error("Input graph is not connected: "+e);l=!0}e.nodeEdges(a).forEach(f)}return n}var r=e("../lodash"),i=e("../graph"),s=e("../data/priority-queue");t.exports=o},{"../data/priority-queue":45,"../graph":46,"../lodash":49}],43:[function(e,t,n){function i(e){function o(u){var a=i[u]={onStack:!0,lowlink:t,index:t++};n.push(u),e.successors(u).forEach(function(e){r.has(i,e)?i[e].onStack&&(a.lowlink=Math.min(a.lowlink,i[e].index)):(o(e),a.lowlink=Math.min(a.lowlink,i[e].lowlink))});if(a.lowlink===a.index){var f=[],l;do l=n.pop(),i[l].onStack=!1,f.push(l);while(u!==l);s.push(f)}}var t=0,n=[],i={},s=[];return e.nodes().forEach(function(e){r.has(i,e)||o(e)}),s}var r=e("../lodash");t.exports=i},{"../lodash":49}],44:[function(e,t,n){function i(e){function o(u){if(r.has(n,u))throw new s;r.has(t,u)||(n[u]=!0,t[u]=!0,r.each(e.predecessors(u),o),delete n[u],i.push(u))}var t={},n={},i=[];r.each(e.sinks(),o);if(r.size(t)!==e.nodeCount())throw new s;return i}function s(){}var r=e("../lodash");t.exports=i,i.CycleException=s},{"../lodash":49}],45:[function(e,t,n){function i(){this._arr=[],this._keyIndices={}}var r=e("../lodash");t.exports=i,i.prototype.size=function(){return this._arr.length},i.prototype.keys=function(){return this._arr.map(function(e){return e.key})},i.prototype.has=function(e){return r.has(this._keyIndices,e)},i.prototype.priority=function(e){var t=this._keyIndices[e];if(t!==undefined)return this._arr[t].priority},i.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},i.prototype.add=function(e,t){var n=this._keyIndices;e=String(e);if(!r.has(n,e)){var i=this._arr,s=i.length;return n[e]=s,i.push({key:e,priority:t}),this._decrease(s),!0}return!1},i.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key},i.prototype.decrease=function(e,t){var n=this._keyIndices[e];if(t>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[n].priority+" New: "+t);this._arr[n].priority=t,this._decrease(n)},i.prototype._heapify=function(e){var t=this._arr,n=2*e,r=n+1,i=e;n<t.length&&(i=t[n].priority<t[i].priority?n:i,r<t.length&&(i=t[r].priority<t[i].priority?r:i),i!==e&&(this._swap(e,i),this._heapify(i)))},i.prototype._decrease=function(e){var t=this._arr,n=t[e].priority,r;while(e!==0){r=e>>1;if(t[r].priority<n)break;this._swap(e,r),e=r}},i.prototype._swap=function(e,t){var n=this._arr,r=this._keyIndices,i=n[e],s=n[t];n[e]=s,n[t]=i,r[s.key]=e,r[i.key]=t}},{"../lodash":49}],46:[function(e,t,n){"use strict";function u(e){this._isDirected=r.has(e,"directed")?e.directed:!0,this._isMultigraph=r.has(e,"multigraph")?e.multigraph:!1,this._isCompound=r.has(e,"compound")?e.compound:!1,this._label=undefined,this._defaultNodeLabelFn=r.constant(undefined),this._defaultEdgeLabelFn=r.constant(undefined),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[s]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function a(e,t){r.has(e,t)?e[t]++:e[t]=1}function f(e,t){--e[t]||delete e[t]}function l(e,t,n,s){if(!e&&t>n){var u=t;t=n,n=u}return t+o+n+o+(r.isUndefined(s)?i:s)}function c(e,t,n,r){if(!e&&t>n){var i=t;t=n,n=i}var s={v:t,w:n};return r&&(s.name=r),s}function h(e,t){return l(e,t.v,t.w,t.name)}var r=e("./lodash");t.exports=u;var i="\0",s="\0",o="";u.prototype._nodeCount=0,u.prototype._edgeCount=0,u.prototype.isDirected=function(){return this._isDirected},u.prototype.isMultigraph=function(){return this._isMultigraph},u.prototype.isCompound=function(){return this._isCompound},u.prototype.setGraph=function(e){return this._label=e,this},u.prototype.graph=function(){return this._label},u.prototype.setDefaultNodeLabel=function(e){return r.isFunction(e)||(e=r.constant(e)),this._defaultNodeLabelFn=e,this},u.prototype.nodeCount=function(){return this._nodeCount},u.prototype.nodes=function(){return r.keys(this._nodes)},u.prototype.sources=function(){return r.filter(this.nodes(),function(e){return r.isEmpty(this._in[e])},this)},u.prototype.sinks=function(){return r.filter(this.nodes(),function(e){return r.isEmpty(this._out[e])},this)},u.prototype.setNodes=function(e,t){var n=arguments;return r.each(e,function(e){n.length>1?this.setNode(e,t):this.setNode(e)},this),this},u.prototype.setNode=function(e,t){return r.has(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=t),this):(this._nodes[e]=arguments.length>1?t:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]=s,this._children[e]={},this._children[s][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)},u.prototype.node=function(e){return this._nodes[e]},u.prototype.hasNode=function(e){return r.has(this._nodes,e)},u.prototype.removeNode=function(e){var t=this;if(r.has(this._nodes,e)){var n=function(e){t.removeEdge(t._edgeObjs[e])};delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],r.each(this.children(e),function(e){this.setParent(e)},this),delete this._children[e]),r.each(r.keys(this._in[e]),n),delete this._in[e],delete this._preds[e],r.each(r.keys(this._out[e]),n),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this},u.prototype.setParent=function(e,t){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(r.isUndefined(t))t=s;else{for(var n=t;!r.isUndefined(n);n=this.parent(n))if(n===e)throw new Error("Setting "+t+" as parent of "+e+" would create create a cycle");this.setNode(t)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=t,this._children[t][e]=!0,this},u.prototype._removeFromParentsChildList=function(e){delete this._children[this._parent[e]][e]},u.prototype.parent=function(e){if(this._isCompound){var t=this._parent[e];if(t!==s)return t}},u.prototype.children=function(e){r.isUndefined(e)&&(e=s);if(this._isCompound){var t=this._children[e];if(t)return r.keys(t)}else{if(e===s)return this.nodes();if(this.hasNode(e))return[]}},u.prototype.predecessors=function(e){var t=this._preds[e];if(t)return r.keys(t)},u.prototype.successors=function(e){var t=this._sucs[e];if(t)return r.keys(t)},u.prototype.neighbors=function(e){var t=this.predecessors(e);if(t)return r.union(t,this.successors(e))},u.prototype.setDefaultEdgeLabel=function(e){return r.isFunction(e)||(e=r.constant(e)),this._defaultEdgeLabelFn=e,this},u.prototype.edgeCount=function(){return this._edgeCount},u.prototype.edges=function(){return r.values(this._edgeObjs)},u.prototype.setPath=function(e,t){var n=this,i=arguments;return r.reduce(e,function(e,r){return i.length>1?n.setEdge(e,r,t):n.setEdge(e,r),r}),this},u.prototype.setEdge=function(){var e,t,n,i,s=!1;r.isPlainObject(arguments[0])?(e=arguments[0].v,t=arguments[0].w,n=arguments[0].name,arguments.length===2&&(i=arguments[1],s=!0)):(e=arguments[0],t=arguments[1],n=arguments[3],arguments.length>2&&(i=arguments[2],s=!0)),e=""+e,t=""+t,r.isUndefined(n)||(n=""+n);var o=l(this._isDirected,e,t,n);if(r.has(this._edgeLabels,o))return s&&(this._edgeLabels[o]=i),this;if(!r.isUndefined(n)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(t),this._edgeLabels[o]=s?i:this._defaultEdgeLabelFn(e,t,n);var u=c(this._isDirected,e,t,n);return e=u.v,t=u.w,Object.freeze(u),this._edgeObjs[o]=u,a(this._preds[t],e),a(this._sucs[e],t),this._in[t][o]=u,this._out[e][o]=u,this._edgeCount++,this},u.prototype.edge=function(e,t,n){var r=arguments.length===1?h(this._isDirected,arguments[0]):l(this._isDirected,e,t,n);return this._edgeLabels[r]},u.prototype.hasEdge=function(e,t,n){var i=arguments.length===1?h(this._isDirected,arguments[0]):l(this._isDirected,e,t,n);return r.has(this._edgeLabels,i)},u.prototype.removeEdge=function(e,t,n){var r=arguments.length===1?h(this._isDirected,arguments[0]):l(this._isDirected,e,t,n),i=this._edgeObjs[r];return i&&(e=i.v,t=i.w,delete this._edgeLabels[r],delete this._edgeObjs[r],f(this._preds[t],e),f(this._sucs[e],t),delete this._in[t][r],delete this._out[e][r],this._edgeCount--),this},u.prototype.inEdges=function(e,t){var n=this._in[e];if(n){var i=r.values(n);return t?r.filter(i,function(e){return e.v===t}):i}},u.prototype.outEdges=function(e,t){var n=this._out[e];if(n){var i=r.values(n);return t?r.filter(i,function(e){return e.w===t}):i}},u.prototype.nodeEdges=function(e,t){var n=this.inEdges(e,t);if(n)return n.concat(this.outEdges(e,t))}},{"./lodash":49}],47:[function(e,t,n){t.exports={Graph:e("./graph"),version:e("./version")}},{"./graph":46,"./version":50}],48:[function(e,t,n){function s(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:o(e),edges:u(e)};return r.isUndefined(e.graph())||(t.value=r.clone(e.graph())),t}function o(e){return r.map(e.nodes(),function(t){var n=e.node(t),i=e.parent(t),s={v:t};return r.isUndefined(n)||(s.value=n),r.isUndefined(i)||(s.parent=i),s})}function u(e){return r.map(e.edges(),function(t){var n=e.edge(t),i={v:t.v,w:t.w};return r.isUndefined(t.name)||(i.name=t.name),r.isUndefined(n)||(i.value=n),i})}function a(e){var t=(new i(e.options)).setGraph(e.value);return r.each(e.nodes,function(e){t.setNode(e.v,e.value),e.parent&&t.setParent(e.v,e.parent)}),r.each(e.edges,function(e){t.setEdge({v:e.v,w:e.w,name:e.name},e.value)}),t}var r=e("./lodash"),i=e("./graph");t.exports={write:s,read:a}},{"./graph":46,"./lodash":49}],49:[function(e,t,n){t.exports=e(10)},{"/Users/cpettitt/projects/dagre/lib/lodash.js":10,lodash:51}],50:[function(e,t,n){t.exports="1.0.1"},{}],51:[function(t,n,r){(function(t){(function(){function W(e,t,n){var r=(n||0)-1,i=e?e.length:0;while(++r<i)if(e[r]===t)return r;return-1}function X(e,t){var n=typeof t;e=e.cache;if(n=="boolean"||t==null)return e[t]?0:-1;n!="number"&&n!="string"&&(n="object");var r=n=="number"?t:a+t;return e=(e=e[n])&&e[r],n=="object"?e&&W(e,t)>-1?0:-1:e?0:-1}function V(e){var t=this.cache,n=typeof e;if(n=="boolean"||e==null)t[e]=!0;else{n!="number"&&n!="string"&&(n="object");var r=n=="number"?e:a+e,i=t[n]||(t[n]={});n=="object"?(i[r]||(i[r]=[])).push(e):i[r]=!0}}function $(e){return e.charCodeAt(0)}function J(e,t){var n=e.criteria,r=t.criteria,i=-1,s=n.length;while(++i<s){var o=n[i],u=r[i];if(o!==u){if(o>u||typeof o=="undefined")return 1;if(o<u||typeof u=="undefined")return-1}}return e.index-t.index}function K(e){var t=-1,n=e.length,r=e[0],i=e[n/2|0],s=e[n-1];if(r&&typeof r=="object"&&i&&typeof i=="object"&&s&&typeof s=="object")return!1;var o=Y();o["false"]=o["null"]=o["true"]=o["undefined"]=!1;var u=Y();u.array=e,u.cache=o,u.push=V;while(++t<n)u.push(e[t]);return u}function Q(e){return"\\"+F[e]}function G(){return s.pop()||[]}function Y(){return o.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,"undefined":!1,value:null}}function Z(e){e.length=0,s.length<l&&s.push(e)}function et(e){var t=e.cache;t&&et(t),e.array=e.cache=e.criteria=e.object=e.number=e.string=e.value=null,o.length<l&&o.push(e)}function tt(e,t,n){t||(t=0),typeof n=="undefined"&&(n=e?e.length:0);var r=-1,i=n-t||0,s=Array(i<0?0:i);while(++r<i)s[r]=e[t+r];return s}function nt(e){function Lt(e){return e&&typeof e=="object"&&!Gt(e)&&ht.call(e,"__wrapped__")?e:new At(e)}function At(e,t){this.__chain__=!!t,this.__wrapped__=e}function Mt(e){function i(){if(n){var e=tt(n);pt.apply(e,arguments)}if(this instanceof i){var s=Dt(t.prototype),o=t.apply(s,e||arguments);return Cn(o)?o:s}return t.apply(r,e||arguments)}var t=e[0],n=e[2],r=e[4];return $t(i,e),i}function _t(e,t,n,r,i){if(n){var s=n(e);if(typeof s!="undefined")return s}var o=Cn(e);if(!o)return e;var u=st.call(e);if(!P[u])return e;var a=kt[u];switch(u){case k:case L:return new a(+e);case O:case D:return new a(e);case _:return s=a(e.source,m.exec(e)),s.lastIndex=e.lastIndex,s}var f=Gt(e);if(t){var l=!r;r||(r=G()),i||(i=G());var c=r.length;while(c--)if(r[c]==e)return i[c];s=f?a(e.length):{}}else s=f?tt(e):sn({},e);return f&&(ht.call(e,"index")&&(s.index=e.index),ht.call(e,"input")&&(s.input=e.input)),t?(r.push(e),i.push(s),(f?Jn:dn)(e,function(e,o){s[o]=_t(e,t,n,r,i)}),l&&(Z(r),Z(i)),s):s}function Dt(e,t){return Cn(e)?yt(e):{}}function Pt(e,t,n){if(typeof e!="function")return Zr;if(typeof t!="undefined"&&"prototype"in e){var r=e.__bindData__;if(typeof r=="undefined"){Ot.funcNames&&(r=!e.name),r=r||!Ot.funcDecomp;if(!r){var i=lt.call(e);Ot.funcNames||(r=!g.test(i)),r||(r=E.test(i),$t(e,r))}}if(r===!1||r!==!0&&r[1]&1)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,s){return e.call(t,n,r,i,s)}}return Br(e,t)}return e}function Ht(e){function h(){var e=u?s:this;if(r){var p=tt(r);pt.apply(p,arguments)}if(i||f){p||(p=tt(arguments)),i&&pt.apply(p,i);if(f&&p.length<o)return n|=16,Ht([t,l?n:n&-4,p,null,s,o])}p||(p=arguments),a&&(t=e[c]);if(this instanceof h){e=Dt(t.prototype);var d=t.apply(e,p);return Cn(d)?d:e}return t.apply(e,p)}var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],u=n&1,a=n&2,f=n&4,l=n&8,c=t;return $t(h,e),h}function Bt(e,t){var n=-1,r=Xt(),i=e?e.length:0,s=i>=f&&r===W,o=[];if(s){var u=K(t);u?(r=X,t=u):s=!1}while(++n<i){var a=e[n];r(t,a)<0&&o.push(a)}return s&&et(t),o}function jt(e,t,n,r){var i=(r||0)-1,s=e?e.length:0,o=[];while(++i<s){var u=e[i];if(u&&typeof u=="object"&&typeof u.length=="number"&&(Gt(u)||Qt(u))){t||(u=jt(u,t,n));var a=-1,f=u.length,l=o.length;o.length+=f;while(++a<f)o[l++]=u[a]}else n||o.push(u)}return o}function Ft(e,t,n,r,i,s){if(n){var o=n(e,t);if(typeof o!="undefined")return!!o}if(e===t)return e!==0||1/e==1/t;var u=typeof e,a=typeof t;if(e===e&&(!e||!j[u])&&(!t||!j[a]))return!1;if(e==null||t==null)return e===t;var f=st.call(e),l=st.call(t);f==N&&(f=M),l==N&&(l=M);if(f!=l)return!1;switch(f){case k:case L:return+e==+t;case O:return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case _:case D:return e==R(t)}var c=f==C;if(!c){var h=ht.call(e,"__wrapped__"),p=ht.call(t,"__wrapped__");if(h||p)return Ft(h?e.__wrapped__:e,p?t.__wrapped__:t,n,r,i,s);if(f!=M)return!1;var d=e.constructor,v=t.constructor;if(d!=v&&!(Nn(d)&&d instanceof d&&Nn(v)&&v instanceof v)&&"constructor"in e&&"constructor"in t)return!1}var m=!i;i||(i=G()),s||(s=G());var g=i.length;while(g--)if(i[g]==e)return s[g]==t;var y=0;o=!0,i.push(e),s.push(t);if(c){g=e.length,y=t.length,o=y==g;if(o||r)while(y--){var b=g,w=t[y];if(r){while(b--)if(o=Ft(e[b],w,n,r,i,s))break}else if(!(o=Ft(e[y],w,n,r,i,s)))break}}else hn(t,function(t,u,a){if(ht.call(a,u))return y++,o=ht.call(e,u)&&Ft(e[u],t,n,r,i,s)}),o&&!r&&hn(e,function(e,t,n){if(ht.call(n,t))return o=--y>-1});return i.pop(),s.pop(),m&&(Z(i),Z(s)),o}function It(e,t,n,r,i){(Gt(t)?Jn:dn)(t,function(t,s){var o,u,a=t,f=e[s];if(t&&((u=Gt(t))||On(t))){var l=r.length;while(l--)if(o=r[l]==t){f=i[l];break}if(!o){var c;if(n){a=n(f,t);if(c=typeof a!="undefined")f=a}c||(f=u?Gt(f)?f:[]:On(f)?f:{}),r.push(t),i.push(f),c||It(f,t,n,r,i)}}else n&&(a=n(f,t),typeof a=="undefined"&&(a=t)),typeof a!="undefined"&&(f=a);e[s]=f})}function qt(e,t){return e+ft(Ct()*(t-e+1))}function Rt(e,t,n){var r=-1,i=Xt(),s=e?e.length:0,o=[],u=!t&&s>=f&&i===W,a=n||u?G():o;if(u){var l=K(a);i=X,a=l}while(++r<s){var c=e[r],h=n?n(c,r,e):c;if(t?!r||a[a.length-1]!==h:i(a,h)<0)(n||u)&&a.push(h),o.push(c)}return u?(Z(a.array),et(a)):n&&Z(a),o}function Ut(e){return function(t,n,r){var i={};n=Lt.createCallback(n,r,3);var s=-1,o=t?t.length:0;if(typeof o=="number")while(++s<o){var u=t[s];e(i,u,n(u,s,t),t)}else dn(t,function(t,r,s){e(i,t,n(t,r,s),s)});return i}}function zt(e,t,n,r,i,s){var o=t&1,u=t&2,a=t&4,f=t&8,l=t&16,c=t&32;if(!u&&!Nn(e))throw new U;l&&!n.length&&(t&=-17,l=n=!1),c&&!r.length&&(t&=-33,c=r=!1);var h=e&&e.__bindData__;if(h&&h!==!0)return h=tt(h),h[2]&&(h[2]=tt(h[2])),h[3]&&(h[3]=tt(h[3])),o&&!(h[1]&1)&&(h[4]=i),!o&&h[1]&1&&(t|=8),a&&!(h[1]&4)&&(h[5]=s),l&&pt.apply(h[2]||(h[2]=[]),n),c&&mt.apply(h[3]||(h[3]=[]),r),h[1]|=t,zt.apply(null,h);var p=t==1||t===17?Mt:Ht;return p([e,t,n,r,i,s])}function Wt(e){return en[e]}function Xt(){var e=(e=Lt.indexOf)===br?W:e;return e}function Vt(e){return typeof e=="function"&&ot.test(e)}function Jt(e){var t,n;return!!e&&st.call(e)==M&&(t=e.constructor,!Nn(t)||t instanceof t)?(hn(e,function(e,t){n=t}),typeof n=="undefined"||ht.call(e,n)):!1}function Kt(e){return tn[e]}function Qt(e){return e&&typeof e=="object"&&typeof e.length=="number"&&st.call(e)==N||!1}function on(e,t,n,r){return typeof t!="boolean"&&t!=null&&(r=n,n=t,t=!1),_t(e,t,typeof n=="function"&&Pt(n,r,1))}function un(e,t,n){return _t(e,!0,typeof t=="function"&&Pt(t,n,1))}function an(e,t){var n=Dt(e);return t?sn(n,t):n}function ln(e,t,n){var r;return t=Lt.createCallback(t,n,3),dn(e,function(e,n,i){if(t(e,n,i))return r=n,!1}),r}function cn(e,t,n){var r;return t=Lt.createCallback(t,n,3),vn(e,function(e,n,i){if(t(e,n,i))return r=n,!1}),r}function pn(e,t,n){var r=[];hn(e,function(e,t){r.push(t,e)});var i=r.length;t=Pt(t,n,3);while(i--)if(t(r[i--],r[i],e)===!1)break;return e}function vn(e,t,n){var r=Zt(e),i=r.length;t=Pt(t,n,3);while(i--){var s=r[i];if(t(e[s],s,e)===!1)break}return e}function mn(e){var t=[];return hn(e,function(e,n){Nn(e)&&t.push(n)}),t.sort()}function gn(e,t){return e?ht.call(e,t):!1}function yn(e){var t=-1,n=Zt(e),r=n.length,i={};while(++t<r){var s=n[t];i[e[s]]=s}return i}function bn(e){return e===!0||e===!1||e&&typeof e=="object"&&st.call(e)==k||!1}function wn(e){return e&&typeof e=="object"&&st.call(e)==L||!1}function En(e){return e&&e.nodeType===1||!1}function Sn(e){var t=!0;if(!e)return t;var n=st.call(e),r=e.length;return n==C||n==D||n==N||n==M&&typeof r=="number"&&Nn(e.splice)?!r:(dn(e,function(){return t=!1}),t)}function xn(e,t,n,r){return Ft(e,t,typeof n=="function"&&Pt(n,r,2))}function Tn(e){return wt(e)&&!Et(parseFloat(e))}function Nn(e){return typeof e=="function"}function Cn(e){return!!e&&!!j[typeof e]}function kn(e){return An(e)&&e!=+e}function Ln(e){return e===null}function An(e){return typeof e=="number"||e&&typeof e=="object"&&st.call(e)==O||!1}function Mn(e){return e&&typeof e=="object"&&st.call(e)==_||!1}function _n(e){return typeof e=="string"||e&&typeof e=="object"&&st.call(e)==D||!1}function Dn(e){return typeof e=="undefined"}function Pn(e,t,n){var r={};return t=Lt.createCallback(t,n,3),dn(e,function(e,n,i){r[n]=t(e,n,i)}),r}function Hn(e){var t=arguments,n=2;if(!Cn(e))return e;typeof t[2]!="number"&&(n=t.length);if(n>3&&typeof t[n-2]=="function")var r=Pt(t[--n-1],t[n--],2);else n>2&&typeof t[n-1]=="function"&&(r=t[--n]);var i=tt(arguments,1,n),s=-1,o=G(),u=G();while(++s<n)It(e,i[s],r,o,u);return Z(o),Z(u),e}function Bn(e,t,n){var r={};if(typeof t!="function"){var i=[];hn(e,function(e,t){i.push(t)}),i=Bt(i,jt(arguments,!0,!1,1));var s=-1,o=i.length;while(++s<o){var u=i[s];r[u]=e[u]}}else t=Lt.createCallback(t,n,3),hn(e,function(e,n,i){t(e,n,i)||(r[n]=e)});return r}function jn(e){var n=-1,r=Zt(e),i=r.length,s=t(i);while(++n<i){var o=r[n];s[n]=[o,e[o]]}return s}function Fn(e,t,n){var r={};if(typeof t!="function"){var i=-1,s=jt(arguments,!0,!1,1),o=Cn(e)?s.length:0;while(++i<o){var u=s[i];u in e&&(r[u]=e[u])}}else t=Lt.createCallback(t,n,3),hn(e,function(e,n,i){t(e,n,i)&&(r[n]=e)});return r}function In(e,t,n,r){var i=Gt(e);if(n==null)if(i)n=[];else{var s=e&&e.constructor,o=s&&s.prototype;n=Dt(o)}return t&&(t=Lt.createCallback(t,r,4),(i?Jn:dn)(e,function(e,r,i){return t(n,e,r,i)})),n}function qn(e){var n=-1,r=Zt(e),i=r.length,s=t(i);while(++n<i)s[n]=e[r[n]];return s}function Rn(e){var n=arguments,r=-1,i=jt(n,!0,!1,1),s=n[2]&&n[2][n[1]]===e?1:i.length,o=t(s);while(++r<s)o[r]=e[i[r]];return o}function Un(e,t,n){var r=-1,i=Xt(),s=e?e.length:0,o=!1;return n=(n<0?xt(0,s+n):n)||0,Gt(e)?o=i(e,t,n)>-1:typeof s=="number"?o=(_n(e)?e.indexOf(t,n):i(e,t,n))>-1:dn(e,function(e){if(++r>=n)return!(o=e===t)}),o}function Wn(e,t,n){var r=!0;t=Lt.createCallback(t,n,3);var i=-1,s=e?e.length:0;if(typeof s=="number"){while(++i<s)if(!(r=!!t(e[i],i,e)))break}else dn(e,function(e,n,i){return r=!!t(e,n,i)});return r}function Xn(e,t,n){var r=[];t=Lt.createCallback(t,n,3);var i=-1,s=e?e.length:0;if(typeof s=="number")while(++i<s){var o=e[i];t(o,i,e)&&r.push(o)}else dn(e,function(e,n,i){t(e,n,i)&&r.push(e)});return r}function Vn(e,t,n){t=Lt.createCallback(t,n,3);var r=-1,i=e?e.length:0;if(typeof i!="number"){var o;return dn(e,function(e,n,r){if(t(e,n,r))return o=e,!1}),o}while(++r<i){var s=e[r];if(t(s,r,e))return s}}function $n(e,t,n){var r;return t=Lt.createCallback(t,n,3),Kn(e,function(e,n,i){if(t(e,n,i))return r=e,!1}),r}function Jn(e,t,n){var r=-1,i=e?e.length:0;t=t&&typeof n=="undefined"?t:Pt(t,n,3);if(typeof i=="number"){while(++r<i)if(t(e[r],r,e)===!1)break}else dn(e,t);return e}function Kn(e,t,n){var r=e?e.length:0;t=t&&typeof n=="undefined"?t:Pt(t,n,3);if(typeof r=="number"){while(r--)if(t(e[r],r,e)===!1)break}else{var i=Zt(e);r=i.length,dn(e,function(e,n,s){return n=i?i[--r]:--r,t(s[n],n,s)})}return e}function Yn(e,n){var r=tt(arguments,2),i=-1,s=typeof n=="function",o=e?e.length:0,u=t(typeof o=="number"?o:0);return Jn(e,function(e){u[++i]=(s?n:e[n]).apply(e,r)}),u}function Zn(e,n,r){var i=-1,s=e?e.length:0;n=Lt.createCallback(n,r,3);if(typeof s=="number"){var o=t(s);while(++i<s)o[i]=n(e[i],i,e)}else o=[],dn(e,function(e,t,r){o[++i]=n(e,t,r)});return o}function er(e,t,n){var r=-Infinity,i=r;typeof t!="function"&&n&&n[t]===e&&(t=null);if(t==null&&Gt(e)){var s=-1,o=e.length;while(++s<o){var u=e[s];u>i&&(i=u)}}else t=t==null&&_n(e)?$:Lt.createCallback(t,n,3),Jn(e,function(e,n,s){var o=t(e,n,s);o>r&&(r=o,i=e)});return i}function tr(e,t,n){var r=Infinity,i=r;typeof t!="function"&&n&&n[t]===e&&(t=null);if(t==null&&Gt(e)){var s=-1,o=e.length;while(++s<o){var u=e[s];u<i&&(i=u)}}else t=t==null&&_n(e)?$:Lt.createCallback(t,n,3),Jn(e,function(e,n,s){var o=t(e,n,s);o<r&&(r=o,i=e)});return i}function rr(e,t,n,r){if(!e)return n;var i=arguments.length<3;t=Lt.createCallback(t,r,4);var s=-1,o=e.length;if(typeof o=="number"){i&&(n=e[++s]);while(++s<o)n=t(n,e[s],s,e)}else dn(e,function(e,r,s){n=i?(i=!1,e):t(n,e,r,s)});return n}function ir(e,t,n,r){var i=arguments.length<3;return t=Lt.createCallback(t,r,4),Kn(e,function(e,r,s){n=i?(i=!1,e):t(n,e,r,s)}),n}function sr(e,t,n){return t=Lt.createCallback(t,n,3),Xn(e,function(e,n,r){return!t(e,n,r)})}function or(e,t,n){e&&typeof e.length!="number"&&(e=qn(e));if(t==null||n)return e?e[qt(0,e.length-1)]:i;var r=ur(e);return r.length=Tt(xt(0,t),r.length),r}function ur(e){var n=-1,r=e?e.length:0,i=t(typeof r=="number"?r:0);return Jn(e,function(e){var t=qt(0,++n);i[n]=i[t],i[t]=e}),i}function ar(e){var t=e?e.length:0;return typeof t=="number"?t:Zt(e).length}function fr(e,t,n){var r;t=Lt.createCallback(t,n,3);var i=-1,s=e?e.length:0;if(typeof s=="number"){while(++i<s)if(r=t(e[i],i,e))break}else dn(e,function(e,n,i){return!(r=t(e,n,i))});return!!r}function lr(e,n,r){var i=-1,s=Gt(n),o=e?e.length:0,u=t(typeof o=="number"?o:0);s||(n=Lt.createCallback(n,r,3)),Jn(e,function(e,t,r){var o=u[++i]=Y();s?o.criteria=Zn(n,function(t){return e[t]}):(o.criteria=G())[0]=n(e,t,r),o.index=i,o.value=e}),o=u.length,u.sort(J);while(o--){var a=u[o];u[o]=a.value,s||Z(a.criteria),et(a)}return u}function cr(e){return e&&typeof e.length=="number"?tt(e):qn(e)}function pr(e){var t=-1,n=e?e.length:0,r=[];while(++t<n){var i=e[t];i&&r.push(i)}return r}function dr(e){return Bt(e,jt(arguments,!0,!0,1))}function vr(e,t,n){var r=-1,i=e?e.length:0;t=Lt.createCallback(t,n,3);while(++r<i)if(t(e[r],r,e))return r;return-1}function mr(e,t,n){var r=e?e.length:0;t=Lt.createCallback(t,n,3);while(r--)if(t(e[r],r,e))return r;return-1}function gr(e,t,n){var r=0,s=e?e.length:0;if(typeof t!="number"&&t!=null){var o=-1;t=Lt.createCallback(t,n,3);while(++o<s&&t(e[o],o,e))r++}else{r=t;if(r==null||n)return e?e[0]:i}return tt(e,0,Tt(xt(0,r),s))}function yr(e,t,n,r){return typeof t!="boolean"&&t!=null&&(r=n,n=typeof t!="function"&&r&&r[t]===e?null:t,t=!1),n!=null&&(e=Zn(e,n,r)),jt(e,t)}function br(e,t,n){if(typeof n=="number"){var r=e?e.length:0;n=n<0?xt(0,r+n):n||0}else if(n){var i=Lr(e,t);return e[i]===t?i:-1}return W(e,t,n)}function wr(e,t,n){var r=0,i=e?e.length:0;if(typeof t!="number"&&t!=null){var s=i;t=Lt.createCallback(t,n,3);while(s--&&t(e[s],s,e))r++}else r=t==null||n?1:t||r;return tt(e,0,Tt(xt(0,i-r),i))}function Er(){var e=[],t=-1,n=arguments.length,r=G(),i=Xt(),s=i===W,o=G();while(++t<n){var u=arguments[t];if(Gt(u)||Qt(u))e.push(u),r.push(s&&u.length>=f&&K(t?e[t]:o))}var a=e[0],l=-1,c=a?a.length:0,h=[];e:while(++l<c){var p=r[0];u=a[l];if((p?X(p,u):i(o,u))<0){t=n,(p||o).push(u);while(--t){p=r[t];if((p?X(p,u):i(e[t],u))<0)continue e}h.push(u)}}while(n--)p=r[n],p&&et(p);return Z(r),Z(o),h}function Sr(e,t,n){var r=0,s=e?e.length:0;if(typeof t!="number"&&t!=null){var o=s;t=Lt.createCallback(t,n,3);while(o--&&t(e[o],o,e))r++}else{r=t;if(r==null||n)return e?e[s-1]:i}return tt(e,xt(0,s-r))}function xr(e,t,n){var r=e?e.length:0;typeof n=="number"&&(r=(n<0?xt(0,r+n):Tt(n,r-1))+1);while(r--)if(e[r]===t)return r;return-1}function Tr(e){var t=arguments,n=0,r=t.length,i=e?e.length:0;while(++n<r){var s=-1,o=t[n];while(++s<i)e[s]===o&&(vt.call(e,s--,1),i--)}return e}function Nr(e,n,r){e=+e||0,r=typeof r=="number"?r:+r||1,n==null&&(n=e,e=0);var i=-1,s=xt(0,ut((n-e)/(r||1))),o=t(s);while(++i<s)o[i]=e,e+=r;return o}function Cr(e,t,n){var r=-1,i=e?e.length:0,s=[];t=Lt.createCallback(t,n,3);while(++r<i){var o=e[r];t(o,r,e)&&(s.push(o),vt.call(e,r--,1),i--)}return s}function kr(e,t,n){if(typeof t!="number"&&t!=null){var r=0,i=-1,s=e?e.length:0;t=Lt.createCallback(t,n,3);while(++i<s&&t(e[i],i,e))r++}else r=t==null||n?1:xt(0,t);return tt(e,r)}function Lr(e,t,n,r){var i=0,s=e?e.length:i;n=n?Lt.createCallback(n,r,1):Zr,t=n(t);while(i<s){var o=i+s>>>1;n(e[o])<t?i=o+1:s=o}return i}function Ar(){return Rt(jt(arguments,!0,!0))}function Or(e,t,n,r){return typeof t!="boolean"&&t!=null&&(r=n,n=typeof t!="function"&&r&&r[t]===e?null:t,t=!1),n!=null&&(n=Lt.createCallback(n,r,3)),Rt(e,t,n)}function Mr(e){return Bt(e,tt(arguments,1))}function _r(){var e=-1,t=arguments.length;while(++e<t){var n=arguments[e];if(Gt(n)||Qt(n))var r=r?Rt(Bt(r,n).concat(Bt(n,r))):n}return r||[]}function Dr(){var e=arguments.length>1?arguments:arguments[0],n=-1,r=e?er(nr(e,"length")):0,i=t(r<0?0:r);while(++n<r)i[n]=nr(e,n);return i}function Pr(e,t){var n=-1,r=e?e.length:0,i={};!t&&r&&!Gt(e[0])&&(t=[]);while(++n<r){var s=e[n];t?i[s]=t[n]:s&&(i[s[0]]=s[1])}return i}function Hr(e,t){if(!Nn(t))throw new U;return function(){if(--e<1)return t.apply(this,arguments)}}function Br(e,t){return arguments.length>2?zt(e,17,tt(arguments,2),null,t):zt(e,1,null,null,t)}function jr(e){var t=arguments.length>1?jt(arguments,!0,!1,1):mn(e),n=-1,r=t.length;while(++n<r){var i=t[n];e[i]=zt(e[i],1,null,null,e)}return e}function Fr(e,t){return arguments.length>2?zt(t,19,tt(arguments,2),null,e):zt(t,3,null,null,e)}function Ir(){var e=arguments,t=e.length;while(t--)if(!Nn(e[t]))throw new U;return function(){var t=arguments,n=e.length;while(n--)t=[e[n].apply(this,t)];return t[0]}}function qr(e,t){return t=typeof t=="number"?t:+t||e.length,zt(e,4,null,null,null,t)}function Rr(e,t,n){var r,s,o,u,a,f,l,c=0,h=!1,p=!0;if(!Nn(e))throw new U;t=xt(0,t)||0;if(n===!0){var d=!0;p=!1}else Cn(n)&&(d=n.leading,h="maxWait"in n&&(xt(t,n.maxWait)||0),p="trailing"in n?n.trailing:p);var v=function(){var n=t-(ri()-u);if(n<=0){s&&at(s);var h=l;s=f=l=i,h&&(c=ri(),o=e.apply(a,r),!f&&!s&&(r=a=null))}else f=dt(v,n)},m=function(){f&&at(f),s=f=l=i;if(p||h!==t)c=ri(),o=e.apply(a,r),!f&&!s&&(r=a=null)};return function(){r=arguments,u=ri(),a=this,l=p&&(f||!d);if(h===!1)var n=d&&!f;else{!s&&!d&&(c=u);var i=h-(u-c),g=i<=0;g?(s&&(s=at(s)),c=u,o=e.apply(a,r)):s||(s=dt(m,i))}return g&&f?f=at(f):!f&&t!==h&&(f=dt(v,t)),n&&(g=!0,o=e.apply(a,r)),g&&!f&&!s&&(r=a=null),o}}function Ur(e){if(!Nn(e))throw new U;var t=tt(arguments,1);return dt(function(){e.apply(i,t)},1)}function zr(e,t){if(!Nn(e))throw new U;var n=tt(arguments,2);return dt(function(){e.apply(i,n)},t)}function Wr(e,t){if(!Nn(e))throw new U;var n=function(){var r=n.cache,i=t?t.apply(this,arguments):a+arguments[0];return ht.call(r,i)?r[i]:r[i]=e.apply(this,arguments)};return n.cache={},n}function Xr(e){var t,n;if(!Nn(e))throw new U;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}}function Vr(e){return zt(e,16,tt(arguments,1))}function $r(e){return zt(e,32,null,tt(arguments,1))}function Jr(e,t,n){var r=!0,i=!0;if(!Nn(e))throw new U;return n===!1?r=!1:Cn(n)&&(r="leading"in n?n.leading:r,i="trailing"in n?n.trailing:i),H.leading=r,H.maxWait=t,H.trailing=i,Rr(e,t,H)}function Kr(e,t){return zt(t,16,[e])}function Qr(e){return function(){return e}}function Gr(e,t,n){var r=typeof e;if(e==null||r=="function")return Pt(e,t,n);if(r!="object")return si(e);var i=Zt(e),s=i[0],o=e[s];return i.length==1&&o===o&&!Cn(o)?function(e){var t=e[s];return o===t&&(o!==0||1/o==1/t)}:function(t){var n=i.length,r=!1;while(n--)if(!(r=Ft(t[i[n]],e[i[n]],null,!0)))break;return r}}function Yr(e){return e==null?"":R(e).replace(rn,Wt)}function Zr(e){return e}function ei(e,t,n){var r=!0,i=t&&mn(t);if(!t||!n&&!i.length)n==null&&(n=t),s=At,t=e,e=Lt,i=mn(t);n===!1?r=!1:Cn(n)&&"chain"in n&&(r=n.chain);var s=e,o=Nn(s);Jn(i,function(n){var i=e[n]=t[n];o&&(s.prototype[n]=function(){var t=this.__chain__,n=this.__wrapped__,o=[n];pt.apply(o,arguments);var u=i.apply(e,o);if(r||t){if(n===u&&Cn(u))return this;u=new s(u),u.__chain__=t}return u})})}function ti(){return e._=it,this}function ni(){}function si(e){return function(t){return t[e]}}function oi(e,t,n){var r=e==null,i=t==null;n==null&&(typeof e=="boolean"&&i?(n=e,e=1):!i&&typeof t=="boolean"&&(n=t,i=!0)),r&&i&&(t=1),e=+e||0,i?(t=e,e=0):t=+t||0;if(n||e%1||t%1){var s=Ct();return Tt(e+s*(t-e+parseFloat("1e-"+((s+"").length-1))),t)}return qt(e,t)}function ui(e,t){if(e){var n=e[t];return Nn(n)?e[t]():n}}function ai(e,t,n){var r=Lt.templateSettings;e=R(e||""),n=fn({},n,r);var o=fn({},n.imports,r.imports),u=Zt(o),a=qn(o),f,l=0,c=n.interpolate||w,m="__p += '",g=q((n.escape||w).source+"|"+c.source+"|"+(c===y?v:w).source+"|"+(n.evaluate||w).source+"|$","g");e.replace(g,function(t,n,r,i,s,o){return r||(r=i),m+=e.slice(l,o).replace(S,Q),n&&(m+="' +\n__e("+n+") +\n'"),s&&(f=!0,m+="';\n"+s+";\n__p += '"),r&&(m+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=o+t.length,t}),m+="';\n";var b=n.variable,E=b;E||(b="obj",m="with ("+b+") {\n"+m+"\n}\n"),m=(f?m.replace(h,""):m).replace(p,"$1").replace(d,"$1;"),m="function("+b+") {\n"+(E?"":b+" || ("+b+" = {});\n")+"var __t, __p = '', __e = _.escape"+(f?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+m+"return __p\n}";var x="\n/*\n//# sourceURL="+(n.sourceURL||"/lodash/template/source["+T++ +"]")+"\n*/";try{var N=s(u,"return "+m+x).apply(i,a)}catch(C){throw C.source=m,C}return t?N(t):(N.source=m,N)}function fi(e,n,r){e=(e=+e)>-1?e:0;var i=-1,s=t(e);n=Pt(n,r,1);while(++i<e)s[i]=n(i);return s}function li(e){return e==null?"":R(e).replace(nn,Kt)}function ci(e){var t=++u;return R(e==null?"":e)+t}function hi(e){return e=new At(e),e.__chain__=!0,e}function pi(e,t){return t(e),e}function di(){return this.__chain__=!0,this}function vi(){return R(this.__wrapped__)}function mi(){return this.__wrapped__}e=e?rt.defaults(I.Object(),e,rt.pick(I,x)):I;var t=e.Array,n=e.Boolean,r=e.Date,s=e.Function,o=e.Math,l=e.Number,F=e.Object,q=e.RegExp,R=e.String,U=e.TypeError,z=[],V=F.prototype,it=e._,st=V.toString,ot=q("^"+R(st).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),ut=o.ceil,at=e.clearTimeout,ft=o.floor,lt=s.prototype.toString,ct=Vt(ct=F.getPrototypeOf)&&ct,ht=V.hasOwnProperty,pt=z.push,dt=e.setTimeout,vt=z.splice,mt=z.unshift,gt=function(){try{var e={},t=Vt(t=F.defineProperty)&&t,n=t(e,e,e)&&t}catch(r){}return n}(),yt=Vt(yt=F.create)&&yt,bt=Vt(bt=t.isArray)&&bt,wt=e.isFinite,Et=e.isNaN,St=Vt(St=F.keys)&&St,xt=o.max,Tt=o.min,Nt=e.parseInt,Ct=o.random,kt={};kt[C]=t,kt[k]=n,kt[L]=r,kt[A]=s,kt[M]=F,kt[O]=l,kt[_]=q,kt[D]=R,At.prototype=Lt.prototype;var Ot=Lt.support={};Ot.funcDecomp=!Vt(e.WinRTError)&&E.test(nt),Ot.funcNames=typeof s.name=="string",Lt.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:y,variable:"",imports:{_:Lt}},yt||(Dt=function(){function t(){}return function(n){if(Cn(n)){t.prototype=n;var r=new t;t.prototype=null}return r||e.Object()}}());var $t=gt?function(e,t){B.value=t,gt(e,"__bindData__",B)}:ni,Gt=bt||function(e){return e&&typeof e=="object"&&typeof e.length=="number"&&st.call(e)==C||!1},Yt=function(e){var t,n=e,r=[];if(!n)return r;if(!j[typeof e])return r;for(t in n)ht.call(n,t)&&r.push(t);return r},Zt=St?function(e){return Cn(e)?St(e):[]}:Yt,en={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},tn=yn(en),nn=q("("+Zt(tn).join("|")+")","g"),rn=q("["+Zt(en).join("")+"]","g"),sn=function(e,t,n){var r,i=e,s=i;if(!i)return s;var o=arguments,u=0,a=typeof n=="number"?2:o.length;if(a>3&&typeof o[a-2]=="function")var f=Pt(o[--a-1],o[a--],2);else a>2&&typeof o[a-1]=="function"&&(f=o[--a]);while(++u<a){i=o[u];if(i&&j[typeof i]){var l=-1,c=j[typeof i]&&Zt(i),h=c?c.length:0;while(++l<h)r=c[l],s[r]=f?f(s[r],i[r]):i[r]}}return s},fn=function(e,t,n){var r,i=e,s=i;if(!i)return s;var o=arguments,u=0,a=typeof n=="number"?2:o.length;while(++u<a){i=o[u];if(i&&j[typeof i]){var f=-1,l=j[typeof i]&&Zt(i),c=l?l.length:0;while(++f<c)r=l[f],typeof s[r]=="undefined"&&(s[r]=i[r])}}return s},hn=function(e,t,n){var r,i=e,s=i;if(!i)return s;if(!j[typeof i])return s;t=t&&typeof n=="undefined"?t:Pt(t,n,3);for(r in i)if(t(i[r],r,e)===!1)return s;return s},dn=function(e,t,n){var r,i=e,s=i;if(!i)return s;if(!j[typeof i])return s;t=t&&typeof n=="undefined"?t:Pt(t,n,3);var o=-1,u=j[typeof i]&&Zt(i),a=u?u.length:0;while(++o<a){r=u[o];if(t(i[r],r,e)===!1)return s}return s},On=ct?function(e){if(!e||st.call(e)!=M)return!1;var t=e.valueOf,n=Vt(t)&&(n=ct(t))&&ct(n);return n?e==n||ct(e)==n:Jt(e)}:Jt,zn=Ut(function(e,t,n){ht.call(e,n)?e[n]++:e[n]=1}),Qn=Ut(function(e,t,n){(ht.call(e,n)?e[n]:e[n]=[]).push(t)}),Gn=Ut(function(e,t,n){e[n]=t}),nr=Zn,hr=Xn,ri=Vt(ri=r.now)&&ri||function(){return(new r).getTime()},ii=Nt(c+"08")==8?Nt:function(e,t){return Nt(_n(e)?e.replace(b,""):e,t||0)};return Lt.after=Hr,Lt.assign=sn,Lt.at=Rn,Lt.bind=Br,Lt.bindAll=jr,Lt.bindKey=Fr,Lt.chain=hi,Lt.compact=pr,Lt.compose=Ir,Lt.constant=Qr,Lt.countBy=zn,Lt.create=an,Lt.createCallback=Gr,Lt.curry=qr,Lt.debounce=Rr,Lt.defaults=fn,Lt.defer=Ur,Lt.delay=zr,Lt.difference=dr,Lt.filter=Xn,Lt.flatten=yr,Lt.forEach=Jn,Lt.forEachRight=Kn,Lt.forIn=hn,Lt.forInRight=pn,Lt.forOwn=dn,Lt.forOwnRight=vn,Lt.functions=mn,Lt.groupBy=Qn,Lt.indexBy=Gn,Lt.initial=wr,Lt.intersection=Er,Lt.invert=yn,Lt.invoke=Yn,Lt.keys=Zt,Lt.map=Zn,Lt.mapValues=Pn,Lt.max=er,Lt.memoize=Wr,Lt.merge=Hn,Lt.min=tr,Lt.omit=Bn,Lt.once=Xr,Lt.pairs=jn,Lt.partial=Vr,Lt.partialRight=$r,Lt.pick=Fn,Lt.pluck=nr,Lt.property=si,Lt.pull=Tr,Lt.range=Nr,Lt.reject=sr,Lt.remove=Cr,Lt.rest=kr,Lt.shuffle=ur,Lt.sortBy=lr,Lt.tap=pi,Lt.throttle=Jr,Lt.times=fi,Lt.toArray=cr,Lt.transform=In,Lt.union=Ar,Lt.uniq=Or,Lt.values=qn,Lt.where=hr,Lt.without=Mr,Lt.wrap=Kr,Lt.xor=_r,Lt.zip=Dr,Lt.zipObject=Pr,Lt.collect=Zn,Lt.drop=kr,Lt.each=Jn,Lt.eachRight=Kn,Lt.extend=sn,Lt.methods=mn,Lt.object=Pr,Lt.select=Xn,Lt.tail=kr,Lt.unique=Or,Lt.unzip=Dr,ei(Lt),Lt.clone=on,Lt.cloneDeep=un,Lt.contains=Un,Lt.escape=Yr,Lt.every=Wn,Lt.find=Vn,Lt.findIndex=vr,Lt.findKey=ln,Lt.findLast=$n,Lt.findLastIndex=mr,Lt.findLastKey=cn,Lt.has=gn,Lt.identity=Zr,Lt.indexOf=br,Lt.isArguments=Qt,Lt.isArray=Gt,Lt.isBoolean=bn,Lt.isDate=wn,Lt.isElement=En,Lt.isEmpty=Sn,Lt.isEqual=xn,Lt.isFinite=Tn,Lt.isFunction=Nn,Lt.isNaN=kn,Lt.isNull=Ln,Lt.isNumber=An,Lt.isObject=Cn,Lt.isPlainObject=On,Lt.isRegExp=Mn,Lt.isString=_n,Lt.isUndefined=Dn,Lt.lastIndexOf=xr,Lt.mixin=ei,Lt.noConflict=ti,Lt.noop=ni,Lt.now=ri,Lt.parseInt=ii,Lt.random=oi,Lt.reduce=rr,Lt.reduceRight=ir,Lt.result=ui,Lt.runInContext=nt,Lt.size=ar,Lt.some=fr,Lt.sortedIndex=Lr,Lt.template=ai,Lt.unescape=li,Lt.uniqueId=ci,Lt.all=Wn,Lt.any=fr,Lt.detect=Vn,Lt.findWhere=Vn,Lt.foldl=rr,Lt.foldr=ir,Lt.include=Un,Lt.inject=rr,ei(function(){var e={};return dn(Lt,function(t,n){Lt.prototype[n]||(e[n]=t)}),e}(),!1),Lt.first=gr,Lt.last=Sr,Lt.sample=or,Lt.take=gr,Lt.head=gr,dn(Lt,function(e,t){var n=t!=="sample";Lt.prototype[t]||(Lt.prototype[t]=function(t,r){var i=this.__chain__,s=e(this.__wrapped__,t,r);return!i&&(t==null||r&&(!n||typeof t!="function"))?s:new At(s,i)})}),Lt.VERSION="2.4.1",Lt.prototype.chain=di,Lt.prototype.toString=vi,Lt.prototype.value=mi,Lt.prototype.valueOf=mi,Jn(["join","pop","shift"],function(e){var t=z[e];Lt.prototype[e]=function(){var e=this.__chain__,n=t.apply(this.__wrapped__,arguments);return e?new At(n,e):n}}),Jn(["push","reverse","sort","unshift"],function(e){var t=z[e];Lt.prototype[e]=function(){return t.apply(this.__wrapped__,arguments),this}}),Jn(["concat","slice","splice"],function(e){var t=z[e];Lt.prototype[e]=function(){return new At(t.apply(this.__wrapped__,arguments),this.__chain__)}}),Lt}var i,s=[],o=[],u=0,a=+(new Date)+"",f=75,l=40,c=" 	\f ﻿\n\r\u2028\u2029 ᠎             　",h=/\b__p \+= '';/g,p=/\b(__p \+=) '' \+/g,d=/(__e\(.*?\)|\b__t\)) \+\n'';/g,v=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,m=/\w*$/,g=/^\s*function[ \n\r\t]+\w/,y=/<%=([\s\S]+?)%>/g,b=RegExp("^["+c+"]*0+(?=.$)"),w=/($^)/,E=/\bthis\b/,S=/['\n\r\t\u2028\u2029\\]/g,x=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setTimeout"],T=0,N="[object Arguments]",C="[object Array]",k="[object Boolean]",L="[object Date]",A="[object Function]",O="[object Number]",M="[object Object]",_="[object RegExp]",D="[object String]",P={};P[A]=!1,P[N]=P[C]=P[k]=P[L]=P[O]=P[M]=P[_]=P[D]=!0;var H={leading:!1,maxWait:0,trailing:!1},B={configurable:!1,enumerable:!1,value:null,writable:!1},j={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,"undefined":!1},F={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},I=j[typeof window]&&window||this,q=j[typeof r]&&r&&!r.nodeType&&r,R=j[typeof n]&&n&&!n.nodeType&&n,U=R&&R.exports===q&&q,z=j[typeof t]&&t;z&&(z.global===z||z.window===z)&&(I=z);var rt=nt();typeof e=="function"&&typeof e.amd=="object"&&e.amd?(I._=rt,e(function(){return rt})):q&&R?U?(R.exports=rt)._=rt:q._=rt:I._=rt}).call(this)}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}]},{},[1])(1)}),function(e,t){typeof define=="function"&&define.amd?define("src/graph/GraphData",["dagre"],t):e.graph_GraphData=t(e.dagre)}(this,function(e){function t(){e.graphlib.Graph.call(this,{multigraph:!0,compound:!0}),this.setGraph({}),this.setDefaultNodeLabel(function(){return{}}),this.setDefaultEdgeLabel(function(){return{}})}return t.prototype=Object.create(e.graphlib.Graph.prototype),t.prototype.constructor=t,t.prototype.setData=function(e,t,n,r){var i=this,s={addedVertices:[],addedEdges:[]};for(var o=0;o<e.length;++o){var u=e[o];if(!r||!this.hasNode(u._id))this.setNode(u._id,u),s.addedVertices.push(u)}for(o=0;o<t.length;++o){var a=t[o];if(!r||!this.hasEdge(a._id))this.setEdge(a._sourceVertex._id,a._targetVertex._id,a,a._id),s.addedEdges.push(a)}if(n)for(o=0;o<n.length;++o)this.setParent(n[o].child._id,n[o].parent._id);if(r){var f=t.map(function(e){return e._id});this.filterEdges(function(e){return f.indexOf(e.v+"_"+e.w)<0}).forEach(function(e){});var l=e.map(function(e){return e._id});this.filterNodes(function(e){return l.indexOf(e)<0}).forEach(function(e){try{i.delNode(e)}catch(t){}})}return s},t.prototype.filterEdges=function(e){var t=[];return this.eachEdge(function(n){e(n)&&t.push(n)}),t},t.prototype.filterNodes=function(e){var t=[];return this.eachNode(function(n){e(n)&&t.push(n)}),t},t.prototype.nodeValues=function(){var e=[];return this.nodes().forEach(function(t,n){e.push(this.node(t))},this),e},t.prototype.eachNode=function(e){this.nodes().forEach(function(t,n){e(t,this.node(t))},this)},t.prototype.edgeValues=function(){var e=[];return this.edges().forEach(function(t,n){e.push(this.edge(t))},this),e},t.prototype.eachEdge=function(e){this.edges().forEach(function(t,n){e(t,t.v,t.w,this.edge(t))},this)},t.prototype.getJSON=function(){var t=e.graphlib.json.write(this);return JSON.stringify(t,function(e,t){return e==="value"?t._text&&t._text._text?t._text._text:t._id:t},"  ")},t}),function(e,t){typeof define=="function"&&define.amd?define("src/graph/GraphLayouts",["d3","dagre"],t):e.graph_GraphLayouts=t(e.d3,e.dagre)}(this,function(e,t){function n(e,t,n,r){var i=this;this.pos={};var s=0;r=r||(t<n?t-s:n-s)/2;var o=e.nodeCount(),u=-Math.PI/2,a=2*Math.PI/o;e.eachNode(function(e,t){var n=t.getBBox(!0),s=Math.max(n.width,n.height);i.pos[e]={x:t.fixed?t.x:Math.cos(u)*(r-s),y:t.fixed?t.y:Math.sin(u)*(r-s),width:n.width,height:n.height},u+=a})}function r(e,t,n,r){var i=this;this.pos={},e.eachNode(function(e,t){i.pos[e]={x:t.x,y:t.y,width:t.width,height:t.height}})}function i(t,n,r,i){var s=this;this.pos={},this.vertices=[],this.vertexMap={},t.eachNode(function(e){var n=t.node(e),r=n.getBBox(!0),i={id:e,x:n.pos().x,y:n.pos().y,width:r.width,height:r.height,value:n};s.vertices.push(i),s.vertexMap[e]=i}),this.edges=[],t.eachEdge(function(e,t,n){s.edges.push({source:s.vertexMap[t],target:s.vertexMap[n]})}),this.force=e.layout.force().charge(function(e){var t=e.value.getBBox();return-25*Math.max(t.width,t.height)}).linkDistance(300).nodes(this.vertices).links(this.edges);if(i){this.force.start();var o=t.nodeCount();o=Math.min(o*o,500);for(var u=0;u<o;++u)this.force.tick();this.force.stop()}}function s(e,n,r,i){var s=(new t.graphlib.Graph({multigraph:!0,compound:!0})).setGraph(i).setDefaultNodeLabel(function(){return{}}).setDefaultEdgeLabel(function(){return{}});e.eachNode(function(t){var n=e.node(t),r=n.getBBox();s.setNode(t,{width:r.width,height:r.height})}),e.eachEdge(function(t,n,r){var i=e.edge(t);s.setEdge(n,r,{weight:i.weight()},i._id)}),e.eachNode(function(t){s.setParent(t,e.parent(t))}),this.dagreLayout=t.layout(s);var o=-s.graph().width/2,u=-s.graph().height/2;s.nodes().forEach(function(e){var t=s.node(e);t.x+=o,t.y+=u}),s.edges().forEach(function(e){var t=s.edge(e);for(var n=0;n<t.points.length;++n)t.points[n].x+=o,t.points[n].y+=u}),this.digraph=s}n.prototype.nodePos=function(e){return this.pos[e]},n.prototype.edgePoints=function(e){return[]},r.prototype.nodePos=function(e){return this.pos[e]},r.prototype.edgePoints=function(e){return[]},i.prototype.nodePos=function(e){return this.vertexMap[e]},i.prototype.edgePoints=function(e){return[]},s.prototype.nodePos=function(e){return this.digraph.node(e)},s.prototype.edgePoints=function(e){return this.digraph.edge(e._sourceVertex.id(),e._targetVertex.id(),e._id).points};var o={None:r,Circle:n,ForceDirected:i,Hierarchy:s};return o}),define("css!src/graph/Graph",[],function(){}),function(e,t){typeof define=="function"&&define.amd?define("src/graph/Graph",["d3","../common/SVGWidget","../common/Palette","../api/IGraph","./Vertex","./Edge","./GraphData","./GraphLayouts","../other/Bag","css!./Graph"],t):e.graph_Graph=t(e.d3,e.common_SVGWidget,e.common_Palette,e.api_IGraph,e.graph_Vertex,e.graph_Edge,e.graph_GraphData,e.graph_GraphLayouts,e.other_Bag)}(this,function(e,t,n,r,i,s,o,u,a){function f(){t.call(this),r.call(this),this.graphData=new o,this.highlight={zoom:1.1,opacity:.33,edge:"1.25px"},this._selection=new a.Selection}return f.prototype=Object.create(t.prototype),f.prototype.constructor=f,f.prototype._class+=" graph_Graph",f.prototype.implements(r.prototype),f.prototype.publish("allowDragging",!0,"boolean","Allow Dragging of Vertices",null,{tags:["Advanced"]}),f.prototype.publish("layout","Circle","set","Default Layout",["Circle","ForceDirected","ForceDirected2","Hierarchy","None"],{tags:["Basic"]}),f.prototype.publish("scale","100%","set","Zoom Level",["all","width","selection","100%","90%","75%","50%","25%","10%"],{tags:["Basic"]}),f.prototype.publish("applyScaleOnLayout",!1,"boolean","Shrink to fit on Layout",null,{tags:["Basic"]}),f.prototype.publish("highlightOnMouseOverVertex",!1,"boolean","Highlight Vertex on Mouse Over",null,{tags:["Basic"]}),f.prototype.publish("highlightOnMouseOverEdge",!1,"boolean","Highlight Edge on Mouse Over",null,{tags:["Basic"]}),f.prototype.publish("transitionDuration",250,"number","Transition Duration",null,{tags:["Intermediate"]}),f.prototype.publish("showEdges",!0,"boolean","Show Edges",null,{tags:["Intermediate"]}),f.prototype.publish("snapToGrid",0,"number","Snap to Grid",null,{tags:["Private"]}),f.prototype.publish("hierarchyRankDirection","TB","set","Direction for Rank Nodes",["TB","BT","LR","RL"],{tags:["Advanced"]}),f.prototype.publish("hierarchyNodeSeparation",50,"number","Number of pixels that separate nodes horizontally in the layout",null,{tags:["Advanced"]}),f.prototype.publish("hierarchyEdgeSeparation",10,"number","Number of pixels that separate edges horizontally in the layout",null,{tags:["Advanced"]}),f.prototype.publish("hierarchyRankSeparation",50,"number","Number of pixels between each rank in the layout",null,{tags:["Advanced"]}),f.prototype.getOffsetPos=function(){return{x:0,y:0}},f.prototype.size=function(e){var n=t.prototype.size.apply(this,arguments);return arguments.length&&this._svgZoom&&this._svgZoom.attr("x",-this._size.width/2).attr("y",-this._size.height/2).attr("width",this._size.width).attr("height",this._size.height),n},f.prototype.clear=function(){this.data({vertices:[],edges:[],hierarchy:[],merge:!1})},f.prototype.testData=function(){function u(e,t,n){return(new s).sourceVertex(e).targetVertex(t).sourceMarker("circleFoot").targetMarker("arrowHead").text(n||"")}var e={nodes:[{name:"Myriel",group:1},{name:"Napoleon",group:1},{name:"Mlle.Baptistine",group:1},{name:"Mme.Magloire",group:1},{name:"CountessdeLo",group:1},{name:"Geborand",group:1},{name:"Champtercier",group:1},{name:"Cravatte",group:1},{name:"Count",group:1},{name:"OldMan",group:1},{name:"Labarre",group:2},{name:"Valjean",group:2},{name:"Marguerite",group:3},{name:"Mme.deR",group:2},{name:"Isabeau",group:2},{name:"Gervais",group:2},{name:"Tholomyes",group:3},{name:"Listolier",group:3},{name:"Fameuil",group:3},{name:"Blacheville",group:3},{name:"Favourite",group:3},{name:"Dahlia",group:3},{name:"Zephine",group:3},{name:"Fantine",group:3},{name:"Mme.Thenardier",group:4},{name:"Thenardier",group:4},{name:"Cosette",group:5},{name:"Javert",group:4},{name:"Fauchelevent",group:0},{name:"Bamatabois",group:2},{name:"Perpetue",group:3},{name:"Simplice",group:2},{name:"Scaufflaire",group:2},{name:"Woman1",group:2},{name:"Judge",group:2},{name:"Champmathieu",group:2},{name:"Brevet",group:2},{name:"Chenildieu",group:2},{name:"Cochepaille",group:2},{name:"Pontmercy",group:4},{name:"Boulatruelle",group:6},{name:"Eponine",group:4},{name:"Anzelma",group:4},{name:"Woman2",group:5},{name:"MotherInnocent",group:0},{name:"Gribier",group:0},{name:"Jondrette",group:7},{name:"Mme.Burgon",group:7},{name:"Gavroche",group:8},{name:"Gillenormand",group:5},{name:"Magnon",group:5},{name:"Mlle.Gillenormand",group:5},{name:"Mme.Pontmercy",group:5},{name:"Mlle.Vaubois",group:5},{name:"Lt.Gillenormand",group:5},{name:"Marius",group:8},{name:"BaronessT",group:5},{name:"Mabeuf",group:8},{name:"Enjolras",group:8},{name:"Combeferre",group:8},{name:"Prouvaire",group:8},{name:"Feuilly",group:8},{name:"Courfeyrac",group:8},{name:"Bahorel",group:8},{name:"Bossuet",group:8},{name:"Joly",group:8},{name:"Grantaire",group:8},{name:"MotherPlutarch",group:9},{name:"Gueulemer",group:4},{name:"Babet",group:4},{name:"Claquesous",group:4},{name:"Montparnasse",group:4},{name:"Toussaint",group:5},{name:"Child1",group:10},{name:"Child2",group:10},{name:"Brujon",group:4},{name:"Mme.Hucheloup",group:8}],links:[{source:1,target:0,value:1},{source:2,target:0,value:8},{source:2,target:0,value:8},{source:3,target:0,value:10},{source:3,target:2,value:6},{source:4,target:0,value:1},{source:5,target:0,value:1},{source:6,target:0,value:1},{source:7,target:0,value:1},{source:8,target:0,value:2},{source:9,target:0,value:1},{source:11,target:10,value:1},{source:11,target:3,value:3},{source:11,target:2,value:3},{source:11,target:0,value:5},{source:12,target:11,value:1},{source:13,target:11,value:1},{source:14,target:11,value:1},{source:15,target:11,value:1},{source:17,target:16,value:4},{source:18,target:16,value:4},{source:18,target:17,value:4},{source:19,target:16,value:4},{source:19,target:17,value:4},{source:19,target:18,value:4},{source:20,target:16,value:3},{source:20,target:17,value:3},{source:20,target:18,value:3},{source:20,target:19,value:4},{source:21,target:16,value:3},{source:21,target:17,value:3},{source:21,target:18,value:3},{source:21,target:19,value:3},{source:21,target:20,value:5},{source:22,target:16,value:3},{source:22,target:17,value:3},{source:22,target:18,value:3},{source:22,target:19,value:3},{source:22,target:20,value:4},{source:22,target:21,value:4},{source:23,target:16,value:3},{source:23,target:17,value:3},{source:23,target:18,value:3},{source:23,target:19,value:3},{source:23,target:20,value:4},{source:23,target:21,value:4},{source:23,target:22,value:4},{source:23,target:12,value:2},{source:23,target:11,value:9},{source:24,target:23,value:2},{source:24,target:11,value:7},{source:25,target:24,value:13},{source:25,target:23,value:1},{source:25,target:11,value:12},{source:26,target:24,value:4},{source:26,target:11,value:31},{source:26,target:16,value:1},{source:26,target:25,value:1},{source:27,target:11,value:17},{source:27,target:23,value:5},{source:27,target:25,value:5},{source:27,target:24,value:1},{source:27,target:26,value:1},{source:28,target:11,value:8},{source:28,target:27,value:1},{source:29,target:23,value:1},{source:29,target:27,value:1},{source:29,target:11,value:2},{source:30,target:23,value:1},{source:31,target:30,value:2},{source:31,target:11,value:3},{source:31,target:23,value:2},{source:31,target:27,value:1},{source:32,target:11,value:1},{source:33,target:11,value:2},{source:33,target:27,value:1},{source:34,target:11,value:3},{source:34,target:29,value:2},{source:35,target:11,value:3},{source:35,target:34,value:3},{source:35,target:29,value:2},{source:36,target:34,value:2},{source:36,target:35,value:2},{source:36,target:11,value:2},{source:36,target:29,value:1},{source:37,target:34,value:2},{source:37,target:35,value:2},{source:37,target:36,value:2},{source:37,target:11,value:2},{source:37,target:29,value:1},{source:38,target:34,value:2},{source:38,target:35,value:2},{source:38,target:36,value:2},{source:38,target:37,value:2},{source:38,target:11,value:2},{source:38,target:29,value:1},{source:39,target:25,value:1},{source:40,target:25,value:1},{source:41,target:24,value:2},{source:41,target:25,value:3},{source:42,target:41,value:2},{source:42,target:25,value:2},{source:42,target:24,value:1},{source:43,target:11,value:3},{source:43,target:26,value:1},{source:43,target:27,value:1},{source:44,target:28,value:3},{source:44,target:11,value:1},{source:45,target:28,value:2},{source:47,target:46,value:1},{source:48,target:47,value:2},{source:48,target:25,value:1},{source:48,target:27,value:1},{source:48,target:11,value:1},{source:49,target:26,value:3},{source:49,target:11,value:2},{source:50,target:49,value:1},{source:50,target:24,value:1},{source:51,target:49,value:9},{source:51,target:26,value:2},{source:51,target:11,value:2},{source:52,target:51,value:1},{source:52,target:39,value:1},{source:53,target:51,value:1},{source:54,target:51,value:2},{source:54,target:49,value:1},{source:54,target:26,value:1},{source:55,target:51,value:6},{source:55,target:49,value:12},{source:55,target:39,value:1},{source:55,target:54,value:1},{source:55,target:26,value:21},{source:55,target:11,value:19},{source:55,target:16,value:1},{source:55,target:25,value:2},{source:55,target:41,value:5},{source:55,target:48,value:4},{source:56,target:49,value:1},{source:56,target:55,value:1},{source:57,target:55,value:1},{source:57,target:41,value:1},{source:57,target:48,value:1},{source:58,target:55,value:7},{source:58,target:48,value:7},{source:58,target:27,value:6},{source:58,target:57,value:1},{source:58,target:11,value:4},{source:59,target:58,value:15},{source:59,target:55,value:5},{source:59,target:48,value:6},{source:59,target:57,value:2},{source:60,target:48,value:1},{source:60,target:58,value:4},{source:60,target:59,value:2},{source:61,target:48,value:2},{source:61,target:58,value:6},{source:61,target:60,value:2},{source:61,target:59,value:5},{source:61,target:57,value:1},{source:61,target:55,value:1},{source:62,target:55,value:9},{source:62,target:58,value:17},{source:62,target:59,value:13},{source:62,target:48,value:7},{source:62,target:57,value:2},{source:62,target:41,value:1},{source:62,target:61,value:6},{source:62,target:60,value:3},{source:63,target:59,value:5},{source:63,target:48,value:5},{source:63,target:62,value:6},{source:63,target:57,value:2},{source:63,target:58,value:4},{source:63,target:61,value:3},{source:63,target:60,value:2},{source:63,target:55,value:1},{source:64,target:55,value:5},{source:64,target:62,value:12},{source:64,target:48,value:5},{source:64,target:63,value:4},{source:64,target:58,value:10},{source:64,target:61,value:6},{source:64,target:60,value:2},{source:64,target:59,value:9},{source:64,target:57,value:1},{source:64,target:11,value:1},{source:65,target:63,value:5},{source:65,target:64,value:7},{source:65,target:48,value:3},{source:65,target:62,value:5},{source:65,target:58,value:5},{source:65,target:61,value:5},{source:65,target:60,value:2},{source:65,target:59,value:5},{source:65,target:57,value:1},{source:65,target:55,value:2},{source:66,target:64,value:3},{source:66,target:58,value:3},{source:66,target:59,value:1},{source:66,target:62,value:2},{source:66,target:65,value:2},{source:66,target:48,value:1},{source:66,target:63,value:1},{source:66,target:61,value:1},{source:66,target:60,value:1},{source:67,target:57,value:3},{source:68,target:25,value:5},{source:68,target:11,value:1},{source:68,target:24,value:1},{source:68,target:27,value:1},{source:68,target:48,value:1},{source:68,target:41,value:1},{source:69,target:25,value:6},{source:69,target:68,value:6},{source:69,target:11,value:1},{source:69,target:24,value:1},{source:69,target:27,value:2},{source:69,target:48,value:1},{source:69,target:41,value:1},{source:70,target:25,value:4},{source:70,target:69,value:4},{source:70,target:68,value:4},{source:70,target:11,value:1},{source:70,target:24,value:1},{source:70,target:27,value:1},{source:70,target:41,value:1},{source:70,target:58,value:1},{source:71,target:27,value:1},{source:71,target:69,value:2},{source:71,target:68,value:2},{source:71,target:70,value:2},{source:71,target:11,value:1},{source:71,target:48,value:1},{source:71,target:41,value:1},{source:71,target:25,value:1},{source:72,target:26,value:2},{source:72,target:27,value:1},{source:72,target:11,value:1},{source:73,target:48,value:2},{source:74,target:48,value:2},{source:74,target:73,value:3},{source:75,target:69,value:3},{source:75,target:68,value:3},{source:75,target:25,value:3},{source:75,target:48,value:1},{source:75,target:41,value:1},{source:75,target:70,value:1},{source:75,target:71,value:1},{source:76,target:64,value:1},{source:76,target:65,value:1},{source:76,target:66,value:1},{source:76,target:63,value:1},{source:76,target:62,value:1},{source:76,target:48,value:1},{source:76,target:58,value:1}]},t=[],r=[],o=n.ordinal("dark2");return e.nodes.forEach(function(e){var n=[];Math.random()<.1&&n.push({faChar:"A",tooltip:"Test A",shape_colorFill:"white",image_colorFill:"red"}),Math.random()<.1&&n.push({faChar:"B",tooltip:"Test B",shape_colorFill:"green",shape_colorStroke:"green",image_colorFill:"white"}),Math.random()<.1&&n.push({faChar:"C",tooltip:"Test C",shape_colorFill:"navy",shape_colorStroke:"navy",image_colorFill:"white"}),t.push((new i).text(e.name).textbox_shape_colorStroke(o(e.group)).textbox_shape_colorFill("whitesmoke").icon_shape_colorStroke(o(e.group)).icon_shape_colorFill(o(e.group)).annotationIcons(n).faChar(e.name[0]))},this),e.links.forEach(function(e,n){r.push(u(t[e.source],t[e.target]).weight(e.value))},this),this.data({vertices:t,edges:r}),this},f.prototype.data=function(e){var n=t.prototype.data.apply(this,arguments);if(arguments.length){this._data.merge||(this.graphData=new o,this._renderCount=0);var r=this.graphData.setData(this._data.vertices,this._data.edges,this._data.hierarchy,this._data.merge),i=this;r.addedVertices.forEach(function(e){e.pos({x:+Math.random()*10/2-5,y:+Math.random()*10/2-5})}),r.addedEdges.forEach(function(e){e._sourceMarker&&(e._sourceMarker=i._id+"_"+e._sourceMarker),e._targetMarker&&(e._targetMarker=i._id+"_"+e._targetMarker)});var s={};this.graphData.edgeValues().forEach(function(e){s[e._sourceVertex._id]||(s[e._sourceVertex._id]={}),s[e._sourceVertex._id][e._targetVertex._id]||(s[e._sourceVertex._id][e._targetVertex._id]=0);var t=++s[e._sourceVertex._id][e._targetVertex._id];e.arcDepth(16*t)})}return n},f.prototype.selection=function(e){return arguments.length?(this._selection.set(e),this):this._selection.get()},f.prototype.setZoom=function(e,t,n){this.zoom&&(this.zoom.translate(e),this.zoom.scale(t),this.applyZoom(n))},f.prototype.applyZoom=function(t){e.event&&e.event.sourceEvent&&!e.event.sourceEvent.ctrlKey&&(e.event.sourceEvent.type==="wheel"||e.event.sourceEvent.type==="mousewheel"||e.event.sourceEvent.type==="DOMMouseScroll")&&e.event.sourceEvent.wheelDelta&&(this.zoom.translate([this.prevTranslate[0],this.prevTranslate[1]+e.event.sourceEvent.wheelDelta]),this.zoom.scale(this.prevScale)),(t?this.svg.transition().duration(t):this.svg).attr("transform","translate("+this.zoom.translate()+")scale("+this.zoom.scale()+")"),this.prevTranslate=this.zoom.translate(),this.prevScale!==this.zoom.scale()&&(this._fixIEMarkers(),this.prevScale=this.zoom.scale()),this.brush.x(e.scale.identity().domain([(-this.prevTranslate[0]-this._size.width/2)*1/this.zoom.scale(),(-this.prevTranslate[0]+this._size.width/2)*1/this.zoom.scale()])),this.brush.y(e.scale.identity().domain([(-this.prevTranslate[1]-this._size.height/2)*1/this.zoom.scale(),(-this.prevTranslate[1]+this._size.height/2)*1/this.zoom.scale()]))},f.prototype.enter=function(n,r){function s(t){if(i.allowDragging()){e.event.sourceEvent.stopPropagation(),i._dragging=!0;if(i.forceLayout){var n=i.forceLayout.vertexMap[t.id()];n.fixed=!0}i.svgMarkerGlitch&&i.graphData.nodeEdges(t.id()).forEach(function(e){var t=i.graphData.edge(e);i._pushMarkers(t.element(),t)})}}function o(t){if(i.allowDragging()){e.event.sourceEvent.stopPropagation(),t.move({x:e.event.x,y:e.event.y});if(i.forceLayout){var n=i.forceLayout.vertexMap[t.id()];n.fixed=!0,n.x=n.px=e.event.x,n.y=n.py=e.event.y}i.refreshIncidentEdges(t,!0)}}function u(t){if(i.allowDragging()){e.event.sourceEvent.stopPropagation(),i._dragging=!1;if(i.snapToGrid()){var n=t.calcSnap(i.snapToGrid());t.move(n[0]),i.refreshIncidentEdges(t,!0)}if(i.forceLayout){var r=i.forceLayout.vertexMap[t.id()];r.fixed=!1}i.svgMarkerGlitch&&i.graphData.nodeEdges(t.id()).forEach(function(e){var t=i.graphData.edge(e);i._popMarkers(t.element(),t)})}}t.prototype.enter.apply(this,arguments);var i=this;this.prevTranslate=[0,0],this.prevScale=1,this.zoom=e.behavior.zoom().scaleExtent([.01,4]).on("zoomstart",function(t){i.prevTranslate=i.zoom.translate(),i.prevScale=i.zoom.scale(),e.event.sourceEvent&&e.event.sourceEvent.shiftKey&&e.event.sourceEvent.ctrlKey?i._zoomMode="selection":e.event.sourceEvent&&e.event.sourceEvent.shiftKey?(i._zoomMode="selection",i._selection.clear()):i._zoomMode="zoom";switch(i._zoomMode){case"selection":r.select(".extent").style("visibility",null);break;default:r.select(".extent").style("visibility","hidden")}}).on("zoomend",function(e){switch(i._zoomMode){case"selection":i.zoom.translate(i.prevTranslate),i.zoom.scale(i.prevScale);break;default:}i._svgBrush.call(i.brush.clear())}).on("zoom",function(e){switch(i._zoomMode){case"selection":break;default:i.applyZoom()}}),this.brush=e.svg.brush().x(e.scale.identity().domain([-i._size.width/2,i._size.width/2])).y(e.scale.identity().domain([-i._size.height/2,i._size.height/2])).on("brushstart",function(e){switch(i._zoomMode){case"selection":break;default:}}).on("brushend",function(t){switch(i._zoomMode){case"selection":var n=e.event.target.extent();i.svgV.selectAll(".graphVertex").select("*").each(function(e){n[0][0]<=e.x()&&e.x()<n[1][0]&&n[0][1]<=e.y()&&e.y()<n[1][1]&&i._selection.append(e)}),i.graph_selection(i.selection());break;default:}}).on("brush",function(){switch(i._zoomMode){case"selection":var t=i.zoom.translate();console.log(t[0]);var n=e.event.target.extent();i.svgV.selectAll(".graphVertex").select("*").classed("selected",function(e){return i._selection.isSelected(e)||n[0][0]<=e.x()&&e.x()<n[1][0]&&n[0][1]<=e.y()&&e.y()<n[1][1]});break;default:}}),this.drag=e.behavior.drag().origin(function(e){return e.pos()}).on("dragstart",s).on("dragend",u).on("drag",o),this._svgZoom=r.append("rect").attr("class","zoom").attr("x",-this._size.width/2).attr("y",-this._size.height/2).attr("width",this._size.width).attr("height",this._size.height),this.defs=r.append("defs"),this.addMarkers(),r.call(this.zoom),this.svg=r.append("g"),this._svgBrush=this.svg.append("g").attr("class","selectionBrush").call(this.brush),this._svgBrush.select(".background").style("cursor",null),i._svgBrush.call(i.brush.clear()),this.svgC=this.svg.append("g").attr("id",this._id+"C"),this.svgE=this.svg.append("g").attr("id",this._id+"E"),this.svgV=this.svg.append("g").attr("id",this._id+"V")},f.prototype.getBounds=function(e,t){var n=[[null,null],[null,null]];return e.forEach(function(e){var r=t?t.nodePos(e._id):{x:e.x(),y:e.y(),width:e.width(),height:e.height()},i=r.x-r.width/2,s=r.x+r.width/2,o=r.y-r.height/2,u=r.y+r.height/2;if(n[0][0]===null||n[0][0]>i)n[0][0]=i;if(n[0][1]===null||n[0][1]>o)n[0][1]=o;if(n[1][0]===null||n[1][0]<s)n[1][0]=s;if(n[1][1]===null||n[1][1]<u)n[1][1]=u}),n},f.prototype.getVertexBounds=function(e){return this.getBounds(this.graphData.nodeValues(),e)},f.prototype.getSelectionBounds=function(e){return this.getBounds(this._selection.get(),e)},f.prototype.shrinkToFit=function(e,t){var n=this.width(),r=this.height(),i=e[1][0]-e[0][0],s=e[1][1]-e[0][1],o=(e[0][0]+e[1][0])/2,u=(e[0][1]+e[1][1])/2,a=1/Math.max(i/n,s/r);a>1&&(a=1);var f=[-a*o,-a*u];this.setZoom(f,a,t)},f.prototype._origScale=f.prototype.scale,f.prototype.scale=function(e,t){var n=f.prototype._origScale.apply(this,arguments);return arguments.length&&this.zoomTo(e,t),n},f.prototype.zoomTo=function(e,t){switch(e){case"all":this.shrinkToFit(this.getVertexBounds(),t);break;case"width":var n=this.getVertexBounds();n[0][1]=0,n[1][1]=0,this.shrinkToFit(n,t);break;case"selection":this.shrinkToFit(this._selection.isEmpty()?this.getVertexBounds():this.getSelectionBounds(),t);break;default:var r=parseInt(e);if(isNaN(r)||r<=0||r>200)r=100;this.zoom.scale(r/100),this.applyZoom(t)}},f.prototype.centerOn=function(e,t){var n=(e[0][0]+e[1][0])/2,r=(e[0][1]+e[1][1])/2,i=[n,r];this.setZoom(i,1,t)},f.prototype._origLayout=f.prototype.layout,f.prototype.layout=function(e,t){var n=f.prototype._origLayout.apply(this,arguments);if(arguments.length&&this._renderCount){this.forceLayout&&(this.forceLayout.force.stop(),this.forceLayout=null);var r=this,i=this.getLayoutEngine();if(this.layout()==="ForceDirected2")this.forceLayout=i,this.forceLayout.force.on("tick",function(e){i.vertices.forEach(function(e){var t=r.graphData.node(e.id);e.fixed?(e.x=e.px,e.y=e.py):(e.px=e.x,e.py=e.y,t.move({x:e.x,y:e.y}))}),r.graphData.edgeValues().forEach(function(e){e.points([],!1,!1)});if(r.applyScaleOnLayout()){var t=r.getVertexBounds(i);r.shrinkToFit(t)}}),this.forceLayout.force.start();else if(i){this.forceLayout=null,r._dragging=!0,r.graphData.nodeValues().forEach(function(e){var n=i.nodePos(e._id);e.move({x:n.x,y:n.y},t),n.width&&n.height&&!e.width()&&!e.height()&&e.width(n.width).height(n.height).render()}),r.graphData.edgeValues().forEach(function(e){var n=i.edgePoints(e);e.points(n,t)});if(r.applyScaleOnLayout()){var s=r.getVertexBounds(i);r.shrinkToFit(s,t)}this._fixIEMarkers(),setTimeout(function(){r._dragging=!1},t?t+50:50)}}return n},f.prototype.update=function(n,r){function o(e){e.target(this).render(),e.element().call(i.drag),e.dispatch&&(e.dispatch.on("sizestart",function(e,t){e.allowResize(i.allowDragging()),i.allowDragging()&&(i._dragging=!0)}),e.dispatch.on("size",function(e,t){i.refreshIncidentEdges(e,!1)}),e.dispatch.on("sizeend",function(e,t){i._dragging=!1;if(i.snapToGrid()){var n=e.calcSnap(i.snapToGrid());e.pos(n[0]).size(n[1]).render(),i.refreshIncidentEdges(e,!1)}}))}function a(e){e.target(this).render()}function f(e){e.render()}function l(e){e.render()}t.prototype.update.apply(this,arguments);var i=this,s=this.svgV.selectAll("#"+this._id+"V > .graphVertex").data(this.graphData.nodeValues(),function(e){return e.id()});s.enter().append("g").attr("class","graphVertex").style("opacity",1e-6).on("click.selectionBag",function(t){i._selection.click(t,e.event)}).on("click",function(t){i.vertex_click(t,e.event)}).on("dblclick",function(t){i.vertex_dblclick(t,e.event)}).on("mouseover",function(t){if(i._dragging)return;i.vertex_mouseover(e.select(this),t)}).on("mouseout",function(t){if(i._dragging)return;i.vertex_mouseout(e.select(this),t)}).each(o).transition().duration(750).style("opacity",1);var u=this.svgE.selectAll("#"+this._id+"E > .edge").data(this.showEdges()?this.graphData.edgeValues():[],function(e){return e.id()});u.enter().append("g").attr("class","edge").style("opacity",1e-6).on("click",function(e){i.edge_click(e)}).on("mouseover",function(t){if(i._dragging)return;i.edge_mouseover(e.select(this),t)}).on("mouseout",function(t){if(i._dragging)return;i.edge_mouseout(e.select(this),t)}).each(a).transition().duration(750).style("opacity",1),s.each(f),u.each(l),s.exit().each(function(e){e.target(null)}).remove(),u.exit().each(function(e){e.target(null)}).remove(),this._renderCount||(this._renderCount++,this.setZoom([0,0],1),this.layout(this.layout()))},f.prototype.getLayoutEngine=function(){switch(this.layout()){case"Circle":return new u.Circle(this.graphData,this._size.width,this._size.height);case"ForceDirected":return new u.ForceDirected(this.graphData,this._size.width,this._size.height,!0);case"ForceDirected2":return new u.ForceDirected(this.graphData,this._size.width,this._size.height);case"Hierarchy":return new u.Hierarchy(this.graphData,this._size.width,this._size.height,{rankdir:this.hierarchyRankDirection(),nodesep:this.hierarchyNodeSeparation(),edgesep:this.hierarchyEdgeSeparation(),ranksep:this.hierarchyRankSeparation()})}return null},f.prototype.getNeighborMap=function(e){var t={},n={};if(e){n=this.graphData.nodeEdges(e.id());for(var r=0;r<n.length;++r){var i=this.graphData.edge(n[r]);n[i.id()]=i,i._sourceVertex.id()!==e.id()&&(t[i._sourceVertex.id()]=i._sourceVertex),i._targetVertex.id()!==e.id()&&(t[i._targetVertex.id()]=i._targetVertex)}}return{vertices:t,edges:n}},f.prototype.highlightVerticies=function(e){var t=this,n=this.svgV.selectAll(".graphVertex");return n.transition().duration(this.transitionDuration()).each("end",function(t){e&&e[t.id()]&&t._parentElement.node()&&t._parentElement.node().parentNode&&t._parentElement.node().parentNode.appendChild(t._parentElement.node())}).style("opacity",function(n){return!e||e[n.id()]?1:t.highlight.opacity}),this},f.prototype.highlightEdges=function(e){var t=this,n=this.svgE.selectAll(".edge");return n.style("stroke-width",function(n){return e&&e[n.id()]?t.highlight.edge:"1px"}).transition().duration(this.transitionDuration()).style("opacity",function(n){return!e||e[n.id()]?1:t.highlight.opacity}),this},f.prototype.highlightVertex=function(e,t){if(this.highlightOnMouseOverVertex())if(t){var n=this.getNeighborMap(t);n.vertices[t.id()]=t,this.highlightVerticies(n.vertices),this.highlightEdges(n.edges)}else this.highlightVerticies(null),this.highlightEdges(null)},f.prototype.highlightEdge=function(e,t){if(this.highlightOnMouseOverEdge())if(t){var n={};n[t._sourceVertex.id()]=t._sourceVertex,n[t._targetVertex.id()]=t._targetVertex;var r={};r[t.id()]=t,this.highlightVerticies(n),this.highlightEdges(r)}else this.highlightVerticies(null),this.highlightEdges(null)},f.prototype.refreshIncidentEdges=function(e,t){var n=this;this.graphData.nodeEdges(e.id()).forEach(function(e){var r=n.graphData.edge(e);r.points([],!1,t)})},f.prototype.graph_selection=function(e){},f.prototype.vertex_click=function(e){e._parentElement.node().parentNode.appendChild(e._parentElement.node()),r.prototype.vertex_click.apply(this,arguments)},f.prototype.vertex_dblclick=function(e){},f.prototype.vertex_mouseover=function(e,t){this.highlightVertex(e,t)},f.prototype.vertex_mouseout=function(e,t){this.highlightVertex(null,null)},f.prototype.edge_mouseover=function(e,t){this.highlightEdge(e,t)},f.prototype.edge_mouseout=function(e,t){this.highlightEdge(null,null)},f.prototype.addMarkers=function(e){e&&(this.defs.select("#"+this._id+"_arrowHead").remove(),this.defs.select("#"+this._id+"_circleFoot").remove(),this.defs.select("#"+this._id+"_circleHead").remove()),this.defs.append("marker").attr("class","marker").attr("id",this._id+"_arrowHead").attr("viewBox","0 0 10 10").attr("refX",10).attr("refY",5).attr("markerWidth",8).attr("markerHeight",8).attr("markerUnits","strokeWidth").attr("orient","auto").append("polyline").attr("points","0,0 10,5 0,10 1,5"),this.defs.append("marker").attr("class","marker").attr("id",this._id+"_circleFoot").attr("viewBox","0 0 10 10").attr("refX",1).attr("refY",5).attr("markerWidth",7).attr("markerHeight",7).attr("markerUnits","strokeWidth").attr("orient","auto").append("circle").attr("cx",5).attr("cy",5).attr("r",4),this.defs.append("marker").attr("class","marker").attr("id",this._id+"_circleHead").attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerWidth",7).attr("markerHeight",7).attr("markerUnits","strokeWidth").attr("orient","auto").append("circle").attr("cx",5).attr("cy",5).attr("r",4)},f}),function(e){var t=document,n="appendChild",r="styleSheet",i=t.createElement("style");i.type="text/css",t.getElementsByTagName("head")[0][n](i),i[r]?i[r].cssText=e:i[n](t.createTextNode(e))}(".graph_Edge{fill:none;stroke:#656565;stroke-width:1px}.graph_Edge .common_TextBox .common_Text{fill:#000;stroke:none}.graph_Edge .common_TextBox .common_Shape{fill:none;stroke:none}.graph_Vertex{cursor:move}.graph_Graph .marker{fill:#656565;stroke:none;stroke-width:1px}.graph_Graph .zoom{fill:none;pointer-events:all}.graph_Graph .selectionBrush{fill:none;stroke:darkgray}.graph_Graph .graphVertex .graph_Vertex.selected .common_Shape{stroke:red!important}"),define("hpcc-viz-graph",function(){});
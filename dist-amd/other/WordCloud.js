(function(e,t){typeof define=="function"&&define.amd?define(["d3","../common/SVGWidget","./IWordCloud","require","css!./WordCloud"],t):e.other_WordCloud=t(e.d3,e.common_SVGWidget,e.other_IWordCloud,e.require)})(this,function(e,t,n,r){function i(){t.call(this),n.call(this)}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" other_WordCloud",i.prototype.implements(n.prototype),i.prototype.publish("padding",1,"number","Padding",null,{tags:["Intermediate"]}),i.prototype.publish("fontFamily","Verdana","string","Font Name",null,{tags:["Basic"]}),i.prototype.publish("fontSizeFrom",6,"number","Font Size From",null,{tags:["Basic"]}),i.prototype.publish("fontSizeTo",24,"number","Font Size To",null,{tags:["Basic"]}),i.prototype.publish("angleFrom",-60,"number","Angle From",null,{tags:["Basic"]}),i.prototype.publish("angleTo",60,"number","Angle To",null,{tags:["Basic"]}),i.prototype.publish("angleCount",5,"number","Angle Count",null,{tags:["Basic"]}),i.prototype.data=function(e){var n=t.prototype.data.apply(this,arguments);return arguments.length&&(this._vizData=e.map(function(e){var t={};for(var n in e)t["__viz_"+n]=e[n];return t})),n},i.prototype.enter=function(t,n){this.cloud=e.layout.cloud().font(this.fontFamily()).padding(this.padding()),this.svg=n.append("g")},i.prototype.update=function(t,n){function u(t,n){var i=e.scale.category20(),o=r.svg.selectAll("text").data(t,function(e){return e.__viz_0?e.__viz_0.toLowerCase():""});o.transition().duration(1e3).attr("transform",function(e){return"translate("+[e.x,e.y]+")rotate("+e.rotate+")"}).style("font-size",function(e){return s(e.__viz_1)+"px"}).style("opacity",1),o.enter().append("text").attr("text-anchor","middle").attr("transform",function(e){return"translate("+[e.x,e.y]+")rotate("+e.rotate+")"}).style("font-size",function(e){return s(e.__viz_1)+"px"}).style("font-family",function(e){return e.fontFamily}).style("fill",function(e){return i(e.__viz_0?e.__viz_0.toLowerCase():"")}).text(function(e){return e.__viz_0}).on("click",function(e){r.click({label:e.__viz_0,weight:e.__viz_1})}).style("opacity",1e-6).transition().duration(1e3).style("opacity",1),o.exit().transition().duration(1e3).style("opacity",1e-4).remove();if(n){var u=r.width(),a=r.height(),f=n[1].x-n[0].x,l=n[1].y-n[0].y,c=.9/Math.max(f/u,l/a);r.svg.transition().delay(1e3).duration(750).attr("transform","scale("+c+")")}}var r=this,i=e.extent(this._vizData,function(e){return e.__viz_1}),s=e.scale.log().domain(i).range([this.fontSizeFrom(),this.fontSizeTo()]),o=e.scale.linear().domain([0,r.angleCount()-1]).range([r.angleFrom(),r.angleTo()]);this.cloud.size([this.width(),this.height()]).words(this._vizData).rotate(function(){return o(~~(Math.random()*r.angleCount()))}).fontSize(function(e){return s(e.__viz_1)}).on("end",u).start()},i.prototype.render=function(e){var n=this;return r(["d3.layout.cloud"],function(r){t.prototype.render.call(n,e)}),this},i});
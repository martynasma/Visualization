define("css!src/layout/AbsoluteSurface",[],function(){}),function(e,t){typeof define=="function"&&define.amd?define("src/layout/AbsoluteSurface",["d3","../common/HTMLWidget","../chart/MultiChart","css!./AbsoluteSurface","css!font-awesome"],t):e.layout_AbsoluteSurface=t(e.d3,e.common_HTMLWidget,e.chart_MultiChart)}(this,function(e,t,n){function r(){t.call(this),this._tag="div"}return r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype._class+=" layout_AbsoluteSurface",r.prototype.publish("units","percent","set","Units",["pixels","percent"]),r.prototype.publish("x",0,"number","Widget XPos"),r.prototype.publish("y",0,"number","Widget YPos"),r.prototype.publish("width","100","string","Widget Width, omit for full"),r.prototype.publish("height","100","string","Widget Height, omit for full"),r.prototype.publish("opacity",1,"number","Opacity"),r.prototype.publish("widget",null,"widget","Widget",null,{tags:["Private"]}),r.prototype.testData=function(){return this.x(25).y(25).width(50).height(50).widget((new n).testData().chartType("COLUMN")),this},r.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments)},r.prototype.update=function(e,n){t.prototype.update.apply(this,arguments);var r=0,i=0,s=this.clientWidth(),o=this.clientHeight();switch(this.units()){case"pixels":r=this.x(),i=this.y(),s=this.width()===""?s-r:Number(this.width()),o=this.height()===""?o-i:Number(this.height());break;case"percent":r=this.x()*s/100,i=this.y()*o/100,s=this.width()===""?s-r:Number(this.width()*s/100),o=this.height()===""?o-i:Number(this.height()*o/100)}this.pos({x:r,y:i}),n.style("opacity",this.opacity());var u=n.selectAll("#"+this._id+" > .AbsoluteSurfaceWidget").data(this.widget()?[this.widget()]:[],function(e){return e._id});u.enter().append("div").attr("class","AbsoluteSurfaceWidget").each(function(e){e.target(this)}),u.each(function(e){e.resize({width:s,height:o})}),u.exit().each(function(e){e.target(null)}).remove()},r.prototype.exit=function(e,n){this.widget()&&(this.widget(null),this.render()),t.prototype.exit.apply(this,arguments)},r.prototype.render=function(e){var n=this;return t.prototype.render.call(this,function(t){n.widget()?n.widget().render(function(t){e&&e(t)}):e&&e(t)})},r}),define("css!src/layout/Surface",[],function(){}),function(e,t){typeof define=="function"&&define.amd?define("src/layout/Surface",["d3","../common/HTMLWidget","../chart/MultiChart","css!./Surface","css!font-awesome"],t):e.layout_Surface=t(e.d3,e.common_HTMLWidget,e.chart_MultiChart)}(this,function(e,t,n){function r(){t.call(this),this._tag="div",this._surfaceButtons=[]}return r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype._class+=" layout_Surface",r.prototype.publish("surfaceTitlePadding",null,"number","Title Padding (px)",null,{tags:["Basic"]}),r.prototype.publish("surfaceTitleFontSize",null,"number","Title Font Size (px)",null,{tags:["Basic"]}),r.prototype.publish("surfaceTitleFontColor",null,"html-color","Title Font Color",null,{tags:["Basic"]}),r.prototype.publish("surfaceTitleFontFamily",null,"string","Title Font Family",null,{tags:["Basic"]}),r.prototype.publish("surfaceTitleFontBold",!0,"boolean","Enable Bold Title Font",null,{tags:["Basic"]}),r.prototype.publish("surfaceTitleBackgroundColor",null,"html-color","Title Background Color",null,{tags:["Basic"]}),r.prototype.publish("surfacePadding",null,"string","Surface Padding (px)",null,{tags:["Intermediate"]}),r.prototype.publish("surfaceBackgroundColor",null,"html-color","Surface Background Color",null,{tags:["Basic"]}),r.prototype.publish("surfaceBorderWidth",null,"number","Surface Border Width (px)",null,{tags:["Basic"]}),r.prototype.publish("surfaceBorderColor",null,"html-color","Surface Border Color",null,{tags:["Basic"]}),r.prototype.publish("surfaceBorderRadius",null,"number","Surface Border Radius (px)",null,{tags:["Basic"]}),r.prototype.publish("title","","string","Title",null,{tags:["Intermediate"]}),r.prototype.publish("surfaceTitleAlignment","center","set","Title Alignment",["left","right","center"],{tags:["Basic"]}),r.prototype.publish("widget",null,"widget","Widget",null,{tags:["Private"]}),r.prototype.publish("buttonAnnotations",[],"array","Button Array",null,{tags:["Private"]}),r.prototype.testData=function(){return this.title("ABC"),this.widget((new r).widget((new n).testData())),this.buttonAnnotations([{id:"button_1",label:"",width:60,padding:"5px","class":"",font:"FontAwesome",callback:function(e){console.log("Click Override on button "+e)}},{id:"button_2",label:"",width:30,padding:"5px","class":"",font:"FontAwesome",callback:function(e){console.log("Click Override on button "+e)}}]),this},r.prototype.widgetSize=function(e,t){var n=this.clientWidth(),r=this.clientHeight();return this.title()&&(r-=this.calcHeight(e)),r-=this.calcFrameHeight(t),n-=this.calcFrameWidth(t),{width:n,height:r}},r.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments)},r.prototype.update=function(n,r){t.prototype.update.apply(this,arguments);var i=this;r.style("border-width",this.surfaceBorderWidth()+"px").style("border-color",this.surfaceBorderColor()).style("border-radius",this.surfaceBorderRadius()+"px").style("background-color",this.surfaceBackgroundColor());var s=r.selectAll(".surfaceTitle").data(this.title()?[this.title()]:[]);s.enter().insert("h3","div").attr("class","surfaceTitle"),s.text(function(e){return e}).style("text-align",this.surfaceTitleAlignment()).style("color",this.surfaceTitleFontColor()).style("font-size",this.surfaceTitleFontSize()+"px").style("font-family",this.surfaceTitleFontFamily()).style("font-weight",this.surfaceTitleFontBold()?"bold":"normal").style("background-color",this.surfaceTitleBackgroundColor()).style("padding",this.surfaceTitlePadding()+"px"),s.exit().remove();var o=r.select(".surfaceTitle"),u=o.append("div").attr("class","html-button-container").selectAll(".surface-button").data(this.buttonAnnotations());u.enter().append("button").classed("surface-button",!0).each(function(t,n){var r=i._surfaceButtons[n]=e.select(this).attr("class","surface-button "+t.class).attr("id",t.id).style("padding",t.padding).style("width",t.width).style("height",t.height).style("cursor","pointer");t.font==="FontAwesome"?r.append("i").attr("class","fa").text(function(e){return t.label}).on("click",function(e){i.click(e)}):r.text(function(e){return t.label}).on("click",function(e){i.click(e)})}),u.exit().each(function(t,n){var r=e.select(this);delete i._surfaceButtons[n],r.remove()});var a=r.selectAll("#"+this._id+" > .surfaceWidget").data(this.widget()?[this.widget()]:[],function(e){return e._id});a.enter().append("div").attr("class","surfaceWidget").each(function(e){e.target(this)}),a.style("padding",this.surfacePadding()?this.surfacePadding()+"px":null).each(function(t){var n=i.widgetSize(r.select("h3"),e.select(this));t.resize({width:n.width,height:n.height})}),a.exit().each(function(e){e.target(null)}).remove()},r.prototype.exit=function(e,n){this.widget()&&(this.widget(null),this.render()),t.prototype.exit.apply(this,arguments)},r.prototype.render=function(e){var n=this;return t.prototype.render.call(this,function(t){n.widget()?n.widget().render(function(t){e&&e(t)}):e&&e(t)})},r.prototype.click=function(e){console.log("Clicked: "+e.id)},r}),function(e,t){typeof define=="function"&&define.amd?define("src/layout/Cell",["./Surface"],t):e.layout_Cell=t(e.layout_Surface)}(this,function(e){function t(){e.call(this),this._dragHandles=["nw","n","ne","e","se","s","sw","w"]}return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.prototype._class+=" layout_Cell",t.prototype.publish("gridRow",0,"number","Grid Row Position",null,{tags:["Private"]}),t.prototype.publish("gridCol",0,"number","Grid Column Position",null,{tags:["Private"]}),t.prototype.publish("gridRowSpan",1,"number","Grid Row Span",null,{tags:["Private"]}),t.prototype.publish("gridColSpan",1,"number","Grid Column Span",null,{tags:["Private"]}),t.prototype.publish("handleSize",6,"number","Grid Row Position",null,{tags:["Private"]}),t.prototype.enter=function(t,n){e.prototype.enter.apply(this,arguments),n.classed("layout_Surface",!0)},t.prototype.update=function(t,n){e.prototype.update.apply(this,arguments);var r=this,i,s=n.selectAll(".dragHandle").data(this._dragHandles,function(e){return e});s.enter().append("div").attr("class",function(e){return"dragHandle dragHandle_"+e}).style("position","absolute"),s.style({padding:"0px",margin:"0px",left:function(e){switch(e){case"ne":case"e":case"se":return r._size.width-r.handleSize()+"px";case"nw":case"w":case"sw":return"0px";case"n":return i=0,r._dragHandles.indexOf("nw")!==-1&&i++,r.handleSize()*i+"px";case"s":return i=0,r._dragHandles.indexOf("sw")!==-1&&i++,r.handleSize()*i+"px"}},top:function(e){switch(e){case"nw":case"n":case"ne":return"0px";case"e":return i=0,r._dragHandles.indexOf("ne")!==-1&&i++,r.handleSize()*i+"px";case"w":return i=0,r._dragHandles.indexOf("nw")!==-1&&i++,r.handleSize()*i+"px";case"sw":case"s":case"se":return r._size.height-r.handleSize()+"px"}},width:function(e){switch(e){case"n":return i=0,r._dragHandles.indexOf("ne")!==-1&&i++,r._dragHandles.indexOf("nw")!==-1&&i++,r._size.width-r.handleSize()*i+"px";case"s":return i=0,r._dragHandles.indexOf("se")!==-1&&i++,r._dragHandles.indexOf("sw")!==-1&&i++,r._size.width-r.handleSize()*i+"px";default:return r.handleSize()+"px"}},height:function(e){switch(e){case"w":return i=0,r._dragHandles.indexOf("nw")!==-1&&i++,r._dragHandles.indexOf("sw")!==-1&&i++,r._size.height-r.handleSize()*i+"px";case"e":return i=0,r._dragHandles.indexOf("ne")!==-1&&i++,r._dragHandles.indexOf("se")!==-1&&i++,r._size.height-r.handleSize()*i+"px";default:return r.handleSize()+"px"}}}),s.exit().remove()},t}),define("css!src/layout/Border",[],function(){}),function(e,t){typeof define=="function"&&define.amd?define("src/layout/Border",["d3","../common/HTMLWidget","./Cell","../common/Text","css!./Border"],t):e.layout_Grid=t(e.d3,e.common_HTMLWidget,e.layout_Cell,e.common_Text,e.chart_Pie,e.chart_MultiChart,e.c3chart_Line)}(this,function(e,t,n,r){function i(){t.call(this),this._tag="div",this._colCount=0,this._rowCount=0,this._colSize=0,this._rowSize=0,this.content([])}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" layout_Border",i.prototype.publish("gutter",4,"number","Gap Between Widgets",null,{tags:["Private"]}),i.prototype.publish("designMode",!1,"boolean","Design Mode",null,{tags:["Private"]}),i.prototype.publish("layoutType","Default","set","This determines the placement/size of the Cells relative to the Border._target element",["Default"],{tags:["Private"]}),i.prototype.publish("topCellSize",100,"number","Height of the 'Top' Cell (px)",null,{tags:["Private"]}),i.prototype.publish("leftCellSize",150,"number","Width of the 'Left' Cell (px)",null,{tags:["Private"]}),i.prototype.publish("rightCellSize",250,"number","Width of the 'Right' Cell (px)",null,{tags:["Private"]}),i.prototype.publish("bottomCellSize",80,"number","Height of the 'Bottom' Cell (px)",null,{tags:["Private"]}),i.prototype.publish("topCellPercentage",0,"number","Percentage (of parent) Height of the 'Top' Cell",null,{tags:["Private"]}),i.prototype.publish("leftCellPercentage",0,"number","Percentage (of parent) Width of the 'Left' Cell",null,{tags:["Private"]}),i.prototype.publish("rightCellPercentage",0,"number","Percentage (of parent) Width of the 'Right' Cell",null,{tags:["Private"]}),i.prototype.publish("bottomCellPercentage",0,"number","Percentage (of parent) Height of the 'Bottom' Cell",null,{tags:["Private"]}),i.prototype.publish("cellPadding","0px","string","Cell Padding (px)",null,{tags:["Intermediate"]}),i.prototype.publish("content",[],"widgetArray","widgets",null,{tags:["Private"]}),i.prototype.publish("sectionTypes",[],"array","Section Types sharing an index with 'content' - Used to determine position/size.",null,{tags:["Private"]}),i.prototype.testData=function(){return this.setContent("topSection",(new r).testData()).setContent("rightSection",(new r).testData()).setContent("bottomSection",(new r).testData()).setContent("leftSection",(new r).testData()).setContent("centerSection",(new r).testData()),this},i.prototype.applyLayoutType=function(e){var t=this.borderLayoutObject(e);for(var n in this.content())this.content()[n]._fixedLeft=t[this.sectionTypes()[n]].left,this.content()[n]._fixedTop=t[this.sectionTypes()[n]].top,this.content()[n]._fixedWidth=t[this.sectionTypes()[n]].width,this.content()[n]._fixedHeight=t[this.sectionTypes()[n]].height,this.content()[n]._dragHandles=this.cellSpecificDragHandles(this.sectionTypes()[n])},i.prototype.cellSpecificDragHandles=function(e){switch(this.layoutType()){default:switch(e){case"topSection":return["s"];case"rightSection":return["w"];case"bottomSection":return["n"];case"leftSection":return["e"];case"centerSection":return[]}}},i.prototype.borderLayoutObject=function(e){function g(e){e.width.px=typeof e.width.px!="undefined"?e.width.px:0,e.width["%"]=typeof e.width["%"]!="undefined"?e.width["%"]:0,e.height.px=typeof e.height.px!="undefined"?e.height.px:0,e.height["%"]=typeof e.height["%"]!="undefined"?e.height["%"]:0;var t={width:e.width.px+e.width["%"]/100*m.width,height:e.height.px+e.height["%"]/100*m.height,top:e.top.px+e.top["%"]/100*m.height+u.gutter()/2,left:e.left.px+e.left["%"]/100*m.width+u.gutter()/2};return t}var t,n,r,i,s,o={},u=this,a,f,l,c,h,p,d,v,m=this.target().getBoundingClientRect();switch(e){default:this.sectionTypes().indexOf("topSection")!==-1&&(a=this.topCellSize(),f=this.topCellPercentage()),this.sectionTypes().indexOf("bottomSection")!==-1&&(l=this.bottomCellSize(),c=this.bottomCellPercentage()),this.sectionTypes().indexOf("leftSection")!==-1&&(h=this.leftCellSize(),p=this.leftCellPercentage()),this.sectionTypes().indexOf("rightSection")!==-1&&(d=this.rightCellSize(),v=this.rightCellPercentage()),t=g({width:{px:0,"%":100},height:{px:a,"%":f},top:{px:0,"%":0},left:{px:0,"%":0}}),n=g({width:{px:0,"%":100},height:{px:l,"%":c},top:{px:0,"%":100},left:{px:0,"%":0}}),n.top-=n.height,i=g({width:{px:h,"%":p},height:{px:-t.height-n.height,"%":100},top:{px:t.height,"%":0},left:{px:0,"%":0}}),r=g({width:{px:d,"%":v},height:{px:-t.height-n.height,"%":100},top:{px:t.height,"%":0},left:{px:0,"%":100}}),r.left-=r.width,s=g({width:{px:-r.width-i.width,"%":100},height:{px:-t.height-n.height,"%":100},top:{px:t.height,"%":0},left:{px:i.width,"%":0}}),o.topSection=t,o.bottomSection=n,o.rightSection=r,o.leftSection=i,o.centerSection=s}return o},i.prototype.clearContent=function(){this.content(this.content().filter(function(e){return e.target(null),!1})),this.sectionTypes([])},i.prototype.setContent=function(e,t,r){r=typeof r!="undefined"?r:"";var i=this.sectionTypes();if(t){var s=(new n).widget(t).title(r);this.content().push(s),i.push(e)}return this.sectionTypes(i),this},i.prototype.getContent=function(e){var t=null;return this.content().some(function(n){return n.widget()._id===e?(t=n.widget(),!0):!1}),t},i.prototype.getCellSize=function(e){switch(this.sectionTypes()[e]){case"topSection":return this.topCellSize();case"rightSection":return this.rightCellSize();case"bottomSection":return this.bottomCellSize();case"leftSection":return this.leftCellSize()}},i.prototype.changeCellSize=function(e,t){switch(this.sectionTypes()[e]){case"topSection":this.topCellSize(this.topCellSize()+t);break;case"rightSection":this.rightCellSize(this.rightCellSize()+t);break;case"bottomSection":this.bottomCellSize(this.bottomCellSize()+t);break;case"leftSection":this.leftCellSize(this.leftCellSize()+t);break;case"centerSection":this.centerCellSize(this.centerCellSize()+t)}},i.prototype.overHandle=function(e){var t="",n=this._dragCell.handleSize(),r=this._offsetY+this._dragCell._fixedTop-this.gutter()/2,i=this._offsetX+this._dragCell._fixedLeft-this.gutter()/2,s=this._dragCell._fixedWidth,o=this._dragCell._fixedHeight;return Math.ceil(r+o-this.gutter())>=e.clientY&&Math.floor(r+o-n-this.gutter())<=e.clientY?t="s":Math.floor(r)<=e.clientY&&Math.ceil(r+n)>=e.clientY&&(t="n"),Math.ceil(i+s-this.gutter())>=e.clientX&&Math.floor(i+s-n-this.gutter())<=e.clientX?t+="e":Math.floor(i)<=e.clientX&&Math.ceil(i+n)>=e.clientX&&(t+="w"),t},i.prototype.setLayoutOffsets=function(){this._offsetX=this._element.node().getBoundingClientRect().left+this.gutter()/2,this._offsetY=this._element.node().getBoundingClientRect().top+this.gutter()/2},i.prototype.dragStart=function(t,n){e.event.sourceEvent.stopPropagation();var r=this;this._dragCell=t,this._dragCellStartSize=this.getCellSize(n),r._handle=r.overHandle(e.event.sourceEvent),r._dragCell._dragHandles.indexOf(r._handle)===-1&&(r._handle=undefined),this._dragPrevX=e.event.sourceEvent.clientX,this._dragPrevY=e.event.sourceEvent.clientY},i.prototype.dragTick=function(t,n){if(this._handle){var r=this._dragPrevX-e.event.sourceEvent.clientX,i=this._dragPrevY-e.event.sourceEvent.clientY;switch(this._sectionTypeArr[n]){case"topSection":i!==0&&this.changeCellSize(n,-i);break;case"rightSection":r!==0&&this.changeCellSize(n,r);break;case"bottomSection":i!==0&&this.changeCellSize(n,i);break;case"leftSection":r!==0&&this.changeCellSize(n,-r);break;case"centerSection":}this._dragPrevX=e.event.sourceEvent.clientX,this._dragPrevY=e.event.sourceEvent.clientY}this.render()},i.prototype.dragEnd=function(e){this.render()},i.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments),n.style("position","relative"),this.dropDiv=n.append("div"),this.contentDiv=n.append("div"),this._scrollBarWidth=this.getScrollbarWidth()},i.prototype.update=function(n,r){t.prototype.update.apply(this,arguments),this._sectionTypeArr=this.sectionTypes();var i=this;this.setLayoutOffsets();var s=this.contentDiv.selectAll(".cell_"+this._id).data(this.content(),function(e){return e._id});s.enter().append("div").attr("class","cell_"+this._id).style("position","absolute").each(function(e){e.target(this)});var o=e.behavior.drag().on("dragstart",function(e,t){i.dragStart.call(i,e,t)}).on("drag",function(e,t){i.dragTick.call(i,e,t)}).on("dragend",function(e,t){i.dragEnd.call(i,e,t)});this.designMode()?this.contentDiv.selectAll(".cell_"+this._id).call(o):this.contentDiv.selectAll(".cell_"+this._id).on(".drag",null),this.applyLayoutType(this.layoutType()),s.style("left",function(e){return e._fixedLeft+"px"}).style("top",function(e){return e._fixedTop+"px"}).style("width",function(e){return e._fixedWidth-i.gutter()+"px"}).style("height",function(e){return e._fixedHeight-i.gutter()+"px"}).each(function(e){e._parentElement.attr("draggable",i.designMode()).selectAll(".dragHandle").attr("draggable",i.designMode()),e.surfacePadding(i.cellPadding()).resize()}),s.exit().each(function(e){e.target(null)}).remove()},i.prototype.exit=function(e,n){t.prototype.exit.apply(this,arguments)},i.prototype.render=function(e){var n=this;return t.prototype.render.call(this,function(t){if(n.content().length){var r=n.content().length;n.content().forEach(function(n,i){setTimeout(function(){n.render(function(){--r===0&&e&&e(t)})},0)})}else e&&e(t)}),this},i}),define("css!src/layout/Grid",[],function(){}),function(e,t){typeof define=="function"&&define.amd?define("src/layout/Grid",["d3","../common/HTMLWidget","./Cell","../common/Text","../chart/Pie","../chart/MultiChart","../c3chart/Line","css!./Grid"],t):e.layout_Grid=t(e.d3,e.common_HTMLWidget,e.layout_Cell,e.common_Text,e.chart_Pie,e.chart_MultiChart,e.c3chart_Line)}(this,function(e,t,n,r,i,s,o){function u(){t.call(this),this._tag="div",this._colCount=0,this._rowCount=0,this._colSize=0,this._rowSize=0,this.content([])}return u.prototype=Object.create(t.prototype),u.prototype.constructor=u,u.prototype._class+=" layout_Grid",u.prototype.publish("designMode",!1,"boolean","Design Mode",null,{tags:["Private"]}),u.prototype.publish("gutter",4,"number","Gap Between Widgets",null,{tags:["Private"]}),u.prototype.publish("fitTo","all","set","Sizing Strategy",["all","width"],{tags:["Private"]}),u.prototype.publish("cellPadding",null,"string","Cell Padding (px)",null,{tags:["Intermediate"]}),u.prototype.publish("content",[],"widgetArray","widgets",null,{tags:["Private"]}),u.prototype.testData=function(){return this.setContent(0,0,(new i).testData()).setContent(0,1,(new i).testData()).setContent(1,0,(new i).testData()).setContent(1,1,(new i).testData()).setContent(0,2,(new s).testData(),"Title AAA",2,2).setContent(2,0,(new o).testData(),"Title BBB",2,4),this},u.prototype.getDimensions=function(){var e={width:0,height:0};return this.content().forEach(function(t){e.width<t.gridCol()+t.gridColSpan()&&(e.width=t.gridCol()+t.gridColSpan()),e.height<t.gridRow()+t.gridRowSpan()&&(e.height=t.gridRow()+t.gridRowSpan())},this),e},u.prototype.clearContent=function(){this.content(this.content().filter(function(e){return e.target(null),!1}))},u.prototype.setContent=function(e,t,r,i,s,o){s=s||1,o=o||1,i=i||"",this.content(this.content().filter(function(n){return n.gridRow()===e&&n.gridCol()===t?(n.target(null),!1):!0}));if(r){var u=(new n).gridRow(e).gridCol(t).widget(r).title(i).gridRowSpan(s).gridColSpan(o);this.content().push(u)}return this},u.prototype.getCell=function(e,t){var n=null;return this.content().some(function(r){return e>=r.gridRow()&&e<r.gridRow()+r.gridRowSpan()&&t>=r.gridCol()&&t<r.gridCol()+r.gridColSpan()?(n=r,!0):!1}),n},u.prototype.getContent=function(e){var t=null;return this.content().some(function(n){return n.widget()._id===e?(t=n.widget(),!0):!1}),t},u.prototype.childMoved=u.prototype.debounce(function(e,t){this.render()},250),u.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments),n.style("position","relative"),this.dropDiv=n.append("div"),this.contentDiv=n.append("div"),this._scrollBarWidth=this.getScrollbarWidth()},u.prototype.findCurrentLocation=function(e){this._currLoc=[Math.floor((e.clientX-this._offsetX)/this._colSize),Math.floor((e.clientY-this._offsetY)/this._rowSize)]},u.prototype.overHandle=function(e){var t="",n=this._dragCell.handleSize(),r=this._dragCell.gridRowSpan()===this._currLoc[1]-this._dragCell.gridRow()+1,i=this._dragCell.gridRow()===this._currLoc[1],s=this._dragCell.gridColSpan()===this._currLoc[0]-this._dragCell.gridCol()+1,o=this._dragCell.gridCol()===this._currLoc[0],u=this._offsetY+this._currLoc[1]*this._rowSize,a=this._offsetX+this._currLoc[0]*this._colSize,f=this._colSize-this.gutter(),l=this._rowSize-this.gutter();return Math.ceil(u+l)>=e.clientY&&Math.floor(u+l-n)<=e.clientY&&r?t="s":Math.floor(u)<=e.clientY&&Math.ceil(u+n)>=e.clientY&&i&&(t="n"),Math.ceil(a+f)>=e.clientX&&Math.floor(a+f-n)<=e.clientX&&s?t+="e":Math.floor(a)<=e.clientX&&Math.ceil(a+n)>=e.clientX&&o&&(t+="w"),t},u.prototype.createDropTarget=function(e){var t=e[0]-this._dragCellOffsetX,n=e[1]-this._dragCellOffsetY,r=this._dragCell.gridColSpan(),i=this._dragCell.gridRowSpan(),s=document.createElement("div");s.id="grid-drop-target"+this.id(),s.className="grid-drop-target",this._element.node().appendChild(s),this.updateDropTarget(t,n,r,i)},u.prototype.setGridOffsets=function(){this._offsetX=this._element.node().getBoundingClientRect().left+this.gutter()/2,this._offsetY=this._element.node().getBoundingClientRect().top+this.gutter()/2},u.prototype.updateDropTarget=function(e,t,n,r){var i,s,o,u;i=this._offsetY+t*this._rowSize,s=this._offsetX+e*this._colSize,o=n*this._colSize-this.gutter(),u=r*this._rowSize-this.gutter();var a=document.getElementById("grid-drop-target"+this.id());a.style.top=i+"px",a.style.left=s+"px",a.style.width=o+"px",a.style.height=u+"px"},u.prototype.moveDropTarget=function(e){if(this._handle){var t=[];switch(this._handle){case"nw":t=[this._dragCell.gridCol()+this._dragCell.gridColSpan()-1,this._dragCell.gridRow()+this._dragCell.gridRowSpan()-1];break;case"n":case"ne":t=[this._dragCell.gridCol(),this._dragCell.gridRow()+this._dragCell.gridRowSpan()-1];break;case"e":case"se":case"s":t=[this._dragCell.gridCol(),this._dragCell.gridRow()];break;case"sw":case"w":t=[this._dragCell.gridCol()+this._dragCell.gridColSpan()-1,this._dragCell.gridRow()]}switch(this._handle){case"e":case"w":this._locY=t[1];break;default:this._locY=e[1]<=t[1]?e[1]:t[1]}switch(this._handle){case"n":case"s":this._locX=t[0];break;default:this._locX=e[0]<=t[0]?e[0]:t[0]}switch(this._handle){case"n":case"s":this._sizeX=this._dragCell.gridColSpan();break;default:this._sizeX=Math.abs(e[0]-t[0])+1}switch(this._handle){case"e":case"w":this._sizeY=this._dragCell.gridRowSpan();break;default:this._sizeY=Math.abs(e[1]-t[1])+1}}else if(document.getElementById("grid-drop-target"+this.id())!==null){var n=this.getCell(e[1],e[0]);n!==null&&this._dragCell._id!==n._id?(document.getElementById("grid-drop-target"+this.id()).className="grid-drop-target drop-target-over",this._locX=n.gridCol(),this._locY=n.gridRow(),this._sizeX=n.gridColSpan(),this._sizeY=n.gridRowSpan()):(document.getElementById("grid-drop-target"+this.id()).className="grid-drop-target",this._locX=e[0]-this._dragCellOffsetX,this._locY=e[1]-this._dragCellOffsetY,this._sizeX=this._dragCell.gridColSpan(),this._sizeY=this._dragCell.gridRowSpan())}this.updateDropTarget(this._locX,this._locY,this._sizeX,this._sizeY)},u.prototype.updateCells=function(t,n){var r=this,i=this.contentDiv.selectAll(".cell_"+this._id).data(this.content(),function(e){return e._id});i.enter().append("div").attr("class","cell_"+this._id).style("position","absolute").each(function(e){e.target(this),e.__grid_watch=e.watch(function(e,t,n){r._renderCount&&e.indexOf("grid")===0&&t!==n&&r.childMoved()})});var s=e.behavior.drag().on("dragstart",function(t){e.event.sourceEvent.stopPropagation(),r._dragCell=t,r.setGridOffsets(),r.findCurrentLocation(e.event.sourceEvent),r._element.selectAll(".dragHandle").style("visibility","hidden"),r._handle=r.overHandle(e.event.sourceEvent),r._dragCell._dragHandles.indexOf(r._handle)===-1&&(r._handle=undefined),r._dragCellOffsetX=r._currLoc[0]-t.gridCol(),r._dragCellOffsetY=r._currLoc[1]-t.gridRow(),r.createDropTarget(r._currLoc),setTimeout(function(){r.contentDiv.selectAll(".cell_"+r._id).classed("dragItem",function(e){return t._id===e._id}).classed("notDragItem",function(e){return t._id!==e._id})},0)}).on("drag",function(t){r._dragCell=t,r.findCurrentLocation(e.event.sourceEvent);if(typeof r._currLocation=="undefined"||r._currLocation[0]!==r._currLoc[0]||r._currLocation[1]!==r._currLoc[1])r._currLocation=r._currLoc,r.moveDropTarget(r._currLoc)}).on("dragend",function(){e.event.sourceEvent.stopPropagation(),r._element.selectAll(".dragHandle").style("visibility",null);if(r._handle)r._dragCell.gridRow(r._locY),r._dragCell.gridRowSpan(r._sizeY),r._dragCell.gridCol(r._locX),r._dragCell.gridColSpan(r._sizeX);else{var t=r._currLoc[1],n=r._currLoc[0],i=r._dragCell.gridRowSpan(),s=r._dragCell.gridColSpan(),o=r.getCell(r._currLoc[1],r._currLoc[0]);o===r._dragCell&&(i=o.gridRowSpan(),s=o.gridColSpan(),o=null);var u,a;o?(t=o.gridRow(),n=o.gridCol(),i=o.gridRowSpan(),s=o.gridColSpan(),o.gridCol(r._dragCell.gridCol()).gridColSpan(r._dragCell.gridColSpan()).gridRow(r._dragCell.gridRow()).gridRowSpan(r._dragCell.gridRowSpan()),u=n,a=t):(u=n-r._dragCellOffsetX,a=t-r._dragCellOffsetY),r._dragCell.gridCol(u).gridRow(a).gridColSpan(s).gridRowSpan(i)}var f=document.getElementById("grid-drop-target"+r.id());f.parentNode.removeChild(f),setTimeout(function(){r.contentDiv.selectAll(".cell_"+r._id).classed("dragItem",!1).classed("notDragItem",!1)},0),r._dragCell=null});this.designMode()?this.contentDiv.selectAll(".cell_"+this._id).call(s):this.contentDiv.selectAll(".cell_"+this._id).on(".drag",null),i.style("left",function(e){return e.gridCol()*t+r.gutter()/2+"px"}).style("top",function(e){return e.gridRow()*n+r.gutter()/2+"px"}).style("width",function(e){return e.gridColSpan()*t-r.gutter()+"px"}).style("height",function(e){return e.gridRowSpan()*n-r.gutter()+"px"}).each(function(e){e._parentElement.attr("draggable",r.designMode()).selectAll(".dragHandle").attr("draggable",r.designMode()),e.surfacePadding(r.cellPadding()).resize()}),i.exit().each(function(e){e.target(null),e.__grid_watch&&e.__grid_watch.remove()}).remove()},u.prototype.updateDropCells=function(e,t,n){var r=[];if(this.designMode())for(var i=0;i<e.height;++i)for(var s=0;s<e.width;++s)r.push({x:s,y:i});var o=this.dropDiv.selectAll(".dropCell_"+this._id).data(r);o.enter().append("div").attr("class","dropCell dropCell_"+this._id);var u=this;o.style("position","absolute").style("left",function(e){return e.x*t+u.gutter()/2+"px"}).style("top",function(e){return e.y*n+u.gutter()/2+"px"}).style("width",function(e){return 1*t-u.gutter()+"px"}).style("height",function(e){return 1*n-u.gutter()+"px"}),o.exit().remove()},u.prototype.update=function(e,n){t.prototype.update.apply(this,arguments),this._parentElement.style("overflow-x",this.fitTo()==="width"?"hidden":null),this._parentElement.style("overflow-y",this.fitTo()==="width"?"scroll":null);var r=this.getDimensions();this.designMode()&&(r.width++,r.height++);var i=(this.width()-(this.fitTo()==="width"?this._scrollBarWidth:0))/r.width,s=this.fitTo()==="all"?this.height()/r.height:i;this._colCount=r.width,this._rowCount=r.height,this._colSize=i,this._rowSize=s,this.updateCells(i,s),this.updateDropCells(r,i,s)},u.prototype.exit=function(e,n){t.prototype.exit.apply(this,arguments)},u.prototype.render=function(e){var n=this;return t.prototype.render.call(this,function(t){if(n.content().length){var r=n.content().length;n.content().forEach(function(n,i){setTimeout(function(){n.render(function(){--r===0&&e&&e(t)})},0)})}else e&&e(t)}),this},u}),function(e,t){typeof define=="function"&&define.amd?define("src/map/IChoropleth",["../common/Palette"],t):e.map_IChoropleth=t(e.common_Palette,e.usStates,e.usCounties)}(this,function(e,t,n){function r(){}return r.prototype._palette=e.rainbow("default"),r.prototype.click=function(e,t){console.log("Click:  "+JSON.stringify(e)+", "+t)},r}),define("css!src/map/Choropleth",[],function(){}),function(e,t){typeof define=="function"&&define.amd?define("src/map/Choropleth",["d3","../common/SVGWidget","./IChoropleth","css!./Choropleth"],t):e.map_Choropleth=t(e.d3,e.common_SVGWidget,e.map_IChoropleth)}(this,function(e,t,n){function r(){t.call(this),n.call(this),this._dataMap={},this._dataMinWeight=0,this._dataMaxWeight=0}return r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype._class+=" map_Choropleth",r.prototype.implements(n.prototype),r.prototype.publish("paletteID","YlOrRd","set","Palette ID",r.prototype._palette.switch(),{tags:["Basic","Shared"]}),r.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),r.prototype.data=function(e){var n=t.prototype.data.apply(this,arguments);if(arguments.length){this._dataMap={},this._dataMinWeight=null,this._dataMaxWeight=null;var r=this;this._data.forEach(function(e){r._dataMap[e[0]]=e;if(!r._dataMinWeight||e[1]<r._dataMinWeight)r._dataMinWeight=e[1];if(!r._dataMaxWeight||e[1]>r._dataMaxWeight)r._dataMaxWeight=e[1]})}return n},r.prototype.size=function(e){var n=t.prototype.size.apply(this,arguments);return arguments.length&&this._svgZoom&&this._svgZoom.attr("x",-this._size.width/2).attr("y",-this._size.height/2).attr("width",this._size.width).attr("height",this._size.height),n},r.prototype.projection=function(t){if(!arguments.length)return this._projection;this._projection=t;switch(this._projection){case"albersUsaPr":this.d3Projection=this.albersUsaPr();break;case"orthographic":this.d3Projection=e.geo.orthographic().clipAngle(90);break;case"mercator":this.d3Projection=e.geo.mercator()}return this.d3Path=e.geo.path().projection(this.d3Projection),this},r.prototype.render=function(){return t.prototype.render.apply(this,arguments),this._renderCount===1&&this.zoomToFit(),this},r.prototype.enter=function(t,n){var r=this;this._svgZoom=n.append("rect").attr("class","zoom").attr("x",-this._size.width/2).attr("y",-this._size.height/2).attr("width",this._size.width).attr("height",this._size.height).on("dblclick",function(t){e.event.stopPropagation(),r.zoomToFit(null,750)});var i=this._parentElement.insert("defs",":first-child"),s=i.append("pattern").attr("id","hash").attr("patternUnits","userSpaceOnUse").attr("width","10").attr("height","10").attr("x",0).attr("y",0).append("g");s.append("rect").attr("class","noFill").attr("x",0).attr("y",0).attr("width",5).attr("height",5),s.append("rect").attr("class","noFill").attr("x",5).attr("y",5).attr("width",5).attr("height",5),this._svg=n.append("g")},r.prototype.update=function(e,t){this._palette=this._palette.switch(this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id()))},r.prototype.albersUsaPr=function(){function h(e){var t=e[0],n=e[1];return o=null,(a(t,n),o)||(f(t,n),o)||(l(t,n),o)||(c(t,n),o),o}var t=1e-6,n=e.geo.albers(),r=e.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),i=e.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),s=e.geo.conicEqualArea().rotate([66,0]).center([0,18]).parallels([8,18]),o,u={point:function(e,t){o=[e,t]}},a,f,l,c;return h.invert=function(e){var t=n.scale(),o=n.translate(),u=(e[0]-o[0])/t,a=(e[1]-o[1])/t;return(a>=.12&&a<.234&&u>=-0.425&&u<-0.214?r:a>=.166&&a<.234&&u>=-0.214&&u<-0.115?i:a>=.204&&a<.234&&u>=.32&&u<.38?s:n).invert(e)},h.stream=function(e){var t=n.stream(e),o=r.stream(e),u=i.stream(e),a=s.stream(e);return{point:function(e,n){t.point(e,n),o.point(e,n),u.point(e,n),a.point(e,n)},sphere:function(){t.sphere(),o.sphere(),u.sphere(),a.sphere()},lineStart:function(){t.lineStart(),o.lineStart(),u.lineStart(),a.lineStart()},lineEnd:function(){t.lineEnd(),o.lineEnd(),u.lineEnd(),a.lineEnd()},polygonStart:function(){t.polygonStart(),o.polygonStart(),u.polygonStart(),a.polygonStart()},polygonEnd:function(){t.polygonEnd(),o.polygonEnd(),u.polygonEnd(),a.polygonEnd()}}},h.precision=function(e){return arguments.length?(n.precision(e),r.precision(e),i.precision(e),s.precision(e),h):n.precision()},h.scale=function(e){return arguments.length?(n.scale(e),r.scale(e*.35),i.scale(e),s.scale(e),h.translate(n.translate())):n.scale()},h.translate=function(e){if(!arguments.length)return n.translate();var o=n.scale(),p=+e[0],d=+e[1];return a=n.translate(e).clipExtent([[p-.455*o,d-.238*o],[p+.455*o,d+.238*o]]).stream(u).point,f=r.translate([p-.307*o,d+.201*o]).clipExtent([[p-.425*o+t,d+.12*o+t],[p-.214*o-t,d+.234*o-t]]).stream(u).point,l=i.translate([p-.205*o,d+.212*o]).clipExtent([[p-.214*o+t,d+.166*o+t],[p-.115*o-t,d+.234*o-t]]).stream(u).point,c=s.translate([p+.35*o,d+.224*o]).clipExtent([[p+.32*o,d+.204*o],[p+.38*o,d+.234*o]]).stream(u).point,h},h.scale(1070)},r.prototype.zoomToFit=function(e,t,n){n=n||.9;var r=e?e.getBBox():this._svg.node().getBBox(),i=r.x+r.width/2,s=r.y+r.height/2,o=n/Math.max(r.width/this.width(),r.height/this.height()),u=[-o*i,-o*s];(t?this._svg.transition().duration(t):this._svg).attr("transform","translate("+u+")scale("+o+")")},r}),!function(){function t(e,t){function u(t){var n=e.arcs[t<0?~t:t],r=n[0],i;return e.transform?(i=[0,0],n.forEach(function(e){i[0]+=e[0],i[1]+=e[1]})):i=n[n.length-1],t<0?[i,r]:[r,i]}function a(e,t){for(var r in e){var i=e[r];delete t[i.start],delete i.start,delete i.end,i.forEach(function(e){n[e<0?~e:e]=1}),s.push(i)}}var n={},r={},i={},s=[],o=-1;return t.forEach(function(n,r){var i=e.arcs[n<0?~n:n],s;i.length<3&&!i[1][0]&&!i[1][1]&&(s=t[++o],t[o]=n,t[r]=s)}),t.forEach(function(e){var t=u(e),n=t[0],s=t[1],o,a;if(o=i[n]){delete i[o.end],o.push(e),o.end=s;if(a=r[s]){delete r[a.start];var f=a===o?o:o.concat(a);r[f.start=o.start]=i[f.end=a.end]=f}else r[o.start]=i[o.end]=o}else if(o=r[s]){delete r[o.start],o.unshift(e),o.start=n;if(a=i[n]){delete i[a.end];var l=a===o?o:a.concat(o);r[l.start=a.start]=i[l.end=o.end]=l}else r[o.start]=i[o.end]=o}else o=[e],r[o.start=n]=i[o.end=s]=o}),a(i,r),a(r,i),t.forEach(function(e){n[e<0?~e:e]||s.push([e])}),s}function r(e,n,r){var i=[];if(arguments.length>1){var s=[],o;function u(e){var t=e<0?~e:e;(s[t]||(s[t]=[])).push({i:e,g:o})}function a(e){e.forEach(u)}function f(e){e.forEach(a)}function l(e){e.type==="GeometryCollection"?e.geometries.forEach(l):e.type in c&&(o=e,c[e.type](e.arcs))}var c={LineString:a,MultiLineString:f,Polygon:f,MultiPolygon:function(e){e.forEach(f)}};l(n),s.forEach(arguments.length<3?function(e){i.push(e[0].i)}:function(e){r(e[0].g,e[e.length-1].g)&&i.push(e[0].i)})}else for(var h=0,p=e.arcs.length;h<p;++h)i.push(h);return{type:"MultiLineString",arcs:t(e,i)}}function i(e,r){function a(e){e.forEach(function(t){t.forEach(function(t){(i[t=t<0?~t:t]||(i[t]=[])).push(e)})}),s.push(e)}function f(t){return h(u(e,{type:"Polygon",arcs:[t]}).coordinates[0])>0}var i={},s=[],o=[];return r.forEach(function(e){e.type==="Polygon"?a(e.arcs):e.type==="MultiPolygon"&&e.arcs.forEach(a)}),s.forEach(function(e){if(!e._){var t=[],n=[e];e._=1,o.push(t);while(e=n.pop())t.push(e),e.forEach(function(e){e.forEach(function(e){i[e<0?~e:e].forEach(function(e){e._||(e._=1,n.push(e))})})})}}),s.forEach(function(e){delete e._}),{type:"MultiPolygon",arcs:o.map(function(r){var s=[];r.forEach(function(e){e.forEach(function(e){e.forEach(function(e){i[e<0?~e:e].length<2&&s.push(e)})})}),s=t(e,s);if((n=s.length)>1){var o=f(r[0][0]);for(var u=0,a;u<n;++u)if(o===f(s[u])){a=s[0],s[0]=s[u],s[u]=a;break}}return s})}}function s(e,t){return t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(t){return o(e,t)})}:o(e,t)}function o(e,t){var n={type:"Feature",id:t.id,properties:t.properties||{},geometry:u(e,t)};return t.id==null&&delete n.id,n}function u(e,t){function i(e,t){t.length&&t.pop();for(var i=r[e<0?~e:e],s=0,o=i.length,u;s<o;++s)t.push(u=i[s].slice()),n(u,s);e<0&&a(t,o)}function s(e){return e=e.slice(),n(e,0),e}function o(e){var t=[];for(var n=0,r=e.length;n<r;++n)i(e[n],t);return t.length<2&&t.push(t[0].slice()),t}function u(e){var t=o(e);while(t.length<4)t.push(t[0].slice());return t}function f(e){return e.map(u)}function l(e){var t=e.type;return t==="GeometryCollection"?{type:t,geometries:e.geometries.map(l)}:t in c?{type:t,coordinates:c[t](e)}:null}var n=m(e.transform),r=e.arcs,c={Point:function(e){return s(e.coordinates)},MultiPoint:function(e){return e.coordinates.map(s)},LineString:function(e){return o(e.arcs)},MultiLineString:function(e){return e.arcs.map(o)},Polygon:function(e){return f(e.arcs)},MultiPolygon:function(e){return e.arcs.map(f)}};return l(t)}function a(e,t){var n,r=e.length,i=r-t;while(i<--r)n=e[i],e[i++]=e[r],e[r]=n}function f(e,t){var n=0,r=e.length;while(n<r){var i=n+r>>>1;e[i]<t?n=i+1:r=i}return n}function l(e){function r(e,n){e.forEach(function(e){e<0&&(e=~e);var r=t[e];r?r.push(n):t[e]=[n]})}function i(e,t){e.forEach(function(e){r(e,t)})}function s(e,t){e.type==="GeometryCollection"?e.geometries.forEach(function(e){s(e,t)}):e.type in o&&o[e.type](e.arcs,t)}var t={},n=e.map(function(){return[]}),o={LineString:r,MultiLineString:i,Polygon:i,MultiPolygon:function(e,t){e.forEach(function(e){i(e,t)})}};e.forEach(s);for(var u in t)for(var a=t[u],l=a.length,c=0;c<l;++c)for(var h=c+1;h<l;++h){var p=a[c],d=a[h],v;(v=n[p])[u=f(v,d)]!==d&&v.splice(u,0,d),(v=n[d])[u=f(v,p)]!==p&&v.splice(u,0,p)}return n}function c(e,t){function s(e){i.remove(e),e[1][2]=t(e),i.push(e)}var n=m(e.transform),r=g(e.transform),i=v();return t||(t=p),e.arcs.forEach(function(e){var o=[],u=0,a;for(var f=0,l=e.length,c;f<l;++f)c=e[f],n(e[f]=[c[0],c[1],Infinity],f);for(var f=1,l=e.length-1;f<l;++f)a=e.slice(f-1,f+2),a[1][2]=t(a),o.push(a),i.push(a);for(var f=0,l=o.length;f<l;++f)a=o[f],a.previous=o[f-1],a.next=o[f+1];while(a=i.pop()){var h=a.previous,p=a.next;a[1][2]<u?a[1][2]=u:u=a[1][2],h&&(h.next=p,h[2]=a[2],s(h)),p&&(p.previous=h,p[0]=a[0],s(p))}e.forEach(r)}),e}function h(e){var t=-1,n=e.length,r,i=e[n-1],s=0;while(++t<n)r=i,i=e[t],s+=r[0]*i[1]-r[1]*i[0];return s*.5}function p(e){var t=e[0],n=e[1],r=e[2];return Math.abs((t[0]-r[0])*(n[1]-t[1])-(t[0]-n[0])*(r[1]-t[1]))}function d(e,t){return e[1][2]-t[1][2]}function v(){function r(e,n){while(n>0){var r=(n+1>>1)-1,i=t[r];if(d(e,i)>=0)break;t[i._=n]=i,t[e._=n=r]=e}}function i(e,r){for(;;){var i=r+1<<1,s=i-1,o=r,u=t[o];s<n&&d(t[s],u)<0&&(u=t[o=s]),i<n&&d(t[i],u)<0&&(u=t[o=i]);if(o===r)break;t[u._=r]=u,t[e._=r=o]=e}}var e={},t=[],n=0;return e.push=function(e){return r(t[e._=n]=e,n++),n},e.pop=function(){if(n<=0)return;var e=t[0],r;return--n>0&&(r=t[n],i(t[r._=0]=r,0)),e},e.remove=function(e){var s=e._,o;if(t[s]!==e)return;return s!==--n&&(o=t[n],(d(o,e)<0?r:i)(t[o._=s]=o,s)),s},e}function m(e){if(!e)return y;var t,n,r=e.scale[0],i=e.scale[1],s=e.translate[0],o=e.translate[1];return function(e,u){u||(t=n=0),e[0]=(t+=e[0])*r+s,e[1]=(n+=e[1])*i+o}}function g(e){if(!e)return y;var t,n,r=e.scale[0],i=e.scale[1],s=e.translate[0],o=e.translate[1];return function(e,u){u||(t=n=0);var a=(e[0]-s)/r|0,f=(e[1]-o)/i|0;e[0]=a-t,e[1]=f-n,t=a,n=f}}function y(){}var e={version:"1.6.19",mesh:function(e){return u(e,r.apply(this,arguments))},meshArcs:r,merge:function(e){return u(e,i.apply(this,arguments))},mergeArcs:i,feature:s,neighbors:l,presimplify:c};typeof define=="function"&&define.amd?define("topojson",e):typeof module=="object"&&module.exports?module.exports=e:this.topojson=e}(),function(e,t){typeof define=="function"&&define.amd?define("src/map/ChoroplethStates",["d3","./Choropleth","topojson","./us-states"],t):e.map_ChoroplethStates=t(e.d3,e.map_Choropleth,e.topojson,e.map_usStates)}(this,function(e,t,n,r){function i(){t.call(this),this.projection("albersUsaPr")}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" map_ChoroplethStates",i.prototype.testData=function(){var e={};for(var t in r.stateNames){var n=r.stateNames[t];e[n.name]=n.code}var i=[{name:"Alabama",weight:4779736},{name:"Alaska",weight:710231},{name:"Arizona",weight:6392017},{name:"Arkansas",weight:2915918},{name:"California",weight:37253956},{name:"Colorado",weight:5029196},{name:"Connecticut",weight:3574097},{name:"District of Columbia",weight:601723},{name:"Florida",weight:18801310},{name:"Georgia",weight:9687653},{name:"Hawaii",weight:1360301},{name:"Idaho",weight:1567582},{name:"Illinois",weight:12830632},{name:"Indiana",weight:6483802},{name:"Iowa",weight:3046355},{name:"Maine",weight:1328361},{name:"Maryland",weight:5773552},{name:"Massachusetts",weight:6547629},{name:"Michigan",weight:9883640},{name:"Minnesota",weight:5303925},{name:"Mississippi",weight:2967297},{name:"Missouri",weight:5988927},{name:"Montana",weight:989415},{name:"Nebraska",weight:1826341},{name:"Nevada",weight:2700551},{name:"New Hampshire",weight:1316470},{name:"New Jersey",weight:8791894},{name:"New Mexico",weight:2059179},{name:"New York",weight:19378102},{name:"North Carolina",weight:9535483},{name:"North Dakota",weight:672591},{name:"Ohio",weight:11536504},{name:"Oklahoma",weight:3751351},{name:"Oregon",weight:3831074},{name:"Pennsylvania",weight:12702379},{name:"Rhode Island",weight:1052567},{name:"South Carolina",weight:4625364},{name:"South Dakota",weight:814180},{name:"Tennessee",weight:6346105},{name:"Texas",weight:25145561},{name:"Utah",weight:2763885},{name:"Vermont",weight:625741},{name:"Virginia",weight:8001024},{name:"Washington",weight:6724540},{name:"West Virginia",weight:1852994},{name:"Wisconsin",weight:5686986},{name:"Wyoming",weight:563626}];this.columns(["State","Weight","Label"]);var s=i.map(function(t){return[e[t.name],t.weight,t.name]});return this.data(s),this},i.prototype.enter=function(i,s){t.prototype.enter.apply(this,arguments),s.classed("map_Choropleth",!0);var o=this._svg.selectAll("path").data(n.feature(r.topology,r.topology.objects.states).features),u=this;this.choroPaths=o.enter().append("path").on("click",function(e){var t=r.stateNames[e.id].code;u._dataMap[t]&&u.click(u.rowToObj(u._dataMap[t]),"weight")}).on("dblclick",function(t){e.event.stopPropagation(),u.zoomToFit(u.active===this?null:this,750),u.active=this}),this.choroPaths.append("title")},i.prototype.update=function(n,i){t.prototype.update.apply(this,arguments);var s=this;this.choroPaths.attr("d",this.d3Path).each(function(t){var n=r.stateNames[t.id].code,i=s._dataMap[n]?s._dataMap[n][1]:undefined;e.select(this).style("fill",i===undefined?"url(#hash)":s._palette(i,s._dataMinWeight,s._dataMaxWeight)).select("title").text(r.stateNames[t.id].name+(i===undefined?"":" ("+i+")"))})},i}),define("css!src/layout/Layered",[],function(){}),function(e,t){typeof define=="function"&&define.amd?define("src/layout/Layered",["d3","../common/HTMLWidget","../layout/AbsoluteSurface","../chart/Pie","../map/ChoroplethStates","../chart/Column","../common/Text","css!./Layered"],t):e.form_Form=t(e.d3,e.common_HTMLWidget,e.layout_AbsoluteSurface,e.chart_Pie,e.map_ChoroplethStates,e.chart_Line,e.common_Text)}(this,function(e,t,n,r,i,s,o){function u(){t.call(this),this._tag="div"}return u.prototype=Object.create(t.prototype),u.prototype.constructor=u,u.prototype._class+=" layout_Layered",u.prototype.publish("padding",0,"number","Padding"),u.prototype.publish("widgets",[],"widgetArray","widgets",null,{tags:["Private"]}),u.prototype.testData=function(){this.addLayer((new n).x(0).y(0).width(100).height(100).widget((new s).testData())).addLayer((new n).x(40).y(40).width(50).height(50).opacity(.66).widget((new r).testData())).addLayer((new n).x(10).y(0).width(40).height(50).widget((new i).testData()));var e=this;return setInterval(function(){e.widgets().sort(function(e,t){return Math.random()<.5?-1:1}),e.render()},3e3),this},u.prototype.addLayer=function(e){var t=this.widgets();return t.push(e?e:(new o).text("No widget defined for layer.")),this.widgets(t),this},u.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments),this._contentContainer=n.append("div").attr("class","container")},u.prototype.update=function(e,n){t.prototype.update.apply(this,arguments);var r=this;n.style("padding",this.padding()+"px");var i=this._contentContainer.selectAll(".content.id"+this.id()).data(this.widgets(),function(e){return e.id()});i.enter().append("div").attr("class","content id"+this.id()).each(function(e,t){e.target(this)}),i.each(function(e,t){e.resize({width:r.clientWidth(),height:r.clientHeight()}).render()}),i.exit().each(function(e,t){e.target(null)}).remove(),i.order()},u}),define("css!src/layout/Tabbed",[],function(){}),function(e,t){typeof define=="function"&&define.amd?define("src/layout/Tabbed",["d3","../common/HTMLWidget","../layout/Surface","../chart/Pie","../chart/MultiChart","../google/Line","../common/Text","css!./Tabbed"],t):e.form_Form=t(e.d3,e.common_HTMLWidget,e.layout_Surface,e.chart_Pie,e.chart_MultiChart,e.chart_Line,e.common_Text)}(this,function(e,t,n,r,i,s,o){function u(){t.call(this),this._tag="div"}return u.prototype=Object.create(t.prototype),u.prototype.constructor=u,u.prototype._class+=" layout_Tabbed",u.prototype.publish("padding",4,"number","Padding"),u.prototype.publish("activeTabIdx",0,"number","Index of active tab",null,{}),u.prototype.publish("labels",[],"array","Array of tab labels sharing an index with 'widgets'",null,{tags:["Private"]}),u.prototype.publish("widgets",[],"widgetArray","widgets",null,{tags:["Private"]}),u.prototype.testData=function(){return this.addTab((new i).testData(),"MultiChart",!0).addTab((new r).testData(),"Pie Chart").addTab((new s).testData(),"Line Chart").addTab((new u).labels([]).widgets([]).addTab((new r).testData(),"Another Pie Chart").addTab((new s).testData(),"Another Line Chart",!0),"Nested Example"),this},u.prototype.addTab=function(e,t,r){var i=this.labels(),s=this.widgets();return r&&this.activeTabIdx(this.widgets().length),i.push(t),s.push((new n).widget(e?e:(new o).text("No widget defined for tab"))),this.labels(i),this.widgets(s),this},u.prototype.widgetSize=function(e){var t=this.clientWidth(),n=this.clientHeight(),r=this._tabContainer.node().getBoundingClientRect();return typeof r.height!="undefined"&&(n-=r.height),{width:t,height:n}},u.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments),this._tabContainer=n.append("div"),this._contentContainer=n.append("div")},u.prototype.update=function(n,r){t.prototype.update.apply(this,arguments);var i=this;r.style("padding",this.padding()+"px");var s=this._tabContainer.selectAll(".tab-button.id"+this.id()).data(this.labels(),function(e){return e});s.enter().append("span").attr("class","tab-button id"+this.id()).style("cursor","pointer").on("click",function(e,t){i.activeTabIdx(t).render()}),s.classed("active",function(e,t){return i.activeTabIdx()===t}).text(function(e){return e}),s.exit().remove();var o=this._contentContainer.selectAll(".tab-content.id"+this.id()).data(this.widgets(),function(e){return e.id()});o.enter().append("div").attr("class","tab-content id"+this.id()).each(function(e,t){e.target(this)}),o.classed("active",function(e,t){return i.activeTabIdx()===t}).style("display",function(e,t){return i.activeTabIdx()===t?"block":"none"}).each(function(t,n){var r=i.widgetSize(e.select(this));t.resize(r).render()}),o.exit().each(function(e,t){e.target(null)}).remove()},u}),function(e){var t=document,n="appendChild",r="styleSheet",i=t.createElement("style");i.type="text/css",t.getElementsByTagName("head")[0][n](i),i[r]?i[r].cssText=e:i[n](t.createTextNode(e))}(".layout_Surface{margin:0;border:1px solid #e5e5e5;border-radius:3px;overflow:hidden}.layout_Surface>h3{margin:0;padding:2px;text-align:center;font-weight:700;background-color:#e5e5e5}.layout_Surface .html-button-container{position:absolute;right:0;top:3px}.layout_Surface>div{padding:8px}.layout_Surface .html-button-container .surface-button{position:relative;background:0 0;border:none;opacity:.8}​ .layout_Surface .html-button-container .surface-button:hover{opacity:1}.layout_Surface .html-button-container .surface-button:active{opacity:.5}.layout_Border .cell{border-radius:5px;border:1px solid #e5e5e5;display:inline-block;overflow:hidden}.layout_Border .cell h2{margin:0;padding-top:4px;-webkit-margin:0;text-align:center}.layout_Border .dropCell{box-sizing:border-box;background-color:lightgrey;opacity:.33;border-radius:5px;border:1px solid #333;display:inline-block;overflow:hidden}.layout_Border .dropCell.over,.layout_Border .layout_BorderCell.over{border:2px dashed #000}.layout_Border .dragItem{z-index:-1;opacity:.33}.layout_Border .notDragItem{z-index:-1;opacity:1}.layout_Border div[draggable=true]{opacity:.75;cursor:default}.layout_Border div[draggable=true] .dragHandle{opacity:1}.layout_Border div[draggable=true] .dragHandle_n,.layout_Border div[draggable=true] .dragHandle_e,.layout_Border div[draggable=true] .dragHandle_s,.layout_Border div[draggable=true] .dragHandle_w{background-color:#AAA}.layout_Border div[draggable=true] .dragHandle_nw,.layout_Border div[draggable=true] .dragHandle_ne,.layout_Border div[draggable=true] .dragHandle_se,.layout_Border div[draggable=true] .dragHandle_sw{background-color:#333}.layout_Border div[draggable=true] .dragHandle_nw{cursor:nw-resize}.layout_Border div[draggable=true] .dragHandle_n{cursor:n-resize}.layout_Border div[draggable=true] .dragHandle_ne{cursor:ne-resize}.layout_Border div[draggable=true] .dragHandle_e{cursor:e-resize}.layout_Border div[draggable=true] .dragHandle_se{cursor:se-resize}.layout_Border div[draggable=true] .dragHandle_s{cursor:s-resize}.layout_Border div[draggable=true] .dragHandle_sw{cursor:sw-resize}.layout_Border div[draggable=true] .dragHandle_w{cursor:w-resize}.layout_Border div[draggable=false]>div>.dragHandle{display:none}.layout_Border .grid-drop-target{position:fixed;box-sizing:border-box;border:2px dashed #7f8c8d;border-radius:0;background:repeating-linear-gradient(-45deg,rgba(0,0,0,0),rgba(0,0,0,0)4px,rgba(100,100,100,.1)4px,rgba(100,100,100,.1)8px)}.layout_Border .grid-drop-target.drop-target-over{border:2px dashed #179BD7;background:repeating-linear-gradient(-45deg,rgba(0,0,0,0),rgba(0,0,0,0)6px,rgba(17,155,215,.1)6px,rgba(17,155,215,.1)12px)}.layout_Grid .cell{border-radius:5px;border:1px solid #e5e5e5;display:inline-block;overflow:hidden}.layout_Grid .cell h2{margin:0;padding-top:4px;-webkit-margin:0;text-align:center}.layout_Grid .dropCell{box-sizing:border-box;background-color:lightgrey;opacity:.33;border-radius:5px;border:1px solid #333;display:inline-block;overflow:hidden}.layout_Grid .dropCell.over,.layout_Grid .layout_Cell.over{border:2px dashed #000}.layout_Grid .dragItem{z-index:0;opacity:.33}.layout_Grid .notDragItem{z-index:-1;opacity:1}.layout_Grid div[draggable=true]{opacity:.75;cursor:move}.layout_Grid div[draggable=true] .dragHandle{opacity:1}.layout_Grid div[draggable=true] .dragHandle_n,.layout_Grid div[draggable=true] .dragHandle_e,.layout_Grid div[draggable=true] .dragHandle_s,.layout_Grid div[draggable=true] .dragHandle_w{background-color:#AAA}.layout_Grid div[draggable=true] .dragHandle_nw,.layout_Grid div[draggable=true] .dragHandle_ne,.layout_Grid div[draggable=true] .dragHandle_se,.layout_Grid div[draggable=true] .dragHandle_sw{background-color:#333}.layout_Grid div[draggable=true] .dragHandle_nw{cursor:nw-resize}.layout_Grid div[draggable=true] .dragHandle_n{cursor:n-resize}.layout_Grid div[draggable=true] .dragHandle_ne{cursor:ne-resize}.layout_Grid div[draggable=true] .dragHandle_e{cursor:e-resize}.layout_Grid div[draggable=true] .dragHandle_se{cursor:se-resize}.layout_Grid div[draggable=true] .dragHandle_s{cursor:s-resize}.layout_Grid div[draggable=true] .dragHandle_sw{cursor:sw-resize}.layout_Grid div[draggable=true] .dragHandle_w{cursor:w-resize}.layout_Grid div[draggable=false]>div>.dragHandle{display:none}.layout_Grid .grid-drop-target{position:fixed;box-sizing:border-box;border:2px dashed #7f8c8d;border-radius:0;background:repeating-linear-gradient(-45deg,rgba(0,0,0,0),rgba(0,0,0,0)4px,rgba(100,100,100,.1)4px,rgba(100,100,100,.1)8px)}.layout_Grid .grid-drop-target.drop-target-over{border:2px dashed #179BD7;background:repeating-linear-gradient(-45deg,rgba(0,0,0,0),rgba(0,0,0,0)6px,rgba(17,155,215,.1)6px,rgba(17,155,215,.1)12px)}.noFill{fill:whitesmoke;stroke:none}.map_Choropleth .zoom{stroke:none;fill:none;pointer-events:all}.map_Choropleth path{cursor:pointer;fill:whitesmoke;stroke:#6d6e71;stroke-width:.125px;stroke-linejoin:round;stroke-linecap:round;vector-effect:non-scaling-stroke}.layout_Layered .container{position:relative;pointer-events:none}.layout_Layered .content{position:absolute}.layout_Layered .common_Widget{pointer-events:all}.layout_Layered .common_Widget.layout_AbsoluteSurface{pointer-events:none}.layout_Tabbed .tab-button{position:relative;top:1px;display:inline-block;border-left:1px solid #ddd;border-top:1px solid #ddd;border-right:1px solid #ddd;background-color:transparent;margin-right:4px;padding:2px 2px 4px;background-color:#ccc}.layout_Tabbed .tab-button.active{background-color:#fff}"),define("hpcc-viz-layout",function(){});